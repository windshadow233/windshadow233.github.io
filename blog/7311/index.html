<!DOCTYPE html><html lang="[&quot;en-US&quot;,&quot;zh-CN&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>PKU GeekGame 1st 部分题目Write-Up | 逸风亭</title><meta name="author" content="WindShadow"><meta name="copyright" content="WindShadow"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Hackergame结束后，我又参加了PKU举办的GeekGame，本以为在Hackergame发挥不错，可以在GeekGame混混名次。 然而参赛后感觉难度太大了，全程被大佬们按在地上摩擦，一阶段完整解出的题只有五道，只拿了1000分，总排名仅为42；二阶段随着提示的放出，基本丧失了做题兴趣，也没有再怎么拿分了。      引用站外地址，不保证站点的可用性和安全性">
<meta property="og:type" content="article">
<meta property="og:title" content="PKU GeekGame 1st 部分题目Write-Up">
<meta property="og:url" content="https://blog.fyz666.xyz/blog/7311/">
<meta property="og:site_name" content="逸风亭">
<meta property="og:description" content="Hackergame结束后，我又参加了PKU举办的GeekGame，本以为在Hackergame发挥不错，可以在GeekGame混混名次。 然而参赛后感觉难度太大了，全程被大佬们按在地上摩擦，一阶段完整解出的题只有五道，只拿了1000分，总排名仅为42；二阶段随着提示的放出，基本丧失了做题兴趣，也没有再怎么拿分了。      引用站外地址，不保证站点的可用性和安全性">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blogfiles.oss.fyz666.xyz/jpeg/259b316a-8dcd-489d-9193-7b14e14adda6.jpeg">
<meta property="article:published_time" content="2021-11-21T04:51:59.000Z">
<meta property="article:modified_time" content="2025-01-16T17:14:05.083Z">
<meta property="article:author" content="WindShadow">
<meta property="article:tag" content="GeekGame">
<meta property="article:tag" content="GeekGame 1st">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blogfiles.oss.fyz666.xyz/jpeg/259b316a-8dcd-489d-9193-7b14e14adda6.jpeg"><link rel="shortcut icon" href="/images/avatar.png"><link rel="canonical" href="https://blog.fyz666.xyz/blog/7311/"><link rel="preconnect" href="//fastly.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/vercount@v0.0.2.js"><meta name="google-site-verification" content="qs4w3HQcWsP2MnxYN-ccrDZXv8lbkIZ7FRTams_no7w"><meta name="baidu-site-verification" content="7a52f3352214d3debf7bdc94e16e4d98"><meta name="msvalidate.01" content="A886BA7ACEE7B91223E9CAC00117689A"><link rel="stylesheet" href="/css/index.0071121d.css?v=4.14.0-b1"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>(()=>{const e={set:(e,t,o)=>{if(0===o)return;const n={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(n))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}};window.btf={saveToLocal:e,getScript:(e,t={})=>new Promise(((o,n)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onerror=n,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,o())},Object.keys(t).forEach((e=>{a.setAttribute(e,t[e])})),document.head.appendChild(a)})),getCSS:(e,t=!1)=>new Promise(((o,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,t&&(a.id=t),a.onerror=n,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,o())},document.head.appendChild(a)})),addGlobalFn:(e,t,o=!1,n=window)=>{const a=n.globalFn||{},c=a[e]||{};o&&c[o]||(c[o=o||Object.keys(c).length]=t,a[e]=c,n.globalFn=a)}};const t=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},o=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","ffffff")};btf.activateDarkMode=t,btf.activateLightMode=o;const n=e.get("theme");"dark"===n?t():"light"===n&&o();const a=e.get("aside-status");void 0!==a&&("hide"===a?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?9a270e5172c0e106854227db797302be";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),btf.addGlobalFn("pjaxComplete",(()=>{_hmt.push(["_trackPageview",window.location.pathname])}),"baidu_analytics")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-WYGVS01F3R"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-WYGVS01F3R"),btf.addGlobalFn("pjaxComplete",(()=>{gtag("config","G-WYGVS01F3R",{page_path:window.location.pathname})}),"google_analytics")</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:void 0,highlight:{plugin:"prismjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:300},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体中文",cht_to_chs:"你已切换为简体中文",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"top-right"},infinitegrid:{js:"https://fastly.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1,shortcut:{enable:!0,keyboard_delay:500,keyboard_css:"https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/keyboard.min.css",items:[{keycode:83,text:"S",action:"站内搜索",script:'$(".search").click()'},{keycode:82,text:"R",action:"随机文章",script:"toRandomPost()"},{keycode:38,text:"↑",action:"回到顶部",script:"btf.scrollToDest()"},{keycode:40,text:"↓",action:"前往评论区",script:"location.href='#post-comment'"},{keycode:37,text:"←",action:"回退页面",script:"history.back()"},{keycode:39,text:"→",action:"前进页面",script:"history.forward()"},{keycode:72,text:"H",action:"返回首页",script:"pjax.loadUrl('/')"},{keycode:65,text:"A",action:"关于博主",script:"pjax.loadUrl('/about/')"},{keycode:76,text:"L",action:"友情链接",script:"pjax.loadUrl('/link/')"},{keycode:68,text:"D",action:"浅色/深色切换",script:'$("#darkmode").click()'},{keycode:84,text:"T",action:"简体/繁体切换",script:'$("#translateLink").click()'},{keycode:67,text:"C",action:"显示/隐藏评论弹幕",script:"switchCommentBarrage()"},{keycode:77,text:"M",action:"播放/暂停音乐",script:"aplayers[0].toggle()"},{keycode:32,text:"Space",action:"全屏模式切换",script:"fullScreen()"}]}}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"PKU GeekGame 1st 部分题目Write-Up",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2025-01-17 01:14:05"}</script><style id="barragesColor"></style><script type="text/javascript" src="https://fastly.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script><script src="https://fastly.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js"></script><script src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/rightmenu.min.js" async></script><link rel="stylesheet" href="/css/iconfont.0668fd11.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/rightmenu.css"><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><script src="/js/charts.a64c95a7.js"></script><script src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/githubcalendar@v0.0.2.js"></script><script type="text/javascript" src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/comment-barrage.js"></script><script type="text/javascript" src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/waterfall.js"></script><script type="text/javascript" src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/mytalk.js"></script><script type="text/javascript" src="/js/random.6a405d1e.js"></script><script type="text/javascript" src="/js/custom.0fc0f537.js"></script><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/mytalk@v1.1.3.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/baiduhistorycalendar.css"><div id="keyboard-tips" style="display:none"><div class="keyboardTitle">快捷键</div><div class="keybordList"><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + S</div></div><div class="keyContent"><div class="content">站内搜索</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + R</div></div><div class="keyContent"><div class="content">随机文章</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + ↑</div></div><div class="keyContent"><div class="content">回到顶部</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + ↓</div></div><div class="keyContent"><div class="content">前往评论区</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + ←</div></div><div class="keyContent"><div class="content">回退页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + →</div></div><div class="keyContent"><div class="content">前进页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + H</div></div><div class="keyContent"><div class="content">返回首页</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + A</div></div><div class="keyContent"><div class="content">关于博主</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + L</div></div><div class="keyContent"><div class="content">友情链接</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + D</div></div><div class="keyContent"><div class="content">浅色/深色切换</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + T</div></div><div class="keyContent"><div class="content">简体/繁体切换</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + C</div></div><div class="keyContent"><div class="content">显示/隐藏评论弹幕</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + M</div></div><div class="keyContent"><div class="content">播放/暂停音乐</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + Space</div></div><div class="keyContent"><div class="content">全屏模式切换</div></div></div></div></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/keyboard.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/swiper-style.css" media="print" onload='this.media="all"'><meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="逸风亭" type="application/atom+xml">
<link rel="alternate" href="/feed.xml" title="逸风亭" type="application/rss+xml">
</head><body><div id="loading-box"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script async>(()=>{const e=document.getElementById("loading-box"),d=document.body,o=()=>{d.style.overflow="",e.classList.add("loaded")},l=()=>{d.style.overflow="hidden",e.classList.remove("loaded")};l(),window.addEventListener("load",(()=>{o()})),setTimeout((function(){o()}),5e3),btf.addGlobalFn("pjaxSend",(()=>{l()}),"preloader_init"),btf.addGlobalFn("pjaxComplete",(()=>{o()}),"preloader_end")})()</script><script>window.paceOptions={restartOnPushState:!1},btf.addGlobalFn("pjaxSend",(()=>{Pace.restart()}),"pace_restart")</script><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/pace_progress_bar.css"><script src="https://fastly.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/avatar.png" onerror='onerror=null,src="/images/default-link.png"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">159</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">95</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-blog"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="javascript:toRandomPost();"><i class="fa-fw fa fa-paper-plane"></i><span> 随便逛逛</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-sitemap"></i><span> 本站</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw far fa-images"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐馆</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-info-circle"></i><span> 关于我</span></a></li><li><a class="site-page child" href="/talk/"><i class="fa-fw far fa-comment-dots"></i><span> 说说</span></a></li><li><a class="site-page child" href="/projects/"><i class="fa-fw fas fa-project-diagram"></i><span> 一些项目</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://status.fyz666.xyz/"><i class="fa-fw iconfont icon-monitor"></i><span> 状态监控</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-link"></i><span> 链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fab fa-galactic-republic"></i><span> 朋友圈</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-user-friends"></i><span> 友链</span></a></li><li><a class="site-page child" href="/tlink/"><i class="fa-fw fas fa-tools"></i><span> 工具</span></a></li><li><a class="site-page child" href="/rlink/"><i class="fa-fw fas fa-save"></i><span> 资源</span></a></li><li><a class="site-page child" href="/cfop/"><i class="fa-fw fa-solid fa-cube"></i><span> CFOP</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw iconfont icon-global"></i><span> 线路</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.fyz666.xyz/" target="_blank" rel="noopener"><i class="fa-fw"></i><span> 主站点</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://gh.fyz666.xyz/"><span> GitHub</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://cf.fyz666.xyz/"><span> Cloudflare</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://vc.fyz666.xyz/"><span> Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://ntl.fyz666.xyz/"><span> Netlify</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://rd.fyz666.xyz/"><span> Render</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://zb.fyz666.xyz/"><span> Zeabur</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image:url('https://blogfiles.oss.fyz666.xyz/jpeg/259b316a-8dcd-489d-9193-7b14e14adda6.jpeg')"><nav id="nav"><span id="blog-info"><a class="site-name" href="/" title="逸风亭">逸风亭</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-blog"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="javascript:toRandomPost();"><i class="fa-fw fa fa-paper-plane"></i><span> 随便逛逛</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-sitemap"></i><span> 本站</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw far fa-images"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐馆</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-info-circle"></i><span> 关于我</span></a></li><li><a class="site-page child" href="/talk/"><i class="fa-fw far fa-comment-dots"></i><span> 说说</span></a></li><li><a class="site-page child" href="/projects/"><i class="fa-fw fas fa-project-diagram"></i><span> 一些项目</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://status.fyz666.xyz/"><i class="fa-fw iconfont icon-monitor"></i><span> 状态监控</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-link"></i><span> 链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fab fa-galactic-republic"></i><span> 朋友圈</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-user-friends"></i><span> 友链</span></a></li><li><a class="site-page child" href="/tlink/"><i class="fa-fw fas fa-tools"></i><span> 工具</span></a></li><li><a class="site-page child" href="/rlink/"><i class="fa-fw fas fa-save"></i><span> 资源</span></a></li><li><a class="site-page child" href="/cfop/"><i class="fa-fw fa-solid fa-cube"></i><span> CFOP</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw iconfont icon-global"></i><span> 线路</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.fyz666.xyz/" target="_blank" rel="noopener"><i class="fa-fw"></i><span> 主站点</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://gh.fyz666.xyz/"><span> GitHub</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://cf.fyz666.xyz/"><span> Cloudflare</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://vc.fyz666.xyz/"><span> Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://ntl.fyz666.xyz/"><span> Netlify</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://rd.fyz666.xyz/"><span> Render</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://zb.fyz666.xyz/"><span> Zeabur</span></a></li></ul></div></div></div><div id="nav-right"><div class="menus_item"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i></span></div></div><div class="menus_item"><div id="random"><a class="site-page social-icon" href="javascript:toRandomPost();" title="前往随机文章"><i class="fa fa-paper-plane"></i></a></div></div><div class="menus_item"><div id="travel"><a class="site-page social-icon" target="_blank" rel="noopener" href="https://travel.moe/go.html?travel=on" title="萌ICP备异次元之旅"><i class="iconfont icon-planet"></i></a></div></div><div class="menus_item"><div id="traveling"><a class="site-page social-icon" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html" title="开往-友联接力"><i class="fa fa-subway"></i></a></div></div><div class="menus_item"><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></div></nav><div id="post-info"><h1 class="post-title">PKU GeekGame 1st 部分题目Write-Up</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2021-11-21T04:51:59.000Z" title="发表于 2021-11-21 12:51:59">2021-11-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf%E9%A2%98%E8%A7%A3/">CTF题解</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>36分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="PKU GeekGame 1st 部分题目Write-Up"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="vercount_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/blog/7311/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div id="ai-container"><div id="ai-header"><div id="ai-title"><i class="fas fa-robot">&nbsp;</i><span>AI摘要</span><b id="ai-label"><a id="ai-link" target="_blank" rel="noopener" href="https://kimi.moonshot.cn/">Kimi Chat</a></b></div></div><div id="ai-content"></div></div><script>$(document).ready((function(){loadAbstract()}))</script><article class="post-content" id="article-container"><p>Hackergame结束后，我又参加了PKU举办的GeekGame，本以为在Hackergame发挥不错，可以在GeekGame混混名次。</p>
<p>然而参赛后感觉难度太大了，全程被大佬们按在地上摩擦，一阶段完整解出的题只有五道，只拿了1000分，总排名仅为42；二阶段随着提示的放出，基本丧失了做题兴趣，也没有再怎么拿分了。</p>
<a class="tag-Link" target="_blank" href="https://github.com/PKU-GeekGame/geekgame-1st">
    <div class="tag-link-tips">引用站外地址，不保证站点的可用性和安全性</div>
    <div class="tag-link-bottom">
        <div class="tag-link-left">
            <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://logo.clearbit.com/github.com?size=256" onerror='this.onerror=null,this.src="/images/default-link.png"'>
        </div>
        <div class="tag-link-right">
            <div class="tag-link-title">本次比赛的官方存档</div>
            <div class="tag-link-sitename">GitHub</div>
        </div>
        <i class="fa-solid fa-angle-right"></i>
    </div>
    </a>
<h2 id="→签到←"><a href="#→签到←" class="headerlink" title="→签到←"></a>→签到←</h2><p>Hackergame的Web签到题做多了，导致拿到一个Misc的签到题有点不知所措，题目没有给任何描述，只有一个PDF文件：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-1st/raw/master/problemset/attachment/prob01_lwzltdrojur150zq.zip">本题附件</a></p>
<p>用Chrome浏览器打开这个PDF文件如下所示：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/b2d3e5d7-ef4a-49dd-b938-a5254a3cad85.png" alt=""><br>似乎说后面一串奇怪的字符就是flag的样子，但我完全没办法把这些字符和flag联系起来。</p>
<p>研究了许久无果后，我无意间全选了一下PDF里面的内容，复制粘贴到一个空白文件中，发现了玄机：</p>
<pre class="line-numbers language-none"><code class="language-none">1
fa&#123;aeAGetTm@ekaev!
lgHv__ra_ieGeGm_1&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>看上去除了第一排混进来一个没什么用的”1”以外，后面两排可以组合成flag。再研究一下，发现就是个栅栏密码，交替取上下两排的字符，即可还原出flag。</p>
<p>flag{Have_A_Great_Time@GeekGame_v1}</p>
<p>说起来顺利做出这题还得感谢我平时一直用Chrome看PDF的习惯，一些使用常规PDF阅读器的选手都遇到了没办法选中超出界面的字符的问题。</p>
<hr>
<h2 id="小北问答Remake"><a href="#小北问答Remake" class="headerlink" title="小北问答Remake"></a>小北问答Remake</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>You 酱善于使用十种搜索引擎，别人不清楚的知识她能一秒钟搜索出来。这是众人皆知的事实。</p>
<p>You 酱的朋友菜宝在刷往年题的时候找到了一份没有答案的资料。她本想询问 You 酱，但听说 You 酱已经早在 5 月份就把课程辅导这项业务外包给了你。</p>
<p>于是，现在菜宝手持两枚 Flag，希望你能帮她解答这些题目。你每小时可以提交一次答案，答对至少一半可以获得第一个 Flag，全部答对可以获得第二个 Flag。</p>
</div></div></details>
<p>这题模仿了Hackergame的猫咪问答，但感觉难度高了不少，一共八个题，每做出四个可以拿一个flag，另外提交答案有1h的CD，直接送走了爆破选手（例如本人。题目如下：</p>
<details class="toggle"><summary class="toggle-button">展开题目</summary><div class="toggle-content"><div class="note primary simple"><ol>
<li>北京大学燕园校区有理科 1 号楼到理科 X 号楼，但没有理科 (X+1) 号及之后的楼。X 是？<br>答案格式<code>^\d+$</code></li>
<li>上一届（第零届）比赛的总注册人数有多少？<br>答案格式<code>^\d+$</code></li>
<li>geekgame.pku.edu.cn 的 HTTPS 证书曾有一次忘记续期了，发生过期的时间是？<br>答案格式<code>^2021-\d\d-\d\dT\d\d:\d\d:\d3\+08:00$</code></li>
<li>2020 年 DEFCON CTF 资格赛签到题的 flag 是？<br>答案格式<code>^.+{.+}$</code></li>
<li>在大小为 672328094 * 386900246 的方形棋盘上放 3 枚（相同的）皇后且它们互不攻击，有几种方法？<br>答案格式<code>^\d+$</code></li>
<li>上一届（第零届）比赛的“小北问答1202”题目会把所有选手提交的答案存到 SQLite 数据库的一个表中，这个表名叫？<br>答案格式<code>^[a-z]+$</code></li>
<li>国际互联网由许多个自治系统（AS）组成。北京大学有一个自己的自治系统，它的编号是？<br>答案格式<code>^AS\d+$</code></li>
<li>截止到 2021 年 6 月 1 日，完全由北京大学信息科学技术学院下属的中文名称最长的实验室叫？<br>答案格式<code>^.{15,30}(实验室|中心)$</code></li>
</ol>
</div></div></details>
<p>我的解题方法（其中用到的搜索引擎均为Google）：</p>
<ol>
<li>依次搜索”北京大学燕园校区理科X号楼”（$X \in \mathbb{N}^+$），搜到$X=6$时，没搜出来相关结果，因此这题应该是5。</li>
<li>搜索”北京大学信息安全综合能力竞赛闭幕”，搜到<a target="_blank" rel="noopener" href="https://news.pku.edu.cn/xwzh/203d197d93c245a1aec23626bb43d464.htm">链接</a>，里面写了注册人数为407。</li>
<li>这题是我最后搜出来的，最开始的反应：这种信息能去哪搜啊？后来经过漫长的搜索，得知有Google有一个证书透明化的项目，打开<a target="_blank" rel="noopener" href="https://transparencyreport.google.com/https/certificates">此链接</a>，在里面搜索”geekgame.pku.edu.cn”，拿到一堆历史证书： <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/04e4268d-c561-4735-9d69-5ce791e45aea.png" alt="">注意到只有最后那个Let’s Encrypt的证书是已经过期了的（点进去一看在2021年7月11日过期），遗憾的是，报告中没有提供具体的时间，但回答这题需要精确到秒。思考片刻，我打开了浏览器开发者工具，抓了一下这个页面的包，抓到如下数据：<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/1eadcc0e-2b30-45a1-9ef9-e7701b1f3184.png" alt="">顺利拿到日期数据的UNIX时间戳，不过这里单位是毫秒，看到秒数是3我就确信找到了正确答案，将其转成日期：<code>time.strftime(&quot;%Y-%m-%dT%H:%M:%S+08:00&quot;, time.localtime(1625964593))</code>得到精确到秒的时间：2021-07-11T08:49:53+08:00。从<a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-1st/tree/master/writeups/players/%E6%AC%A2%E8%BF%8E%E5%8F%82%E5%8A%A0%E6%98%8E%E5%B9%B4%E5%8D%81%E6%9C%88%E4%BB%BD%E4%B8%AD%E7%A7%91%E5%A4%A7%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%BF%A1%E5%AE%89%E5%A4%A7%E8%B5%9B">Rank 1大佬的题解</a>中发现<a target="_blank" rel="noopener" href="https://crt.sh/">crt.sh</a>这个网站，搜起来更容易。</li>
<li>这种正规的比赛肯定会有Github仓库，直接找到然后在里面查到2020年quals<a target="_blank" rel="noopener" href="https://github.com/o-o-overflow/dc2020q-scoreboard/blob/073915aa5e5786beadfd06fe4aef04e7f4f50804/scoreboard_frontend/public/challenge_files/8a40c3a2ec3ef13216c5b3fd45b6631f1ad5b42497eda1ba618518f80f46712d/welcome.txt">签到题文件</a>，即可发现flag：OOO{this_is_the_welcome_flag}</li>
<li>这一题最开始被我当成了算法题研究了一天，随后作罢，开始正经搜答案。这题对搜索的关键词要求挺高的，如果搜中文关键词，基本拿不到什么有用的结果，都是清一色的“八皇后”问题。而如果搜”placing 3 quees on m * n board”，则可以搜到以下文章：<a target="_blank" rel="noopener" href="https://oeis.org/A047659">A047659 - OEIS</a>，里面给了通项公式，代入m和n去算就好了，这里我用python一开始遇到了浮点数精度问题，后来用符号计算解决了问题。答案是2933523260166137923998409309647057493882806525577536。（算出这个通项的人真是又无聊又牛逼。</li>
<li>去GeekGame-0th的Github仓库查看，发现<a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-0th/blob/main/src/choice/game/db.py#L33">答案</a>。submits</li>
<li>这题如果不加限制去搜，很容易搜到一个答案：AS24349，它的全称是CERNET2 IX at Peking University，但我提交了一下发现不对，后来注意到题目问的是“北京大学<strong>自己的</strong>自治系统”，搜”autonomous system number for peking university”，第一个结果是<a target="_blank" rel="noopener" href="https://ipinfo.io/AS59201">AS59201 Peking University details - IPinfo.io</a>，得到此题真正的答案：AS59201。</li>
<li>百度百科上居然能搜到<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E7%A7%91%E5%AD%A6%E6%8A%80%E6%9C%AF%E5%AD%A6%E9%99%A2/2850803">答案</a>，拉到“学术研究”标题，可以找到一个名字很长的实验室：“区域光纤通信网与新型光通信系统国家重点实验室”。</li>
</ol>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/6882d2ed-6bc7-40da-b742-d289ee561d34.png" alt=""></p>
<hr>
<h2 id="翻车的谜语人"><a href="#翻车的谜语人" class="headerlink" title="翻车的谜语人"></a>翻车的谜语人</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>作为曾担任上届比赛命题工作的资深谜语人，You 酱这次也被邀请来出一道考察信息隐写的 Misc 题目。You 酱找组委会确认了本届劳务费能否准时发放后就迅速开工了，但她不知道，这其实是一个彻彻底底的陷阱。</p>
<p>事实上，组委会曾在几个月前收到了报告，称 You 酱或违反规定在题目里私自掺杂大量私货，但这只是个猜想，不一定对。于是，组委会在邀请 You 酱命题的同时，派出间谍麻里奈小姐持续关注 You 酱的一举一动，希望能够发现决定性的证据。</p>
<p>麻里奈小姐不负众望，通过量子波动算法截获了一段 You 酱访问境外服务器的流量记录。现在她想让你来帮忙分析其中的端倪。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-1st/raw/master/problemset/attachment/prob07_i3xvrfbjbr48h3lr.zip">本题附件</a></p>
</div></div></details>
<p>这是一个流量分析题，我还是第一次接触这类题，之前也几乎没用过Wireshark。</p>
<p>拿到数据，发现是个pacp文件，用Wireshark打开：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/05b3a4b6-ce0d-4934-806e-1af667c91351.png" alt=""></p>
<p>先简单看了看流量的来源和目的，发现有两个内网IP：192.168.17.1、192.168.17.128，另外还有诸多公网IP，目测公网IP没什么用，先过滤掉：<code>ip.src == 192.168.17.1</code></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/a134d847-72b8-4551-ab28-27603a528098.webp" alt=""></p>
<p>注意到图中圈出的两条流量，经常用Jupyter notebook的同学应该对这两个链接不会陌生，看来You酱应该在和服务器上的Jupyter notebook进行交互，估计flag就藏在其中。</p>
<p>但这里的数据包实在是太多了，也不太好一个一个找，因此直接搜索hex值为”666c6167”（flag）的内容，马上就找到了相关信息。</p>
<p>从Jupyter notebook给的数据包中可以拼凑出其中的代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Random <span class="token keyword">import</span> get_random_bytes
<span class="token keyword">import</span> binascii

<span class="token keyword">def</span> <span class="token function">genflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">'flag&#123;%s&#125;'</span><span class="token operator">%</span>binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>get_random_bytes<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">xor_each</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">==</span><span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
    out <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        out<span class="token punctuation">.</span>append<span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>k<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span>

flag1 <span class="token operator">=</span> genflag<span class="token punctuation">(</span><span class="token punctuation">)</span>
flag2 <span class="token operator">=</span> genflag<span class="token punctuation">(</span><span class="token punctuation">)</span>
key <span class="token operator">=</span> get_random_bytes<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">)</span>

encoded_flag1 <span class="token operator">=</span> xor_each<span class="token punctuation">(</span>key<span class="token punctuation">,</span> flag1<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
encoded_flag2 <span class="token operator">=</span> xor_each<span class="token punctuation">(</span>key<span class="token punctuation">,</span> flag2<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag1.txt'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>encoded_flag1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag2.txt'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>encoded_flag2<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>同时还可以找到其中key的值：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/119088d9-20aa-4173-bb7e-cc6fee21d29a.png" alt=""></p>
<p>如此一来，只要能获取flag1.txt和flag2.txt，就可以通过以下代码解出两个flag（这里我直接把结果写在里面了，后面再说flag密文的获取方法）：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> binascii

key <span class="token operator">=</span> <span class="token string">b'\x1e\xe0[u\xf2\xf2\x81\x01U_\x9d!yc\x8e\xce[X\r\x04\x94\xbc9\x1d\xd7\xf8\xde\xdcd\xb2Q\xa3\x8a?\x16\xe5\x8a9'</span>
<span class="token comment">### flag1</span>
encoded_flag1 <span class="token operator">=</span> <span class="token string">'788c3a1289cbe5383466f9184b07edac6a6b3b37f78e0f7ce79bece502d63091ef5b7087bc44'</span>
encoded_bytes <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>encoded_flag1<span class="token punctuation">)</span>
flag1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>encoded_bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">### flag2</span>
encoded_flag2 <span class="token operator">=</span> <span class="token string">'788c3a128994e765373cfc171c00edfb3f603b67f68b087eb69cb8b8508135c5b90920d1b344'</span>
encoded_bytes <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>encoded_flag2<span class="token punctuation">)</span>
flag2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>encoded_bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Flag1"><a href="#Flag1" class="headerlink" title="Flag1"></a>Flag1</h3><p>点击Wireshark左上角File-&gt;Export Objects-&gt;HTTP，打开一个通过HTTP传输的文件列表，仔细寻找，发现两条flag相关文件：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/a15be5a8-571f-45ba-a9bf-6af3f01e37c5.png" alt=""></p>
<p>把他俩导出。其中flag1.txt内容如下：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"flag1.txt"</span><span class="token punctuation">,</span> <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"flag1.txt"</span><span class="token punctuation">,</span> <span class="token property">"last_modified"</span><span class="token operator">:</span> <span class="token string">"2021-11-06T07:43:20.952991Z"</span><span class="token punctuation">,</span> <span class="token property">"created"</span><span class="token operator">:</span> <span class="token string">"2021-11-06T07:43:20.952991Z"</span><span class="token punctuation">,</span> <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"788c3a1289cbe5383466f9184b07edac6a6b3b37f78e0f7ce79bece502d63091ef5b7087bc44"</span><span class="token punctuation">,</span> <span class="token property">"format"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span> <span class="token property">"mimetype"</span><span class="token operator">:</span> <span class="token string">"text/plain"</span><span class="token punctuation">,</span> <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token property">"writable"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"file"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>于是我们拿到了flag1。</p>
<h3 id="Flag2"><a href="#Flag2" class="headerlink" title="Flag2"></a>Flag2</h3><p>flag2是一个7z压缩文件，解压发现需要密码。<del>思路中止了</del>感觉应该还有相关信息，因此继续分析流量。在刚才的流量中继续翻，发现还有Websocket流量，随便看了几条比较靠前的，发现拼凑起来是个”pip3 install”，意识到与服务器有Shell交互，可能会有压缩文件之类的操作，因此筛选出来自192.168.17.128的websocket流量：<code>websocket and ip.src == 192.168.17.128</code></p>
<p>由于操作Wireshark不熟练，后面websocket内容我都是一个包一个包地看过去，并把内容拼起来，拼起来之后发现You酱敲的命令大概长下面这样：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip3 <span class="token function">install</span> stego-lsb
stegolsb wavsteg <span class="token parameter variable">-h</span> <span class="token parameter variable">-i</span> ki-ringtrain.wav <span class="token parameter variable">-s</span> flag2.txt <span class="token parameter variable">-o</span> flag2.wav <span class="token parameter variable">-n</span> <span class="token number">1</span>
7za a flag2.7z flag2.wav -p<span class="token string">"Wakarimasu! <span class="token variable"><span class="token variable">`</span><span class="token function">date</span><span class="token variable">`</span></span> <span class="token variable"><span class="token variable">`</span><span class="token function">uname</span> <span class="token parameter variable">-nom</span><span class="token variable">`</span></span> <span class="token variable"><span class="token variable">`</span>nproc<span class="token variable">`</span></span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>因此解flag2化为解<code>date</code>、<code>uname -nom</code>和<code>nproc</code>这三条命令在压缩时的输出字符串。</p>
<p><code>date</code>命令首先需要知道执行命令的具体时间，好在Wireshark记录了每一个package的相对时间，翻到最开始的websocket流量，可以找到一条登录信息，其中含有登录时间的字段：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/176db516-4e2b-453a-af7d-eb10669459be.png" alt=""></p>
<p>记录下wireshark内的时间戳和对应的date字段，然后就可以算出敲下压缩命令时的时间应该是”2021-11-06T07:44:15Z”，不过注意到这个时间以Z结尾，是UTC时间，服务器上显示的时间应该是CST，这是由于：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/87483379-593a-4a11-9b90-dde66a247336.png" alt=""></p>
<p>我发现flag2.wav的生成时间比上面那个正好多了8个小时，所以<code>date</code>命令敲下的时刻应该是”2021-11-06 15:44:15 CST”，现在只需要关心<code>date</code>命令的输出格式即可，而这个格式一般和系统有关。经过寻找，我发现You酱的服务器是kali linux：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/f23d9b06-8e70-4ea8-bb99-ff2c638336d8.png" alt=""></p>
<p>这里顺便把<code>uname</code>命令的输出解决了（you-kali-vm x86_64 GNU/Linux）。</p>
<p>正好电脑上有一个kali的docker容器，打开来跑了一下<code>date</code>，得出前面<code>date</code>命令的输出为：Sat 06 Nov 2021 03:44:15 PM CST。</p>
<p>另外，<code>nproc</code>命令的默认输出一般是CPU核心数量，在7za命令的输出结果中，可以找到下面的内容：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/0d088442-8fc5-4bf0-a64a-ac4ae320250c.png" alt=""><br>64bit说明前面uname的输出x86_64应该是对的，8 CPUs说明nproc很可能就是8。</p>
<p>试了一下密码：<code>Wakarimasu! Sat 06 Nov 2021 03:44:15 PM CST you-kali-vm x86_64 GNU/Linux 8</code></p>
<p>成功解压出flag2.wav，接下来用stego-lsb进行decode，可以获取到加密后的flag2：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">stegolsb wavsteg <span class="token parameter variable">-r</span> <span class="token parameter variable">-i</span> flag2.wav <span class="token parameter variable">-o</span> flag2.txt <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token parameter variable">-b</span> <span class="token number">76</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>最后用最开始的代码解一下密，flag2也获取到了。</p>
<ul>
<li>flag1: flag{9d9a9d92dcb1363c26a0c29fda2edfb6}</li>
<li>flag2: flag{ffdbca6ecc5d86cb71cadfd43df36649}</li>
</ul>
<hr>
<h2 id="在线解压网站"><a href="#在线解压网站" class="headerlink" title="在线解压网站"></a>在线解压网站</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>Q 小网盘可以在线预览多种文件，但是唯独压缩文件不能在线解压。这让小 A 十分难受。</p>
<p>为了解决这个问题，小 A 写了一个在线解压网站。只要你上传zip文件到这个网站，它就会自动帮你解压，之后你就可以访问解压出来的文件了。配合着浏览器插件，可以完美解决 Q 小网盘的痛点。</p>
<p>为了让大家相信他的网站是安全的，不会把压缩文件内容的泄漏给其他人，他在磁盘根目录下放了一个叫 flag 的文件，声称只要能拿到其中内容就可以获得一顿火锅。你以他的网站功能并不完整为理由，想骗取一顿火锅。然而他只是表示这并不影响网站的安全性，只有攻破网站的人才能获得火锅。</p>
<p>你十分生气，铁了心地要吃上这顿免费的火锅。</p>
<p>你可以<a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-1st/blob/master/problemset/attachment/prob02_dbkw1hg2nj6qraif.zip">下载本题的程序</a></p>
</div></div></details>
<p>一开始随便上传了一个文件，然后尝试了直接访问/media/../../../../flag之类的路径，但用浏览器访问拿到404，用requests访问拿到400，均行不通。后来发现，后端代码是用<code>open</code>函数把文件读出来返回给我的，那么应该可以通过sym link去拿flag文件。因此：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">ln</span> <span class="token parameter variable">-s</span> /flag hello<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>压缩为hello.zip并上传，下载hello文件打开即获取flag。</p>
<p>flag{NEV3r_truSt_Any_C0mpresSed_File}</p>
<hr>
<h2 id="密码学实践"><a href="#密码学实践" class="headerlink" title="密码学实践"></a>密码学实践</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>小 R 在秋季学期选了一门叫《密码学基础》的课程。然而在第一节课上，他就发现这门课似乎和他想象中的不太一样（懂的都懂）。</p>
<p>望着投影上密密麻麻的数学公式，中期退课的意愿在他的脑中愈加强烈。他只是想学一下密码学在现实中的应用，怎么就变成了数学公式的推导了呢？</p>
<p>他还记得第一节课的课件上的一句话：“学了这门课后，你也不能学会设计一个密码学系统”。</p>
<p>但他仍在这门课上了解了不少知识。他了解了哈希函数的构造，了解了私钥密码系统的设计，了解了现有的公钥密码体系。</p>
<p>“既然课程只讲密码学理论，那我就自己做密码学实践。”</p>
<p>这是他构建的密码学世界，他希望在这个世界内只有对的人才能拥有旗帜。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-1st/raw/master/problemset/attachment/prob08_jd7sj1fvdmofhhvx.zip">本题附件</a></p>
</div></div></details>
<p>同样是密码学类型的题，这题也比Hackergame 2021的Easy RSA难的多，与前者相比，后者只能算是一个简单的数学题了。不过由于我并没有学过密码学，因此第二问中RSA签名的伪造方法相比于<a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-1st/tree/master/writeups/players/%E6%AC%A2%E8%BF%8E%E5%8F%82%E5%8A%A0%E6%98%8E%E5%B9%B4%E5%8D%81%E6%9C%88%E4%BB%BD%E4%B8%AD%E7%A7%91%E5%A4%A7%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%BF%A1%E5%AE%89%E5%A4%A7%E8%B5%9B#%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AE%9E%E8%B7%B5">大佬的解法</a>复杂了不少。</p>
<p>这题有两个flag，拿到代码先看一下两个flag在哪给出，容易找到它们都位于server.py的<code>doRichard</code>函数中：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">doRichard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>MESenc<span class="token punctuation">(</span>pad<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"Hello, Alice! I will give you two flags. The first is: "</span><span class="token operator">+</span>flag1<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Public_key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>MESenc<span class="token punctuation">(</span>pad<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"Sorry, I forget to verify your identity. Please give me your certificate."</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Public_key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    Acert<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    sinfo<span class="token operator">=</span>dec<span class="token punctuation">(</span>Acert<span class="token punctuation">)</span>
    akey<span class="token operator">=</span>unpackmess<span class="token punctuation">(</span>sinfo<span class="token punctuation">)</span>
    pinfo<span class="token operator">=</span>sinfo<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>sinfo<span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>akey<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
    aname<span class="token operator">=</span>unpackmess<span class="token punctuation">(</span>pinfo<span class="token punctuation">)</span>
    <span class="token keyword">if</span> aname<span class="token operator">!=</span><span class="token string">b"Alice"</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Who are you?!"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    old_key<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>Public_key<span class="token punctuation">,</span><span class="token string">'big'</span><span class="token punctuation">)</span>
    comm_key<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>akey<span class="token punctuation">,</span><span class="token string">'big'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>Richard_key<span class="token punctuation">,</span><span class="token string">'big'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>P<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>comm_key<span class="token operator">>></span>i<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">:</span>
            old_key<span class="token operator">=</span><span class="token punctuation">(</span>old_key<span class="token operator">^</span><span class="token punctuation">(</span>old_key<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">2048</span><span class="token punctuation">)</span>
    new_key<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>old_key<span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">,</span><span class="token string">'big'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>MESenc<span class="token punctuation">(</span>pad<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"I can give you the second flag now. It is: "</span><span class="token operator">+</span>flag2<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>new_key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>通过选择”Talk to Richard”可以执行这个函数，但不幸的是，Richard发来的消息均经过了加密，加密算法位于rsa.py，如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">MESenc</span><span class="token punctuation">(</span>mess<span class="token punctuation">:</span><span class="token builtin">bytes</span><span class="token punctuation">,</span>skey<span class="token punctuation">:</span><span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>skey<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">8</span><span class="token operator">*</span><span class="token number">32</span>
    keys <span class="token operator">=</span> <span class="token punctuation">[</span>bytes_to_long<span class="token punctuation">(</span>skey<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">32</span> <span class="token operator">==</span> <span class="token number">0</span>
    cip<span class="token operator">=</span><span class="token string">b""</span>
    <span class="token keyword">for</span> it <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        pmess<span class="token operator">=</span>mess<span class="token punctuation">[</span>it<span class="token punctuation">:</span>it<span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">]</span>
        a <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>pmess<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>pmess<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>pmess<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>pmess<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> key <span class="token keyword">in</span> keys<span class="token punctuation">:</span>
            a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d <span class="token operator">=</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a <span class="token operator">^</span> c <span class="token operator">^</span> key
        a<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
        b<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span>b<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
        c<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span>c<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
        d<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span>d<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
        cip<span class="token operator">+=</span>a<span class="token operator">+</span>b<span class="token operator">+</span>c<span class="token operator">+</span>d
    <span class="token keyword">return</span> cip<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>用到的密钥是一个随机生成的长度为256 byte的<code>Publik_key</code>，并且没有告诉我们。但有一个突破口是，我们拥有一条已知密文的明文：</p>
<p>“Sorry, I forget to verify your identity. Please give me your certificate.”</p>
<p>看看能不能通过这个信息解出同样由<code>Public_key</code>加密的带有flag1的明文信息。</p>
<h3 id="Flag1-1"><a href="#Flag1-1" class="headerlink" title="Flag1"></a>Flag1</h3><p>带着这个想法我开始研究<code>MESenc</code>函数，我发现它的加密算法是将pad后的消息按长度每32分为一组，每一组再拆成4个长度为8的子串，然后对每一组分别进行一轮独立的加密，加密的过程是将密钥分为32个长度为8 byte的子密钥，然后进行一轮看似简单的迭代：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> key <span class="token keyword">in</span> keys<span class="token punctuation">:</span>
    a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d <span class="token operator">=</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a <span class="token operator">^</span> c <span class="token operator">^</span> key<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>虽然迭代过程很容易懂，但通过明密文推出key是不太现实的事。但我们发现，这里唯一出现的运算是异或($\oplus$)，而异或有一些很好的性质：</p>
<ol>
<li>$x\oplus y = y \oplus x$</li>
<li>$x\oplus x = 0$</li>
<li>$0\oplus x = x$</li>
</ol>
<p>对于每一组的a、b、c、d，若把加密之前的值记为$a_0,b_0,c_0,d_0$，加密之后的值（密文与之对应的分组）记为$a_1,b_1,c_1,d_1$，那么$a_1,b_1,c_1,d_1$一定都是由$a_0,b_0,c_0,d_0$以及所有的子密钥按某种未知但固定的组合进行异或运算得到的。</p>
<p>按此逻辑，如果我们有两条由同一密钥加密得来的长度相同的密文，它们的分组数量因此相同，分别取它们来自同一位置分组（比如都取出各自的第0组）的$a,b,c,d$值，记为$a_1,b_1,c_1,d_1$和$a_2,b_2,c_2,d_2$，分别进行异或运算：</p>
<script type="math/tex;mode=display">a_1\oplus a_2,\ b_1\oplus b_2,\ c_1\oplus c_2,\ d_1\oplus d_2</script><p>结合异或运算的三条性质，上面的操作可以把所有与密钥相关的变量消去。因此得到的四个异或值与密钥是没有关系的，只与明文有关系。而很巧的是，这里Richard发来的两条密文的长度都是96，这样就不会有落单的分组了。</p>
<p>在这种情况成立的条件下，我们只要看一下经过32轮迭代以后的$a,b,c,d$除掉与key相关的值以后，与迭代前的$a,b,c,d$的具体映射关系，可以画一个表格看一下$a,b,c,d$每一轮的变化：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>a</th>
<th>b</th>
<th>c</th>
<th>d</th>
</tr>
</thead>
<tbody>
<tr>
<td>b</td>
<td>c</td>
<td>d</td>
<td>a ^ c</td>
</tr>
<tr>
<td>c</td>
<td>d</td>
<td>a ^ c</td>
<td>b ^ d</td>
</tr>
<tr>
<td>d</td>
<td>a ^ c</td>
<td>b ^ d</td>
<td>a</td>
</tr>
<tr>
<td>a ^ c</td>
<td>b ^ d</td>
<td>a</td>
<td>b</td>
</tr>
<tr>
<td>b ^ d</td>
<td>a</td>
<td>b</td>
<td>c</td>
</tr>
<tr>
<td>a</td>
<td>b</td>
<td>c</td>
<td>d</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
</div>
<p>我们发现，它具有周期6，而32 % 6 = 2，故32轮迭代后，最终的（去掉所有key相关的值以后）结果应该是：</p>
<ul>
<li>$a_1=c$</li>
<li>$b_1=d$</li>
<li>$c_1=a\oplus c$</li>
<li>$d_1=b\oplus d$</li>
</ul>
<p>所以可以推导出这样一个结论：</p>
<p>已有明文$m_1$与$m_2$，使用同一密钥进行加密得到的密文分别是$cip_1$与$cip_2$，则任取两条明文的同一位置上的分组$a_1,b_1,c_1,d_1$和$a_2,b_2,c_2,d_2$以及两条密文对应的分组$a_3,b_3,c_3,d_3$和$a_4,b_4,c_4,d_4$，则必定满足：</p>
<ul>
<li>$c_1\oplus c_2 = a_3\oplus a_4$</li>
<li>$d_1\oplus d_2 = b_3\oplus b_4$</li>
<li>$a_1\oplus a_2\oplus c_1\oplus c_2 = c_3\oplus c_4$</li>
<li>$b_1\oplus b_2\oplus d_1\oplus d_2 = d_3\oplus d_4$</li>
</ul>
<p>因此，我们可以写出解密代码如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytes
<span class="token keyword">import</span> binascii


<span class="token keyword">def</span> <span class="token function">pad</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>
    n <span class="token operator">=</span> <span class="token number">32</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">32</span>
    <span class="token keyword">return</span> msg <span class="token operator">+</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> n


<span class="token keyword">def</span> <span class="token function">group</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>
    results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> it <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        pmsg <span class="token operator">=</span> msg<span class="token punctuation">[</span>it<span class="token punctuation">:</span> it <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">]</span>
        a <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>pmsg<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>pmsg<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>pmsg<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>pmsg<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">:</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        results<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> results


<span class="token keyword">def</span> <span class="token function">get_xor</span><span class="token punctuation">(</span>cip1<span class="token punctuation">,</span> cip2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    r1 <span class="token operator">=</span> group<span class="token punctuation">(</span>cip1<span class="token punctuation">)</span>
    r2 <span class="token operator">=</span> group<span class="token punctuation">(</span>cip2<span class="token punctuation">)</span>
    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>a1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> d1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>a2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> d2<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>r1<span class="token punctuation">,</span> r2<span class="token punctuation">)</span><span class="token punctuation">:</span>
        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>a1 <span class="token operator">^</span> a2<span class="token punctuation">,</span> b1 <span class="token operator">^</span> b2<span class="token punctuation">,</span> c1 <span class="token operator">^</span> c2<span class="token punctuation">,</span> d1 <span class="token operator">^</span> d2<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result


<span class="token keyword">def</span> <span class="token function">get_message</span><span class="token punctuation">(</span>msg1<span class="token punctuation">,</span> xor_result<span class="token punctuation">)</span><span class="token punctuation">:</span>
    r <span class="token operator">=</span> group<span class="token punctuation">(</span>msg1<span class="token punctuation">)</span>
    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ra<span class="token punctuation">,</span> rb<span class="token punctuation">,</span> rc<span class="token punctuation">,</span> rd<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> xor_result<span class="token punctuation">)</span><span class="token punctuation">:</span>
        result_c <span class="token operator">=</span> c <span class="token operator">^</span> ra
        result_d <span class="token operator">=</span> d <span class="token operator">^</span> rb
        result_a <span class="token operator">=</span> rc <span class="token operator">^</span> a <span class="token operator">^</span> c <span class="token operator">^</span> result_c
        result_b <span class="token operator">=</span> rd <span class="token operator">^</span> b <span class="token operator">^</span> d <span class="token operator">^</span> result_d
        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>result_a<span class="token punctuation">,</span> result_b<span class="token punctuation">,</span> result_c<span class="token punctuation">,</span> result_d<span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg2 <span class="token operator">=</span> <span class="token string">b''</span>
    <span class="token keyword">for</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d <span class="token keyword">in</span> result<span class="token punctuation">:</span>
        a <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
        msg2 <span class="token operator">+=</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c <span class="token operator">+</span> d
    <span class="token keyword">return</span> msg2


<span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>cip1<span class="token punctuation">,</span> cip2<span class="token punctuation">,</span> msg2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""To decode cip1"""</span>
    cip1 <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>cip1<span class="token punctuation">)</span>
    cip2 <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>cip2<span class="token punctuation">)</span>
    msg2 <span class="token operator">=</span> pad<span class="token punctuation">(</span>msg2<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg1 <span class="token operator">=</span> get_message<span class="token punctuation">(</span>msg2<span class="token punctuation">,</span> get_xor<span class="token punctuation">(</span>cip1<span class="token punctuation">,</span> cip2<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> msg1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以我拿到的两串密文为例，解密flag1，只需：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">flag1_cip <span class="token operator">=</span> <span class="token string">'8981fe27b7ab28561cb53c4ec48f74c4d2cc4a3e3ecd15096f31c35057f3bbb28d9cb222e4f6614615f4225af7ca31e0f1940c3b63db0f762a4dd64465f0dec4a189fc14d89b075d719d4d29b9a708bbc6e4683e70b44e345e02ba0d659ebd89'</span>
cip <span class="token operator">=</span> <span class="token string">'8a87b23df2be284600b53c4ec4dd20dacac0183a6dd815113f3ecf4711e4d2ac9981e42eb7a1240000fa305391cc65c1eecc522f389f40303f47c04d42e386b7e9ff855c80db56376e825236a6b817a48ebe3b4005f03f4c5f78d95a03f386e5'</span>
msg <span class="token operator">=</span> <span class="token string">'Sorry, I forget to verify your identity. Please give me your certificate.'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>flag1_cip<span class="token punctuation">,</span> cip<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Hello, Alice! I will give you two flags. The first is: flag{Fe1StEL_NeTw0rk_ne3d_an_OWF}\x08\x08\x08\x08\x08\x08\x08\x08</p>
<h3 id="Flag2-1"><a href="#Flag2-1" class="headerlink" title="Flag2"></a>Flag2</h3><p>接下来看看flag2的生成过程，在给出flag1后，Richard表示需要先验证我的身份，需要我输入一串十进制整数，并经过以下的操作：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">Acert<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sinfo<span class="token operator">=</span>dec<span class="token punctuation">(</span>Acert<span class="token punctuation">)</span>
akey<span class="token operator">=</span>unpackmess<span class="token punctuation">(</span>sinfo<span class="token punctuation">)</span>
pinfo<span class="token operator">=</span>sinfo<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>sinfo<span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>akey<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
aname<span class="token operator">=</span>unpackmess<span class="token punctuation">(</span>pinfo<span class="token punctuation">)</span>
<span class="token keyword">if</span> aname<span class="token operator">!=</span><span class="token string">b"Alice"</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Who are you?!"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>若结果不是<code>b&quot;Alice&quot;</code>，则Richard翻脸，不给我flag2。</p>
<h4 id="冒充Alice"><a href="#冒充Alice" class="headerlink" title="冒充Alice"></a>冒充Alice</h4><p>那我们只要凑一个<code>Acert</code>，让它的验签结果恰好是<code>b&quot;Alice&quot;</code>就可以了。</p>
<p>在此之前，我们需要清楚地知道验签过程中出现的<code>dec</code>、<code>unpackmess</code>函数以及他俩的逆函数<code>enc</code>、<code>packmess</code>具体在干啥，<code>dec</code>和<code>enc</code>不用多说，一看就知道，分别是RSA的解密和加密，不过这里因为是作为签名使用，加密过程用的是私钥，解密过程用的则是公钥。</p>
<p>另外还有两个函数<code>packmess</code>和<code>unpackmess</code>，具体如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">packmess</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">65535</span>
    <span class="token keyword">return</span> mess<span class="token operator">+</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'big'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">unpackmess</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span><span class="token punctuation">:</span>
    rlen<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>mess<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'big'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> rlen<span class="token operator">></span><span class="token builtin">len</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span>
        mess<span class="token operator">=</span><span class="token string">b'\x00'</span><span class="token operator">*</span><span class="token punctuation">(</span>rlen<span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span>mess
    <span class="token keyword">return</span> mess<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">+</span>rlen<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>容易知道<code>packmess</code>的作用是把消息长度（不大于65535）转化成2个byte并附加在消息最后，<code>unpackmess</code>则基本与之相反，当<code>mess</code>的最后两个字节表示的长度比消息自身大的时候，在消息最前面用<code>\x00</code>进行填补再去掉末尾两个字节；否则返回的是<code>mess[-(2 + rlen) : -2]</code>，我们发现这个函数返回的字节长度恰好是<code>rlen</code>，其实说白了就是按最后两个byte给的长度来填补或截取<code>mess</code>再返回。</p>
<p>知道了这俩函数的用途后，我们首先可以得到<code>pinfo=b&#39;Alice\x00\x05&#39;</code>，接下来需要推导出<code>sinfo</code>的值，我们重新写出两者的关系：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">akey<span class="token operator">=</span>unpackmess<span class="token punctuation">(</span>sinfo<span class="token punctuation">)</span>
pinfo<span class="token operator">=</span>sinfo<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>sinfo<span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>akey<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>通过对<code>unpackmess</code>函数的理解我们可以写出一种满足条件的<code>sinfo</code>的值：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">sinfo <span class="token operator">=</span> pinfo <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> rlen <span class="token operator">+</span> <span class="token builtin">int</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>rlen<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span> <span class="token comment"># 0 &lt;= rlen &lt;= 65535</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在得到了<code>sinfo</code>后，我们还需要计算出<code>Acert</code>，后者经过<code>dec</code>解密得到前者：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">sinfo <span class="token operator">=</span> dec<span class="token punctuation">(</span>Acert<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>那么对应地，我们有：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">Acert <span class="token operator">=</span> enc<span class="token punctuation">(</span>sinfo<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>现在的问题是，我们并没有拿到God的RSA密钥<code>d</code>，没有办法自己加密，但注意到，God那边可以注册登记人口：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">doGod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"My RSA N is: "</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>rsa_key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"My RSA e is: "</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>rsa_key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"What is your name?"</span><span class="token punctuation">)</span>
    name<span class="token operator">=</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"What is your key?"</span><span class="token punctuation">)</span>
    key<span class="token operator">=</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> name <span class="token keyword">in</span> certs<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"I can not issue multiple certificates to one person."</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>certs<span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">5</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"I can not remember more than 5 people."</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    result<span class="token operator">=</span>register<span class="token punctuation">(</span>name<span class="token punctuation">,</span>key<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Your certificate is:"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输入<code>name</code>和<code>key</code>之后，God会调用<code>register</code>函数生成一个certificate并告诉我们，而<code>register</code>函数调用了<code>getcert</code>函数，后者代码如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">getcert</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    rmess<span class="token operator">=</span>packmess<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token operator">+</span>packmess<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token keyword">return</span> enc<span class="token punctuation">(</span>rmess<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>这里调用了<code>enc</code>函数，因此我们可以想办法利用一下God，让他帮我们做<code>enc</code>操作。</p>
<p><strong>第一个想法</strong>：我们只需要构造<code>name</code>和<code>key</code>使得<code>packmess(name) + packmess(key) == sinfo</code></p>
<p>回看前面得到的<code>sinfo</code>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">sinfo <span class="token operator">=</span> pinfo <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> rlen <span class="token operator">+</span> <span class="token builtin">int</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>rlen<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>sinfo</code>的前七个字节一定是<code>b&quot;Alice\x00\x05&quot;</code>，这就要求<code>packmess(name)</code>前七个字节也是<code>b&quot;Alice\x00\x05&quot;</code>，但注意到<code>sinfo</code>的长度是<code>9 + rlen</code>，如果<code>name</code>不是<code>b&quot;Alice&quot;</code>，那么<code>name</code>一定是<code>b&quot;Alice&quot;</code>加上一些字节这种形式，那么<code>packmess(name)</code>的长度将大于7，虽然我们可以通过修改<code>sinfo</code>中间的pad值以让前面部分与<code>packmess(name)</code>相同，但事实上，在这种情况下，<code>packmess(key)</code>的长度将小于<code>2 + rlen</code>（因为二者之和是固定的<code>9 + rlen</code>），而<code>packmess(key)</code>的最后两个字节必须与<code>sinfo</code>一样，也是<code>int.to_bytes(rlen, 2, &#39;big&#39;)</code>，这意味着<code>key</code>的长度必须是<code>rlen</code>，这与<code>packmess(key)</code>的长度小于<code>2 + rlen</code>是矛盾的。如果<code>name</code>是<code>b&quot;Alice&quot;</code>，那么God会把我们拦下来，因为Alice这个ID已经被抢注了。因此这条路没办法走通。</p>
<p><strong>第二个想法</strong>：我们可以找一个方法来间接算出<code>enc(sinfo)</code>。</p>
<p>整理一下，目前我们拥有God提供的n和e，需要加密的信息<code>sinfo</code>，除此以外，一无所有。但我们仍然有办法用未知的私钥<code>d</code>给<code>sinfo</code>加密。<br>方便起见，下面将<code>sinfo</code>记为整数$m$。</p>
<p>我们要计算$m ^ d \ mod \ n$。</p>
<p>首先，找一个和$n$互素的正整数$k$，这应该比较容易。</p>
<p>然后计算</p>
<script type="math/tex;mode=display">y = (m \times k ^e) \ mod \ n</script><p>再令</p>
<script type="math/tex;mode=display">\begin{aligned}z &= y ^ d \ mod \ n \\ &= (m ^ d \times k ^{ed}) \ mod \ n \\ &=(m ^ d \times k \times k ^{ed-1}) \\ & =(m ^ d \times k \times k ^{k_1\phi(n)})\\&=(m ^ d \times k) \ mod \ n\end{aligned}</script><p>其中最后一步应用了Euler’s Theorem。因此我们有：</p>
<script type="math/tex;mode=display">m ^ d = (z \times k ^ {-1}) \ mod \ n</script><p>上面的$k ^ {-1}$指$k$在$\mathbb{Z}_n$乘法群中的逆元，由于$k$与$n$互素，逆元必存在。</p>
<p>整个过程用人话讲就是说，我们随便找一个$k$，只要运气不太差就能保证$k$与$n$互素，然后计算一下$y$，让God对$y$进行加密，拿到密文$z$，最后计算$z$与$k$逆元在模$n$意义下的乘积，即拿到我们需要的$m$的密文。</p>
<p>接下来，唯一的任务就是根据$y$来构造<code>name</code>和<code>key</code>，使得<code>int.from_bytes(packmess(name) + packmess(key), &#39;big&#39;) == y</code></p>
<p>猥琐起见，我们固定$k=2$，（$n$不会有因子2吧，不会吧不会吧！），计算$y$：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">k <span class="token operator">=</span> <span class="token number">2</span>
y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>sinfo<span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token number">65537</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>设<code>length = int.from_bytes(y.to_bytes(256, &#39;big&#39;)[-2:], &#39;big&#39;)</code>，我们要让<code>len(key) == length</code>，这样在<code>packmess</code>之后才能与y的末两位相同，这里的256是我找的一个刚好可以覆盖<code>y</code>长度的值，事实上取大一点并不会影响末两位的值，这样一来，<code>packmess(key)</code>的长度为<code>length + 2</code>，至于<code>key</code>的值，只要从<code>y</code>转成的字节中取至倒数第三位，再对前面部分根据<code>name</code>的情况做一些修改。现在来看<code>name</code>，假如这里<code>name</code>长度不为0，那么<code>packmess(name)</code>会得到一些非<code>b&#39;\x00&#39;</code>的不可控量拼接在前面，由于<code>y</code>几乎是随机生成的，这些字节不能保证正好出现在<code>y</code>的对应位置上，但如果我们直接令<code>name = b&#39;&#39;</code>，那么<code>packmess(name)</code>的值为<code>b&#39;\x00\x00&#39;</code>，而这种东西，我们想要多少就可以有多少，只要把<code>y</code>转字节的时候故意加长一点就好了！</p>
<p>这样构造时，由于<code>packmess(name) + packmess(key)</code>的长度为<code>length + 4</code>，我们要把<code>y</code>转化成等长的字节，那么只要<code>length + 4 &gt;= 258</code> （比256多2是为了在最前面pad出至少两个<code>b&#39;\x00&#39;</code>）就可以保证成功。要让随机的16位2进制数不小于254，粗略计算了一下这个概率应该不小于0.998（前9位全是0的情况下才可能小于254）。生成<code>key</code>的代码如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">k <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">def</span> <span class="token function">get_key</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>sinfo<span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token number">65537</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n
    length <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>y<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> y<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>length <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
    x <span class="token operator">=</span> y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>代码的逻辑是，<code>y.to_bytes(length + 4, &#39;big&#39;)</code>的前两位有极大概率是<code>b&#39;\x00\x00&#39;</code>，这部分用<code>packmess(b&#39;&#39;)</code>去填补，<code>y</code>的中间部分<code>y[2: -2]</code>用<code>key</code>去填补，而这部分的长度是<code>length + 4 - 4 = length</code>，恰好是<code>y</code>的末两字节，因此在<code>packmess</code>以后恰好能把<code>y</code>的末两字节填上。</p>
<p>构造了<code>name</code>和<code>key</code>，我们拿去丢给God，让他帮我们加密出一个certificate出来，当然，他以为这是certificate，但实际上我们准备利用这个东西去冒充Alice：</p>
<p>按照前面的推导，我们已经拿到了$z$，那么计算$m ^ d \ mod \ n$只需要计算$(z \times k ^ {-1}) \ mod \ n$：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_certificate</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> <span class="token punctuation">(</span>z <span class="token operator">*</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>k<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n
    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>这个函数用来计算我们真正需要的certificate，用以冒充Alice。</p>
<p>经过实验，冒充成功：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/0d29a2e3-efc4-4c0e-8e52-33cf7519fbf6.png" alt=""></p>
<h4 id="解密flag2"><a href="#解密flag2" class="headerlink" title="解密flag2"></a>解密flag2</h4><p>现在我们冒充Alice成功拿到了包含flag2的密文，但这里和前面不同的是，加密用的密钥变了：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">old_key <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>Public_key<span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
comm_key <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>akey<span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>Richard_key<span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> P<span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">128</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>comm_key <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">:</span>
        old_key <span class="token operator">=</span> <span class="token punctuation">(</span>old_key <span class="token operator">^</span> <span class="token punctuation">(</span>old_key <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">**</span> <span class="token number">2048</span><span class="token punctuation">)</span>
new_key <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>old_key<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>MESenc<span class="token punctuation">(</span>pad<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"I can give you the second flag now. It is: flag2&#123;this_is_flag_2&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>new_key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>Public_key</code>经过了复杂的计算得到了最终的<code>new_key</code>，如果就这么让他修改密钥，那前面用来解flag1的方法就一点用都没有了，而且修改密钥的过程还用了我们所不知道的<code>Richard_key</code>，重新分析新的解密方法基本上行不通。但是我们注意到，<code>comm_key</code>是由<code>akey</code>做幂运算得来的，而<code>akey = unpackmess(sinfo)</code></p>
<p>回顾一下<code>sinfo</code>：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">sinfo <span class="token operator">=</span> pinfo <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> rlen <span class="token operator">+</span> <span class="token builtin">int</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>rlen<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>如果让<code>rlen</code>取为0，则<code>akey</code>直接变成空字节，其对应的整数是0，这样<code>comm_key</code>就变成0了，下面循环里的if语句一次都进不去，这样得到的<code>new_key</code>其实还是<code>Public_key</code>，如此一来，按照前面拿flag1的方法即可拿到flag2。</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/6b1ba889-f80e-4e12-8e53-02e2076d7409.png" alt=""></p>
<ul>
<li>flag1: flag{Fe1StEL_NeTw0rk_ne3d_an_OWF}</li>
<li>flag2: flag{RSA_1s_multiPLic4tivE_Hom0MorPHic}</li>
</ul>
<p>全部解题代码：</p>
<p>interact.py</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pwn
<span class="token keyword">from</span> pass_identity <span class="token keyword">import</span> get_key<span class="token punctuation">,</span> get_certificate
<span class="token keyword">from</span> decode_flag <span class="token keyword">import</span> decode


<span class="token keyword">def</span> <span class="token function">unpackmess</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span><span class="token punctuation">:</span>
    rlen <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>mess<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> rlen <span class="token operator">></span> <span class="token builtin">len</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">:</span>
        mess <span class="token operator">=</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token punctuation">(</span>rlen <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> mess
    <span class="token keyword">return</span> mess<span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> rlen<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>


r <span class="token operator">=</span> pwn<span class="token punctuation">.</span>remote<span class="token punctuation">(</span><span class="token string">'prob08.geekgame.pku.edu.cn'</span><span class="token punctuation">,</span> <span class="token number">10008</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'Please input your token:\n'</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'0:this_is_my_token'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'Talk to Richard.\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'0'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Send 0\n'</span><span class="token punctuation">)</span>
msg <span class="token operator">=</span> r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'What is your name?\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b''</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Send ""\n'</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
key <span class="token operator">=</span> get_key<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'What is your key?\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>key<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Send '</span><span class="token punctuation">,</span> key<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
msg <span class="token operator">=</span> r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'Talk to Richard.\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
z <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'1'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Send 1\n'</span><span class="token punctuation">)</span>
msg <span class="token operator">=</span> r<span class="token punctuation">.</span>recvrepeat<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
flag1_cip<span class="token punctuation">,</span> cip <span class="token operator">=</span> msg<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
cert <span class="token operator">=</span> get_certificate<span class="token punctuation">(</span>n<span class="token punctuation">,</span> z<span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>cert<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Send '</span><span class="token punctuation">,</span> cert<span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
msg <span class="token operator">=</span> r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'Talk to Richard.\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
flag2_cip <span class="token operator">=</span> msg<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag2_cip<span class="token punctuation">)</span>
msg <span class="token operator">=</span> <span class="token string">'Sorry, I forget to verify your identity. Please give me your certificate.'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>flag1_cip<span class="token punctuation">,</span> cip<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>flag2_cip<span class="token punctuation">,</span> cip<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>decode_flag.py</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytes
<span class="token keyword">import</span> binascii


<span class="token keyword">def</span> <span class="token function">pad</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>
    n <span class="token operator">=</span> <span class="token number">32</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">32</span>
    <span class="token keyword">return</span> msg <span class="token operator">+</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> n


<span class="token keyword">def</span> <span class="token function">group</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>
    results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> it <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        pmsg <span class="token operator">=</span> msg<span class="token punctuation">[</span>it<span class="token punctuation">:</span> it <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">]</span>
        a <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>pmsg<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>pmsg<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>pmsg<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>pmsg<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">:</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        results<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> results


<span class="token keyword">def</span> <span class="token function">get_xor</span><span class="token punctuation">(</span>cip1<span class="token punctuation">,</span> cip2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    r1 <span class="token operator">=</span> group<span class="token punctuation">(</span>cip1<span class="token punctuation">)</span>
    r2 <span class="token operator">=</span> group<span class="token punctuation">(</span>cip2<span class="token punctuation">)</span>
    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>a1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> d1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>a2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> d2<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>r1<span class="token punctuation">,</span> r2<span class="token punctuation">)</span><span class="token punctuation">:</span>
        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>a1 <span class="token operator">^</span> a2<span class="token punctuation">,</span> b1 <span class="token operator">^</span> b2<span class="token punctuation">,</span> c1 <span class="token operator">^</span> c2<span class="token punctuation">,</span> d1 <span class="token operator">^</span> d2<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result


<span class="token keyword">def</span> <span class="token function">get_message</span><span class="token punctuation">(</span>msg1<span class="token punctuation">,</span> xor_result<span class="token punctuation">)</span><span class="token punctuation">:</span>
    r <span class="token operator">=</span> group<span class="token punctuation">(</span>msg1<span class="token punctuation">)</span>
    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ra<span class="token punctuation">,</span> rb<span class="token punctuation">,</span> rc<span class="token punctuation">,</span> rd<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> xor_result<span class="token punctuation">)</span><span class="token punctuation">:</span>
        result_c <span class="token operator">=</span> c <span class="token operator">^</span> ra
        result_d <span class="token operator">=</span> d <span class="token operator">^</span> rb
        result_a <span class="token operator">=</span> rc <span class="token operator">^</span> a <span class="token operator">^</span> c <span class="token operator">^</span> result_c
        result_b <span class="token operator">=</span> rd <span class="token operator">^</span> b <span class="token operator">^</span> d <span class="token operator">^</span> result_d
        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>result_a<span class="token punctuation">,</span> result_b<span class="token punctuation">,</span> result_c<span class="token punctuation">,</span> result_d<span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg2 <span class="token operator">=</span> <span class="token string">b''</span>
    <span class="token keyword">for</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d <span class="token keyword">in</span> result<span class="token punctuation">:</span>
        a <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
        msg2 <span class="token operator">+=</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c <span class="token operator">+</span> d
    <span class="token keyword">return</span> msg2


<span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>cip1<span class="token punctuation">,</span> cip2<span class="token punctuation">,</span> msg2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""To decode cip1"""</span>
    cip1 <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>cip1<span class="token punctuation">)</span>
    cip2 <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>cip2<span class="token punctuation">)</span>
    msg2 <span class="token operator">=</span> pad<span class="token punctuation">(</span>msg2<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    msg1 <span class="token operator">=</span> get_message<span class="token punctuation">(</span>msg2<span class="token punctuation">,</span> get_xor<span class="token punctuation">(</span>cip1<span class="token punctuation">,</span> cip2<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> msg1
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>pass_identity.py</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2


<span class="token keyword">def</span> <span class="token function">packmess</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">65535</span>
    <span class="token keyword">return</span> mess <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>mess<span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


aname <span class="token operator">=</span> <span class="token string">b'Alice'</span>
pinfo <span class="token operator">=</span> packmess<span class="token punctuation">(</span>aname<span class="token punctuation">)</span>
rlen <span class="token operator">=</span> <span class="token number">0</span>
sinfo <span class="token operator">=</span> pinfo <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> rlen <span class="token operator">+</span> <span class="token builtin">int</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>rlen<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>

k <span class="token operator">=</span> <span class="token number">2</span>


<span class="token keyword">def</span> <span class="token function">get_key</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>sinfo<span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token number">65537</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n
    length <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>y<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> y<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>length <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
    x <span class="token operator">=</span> y<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> x


<span class="token keyword">def</span> <span class="token function">get_certificate</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> <span class="token punctuation">(</span>z <span class="token operator">*</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>k<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n
    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="总结吐槽"><a href="#总结吐槽" class="headerlink" title="总结吐槽"></a><del>总结</del>吐槽</h2><p><strong>第一：</strong> GeekGame太硬核了，好像和主办方说的“让没有相关经验的新生和具有一定专业基础的学生都能享受比赛”不太相符，我虽不是信安出身，但也玩了三届Hackergame，三届的校内排名分别是24、15和4，按理也不算纯小白，但GeekGame的很多题给我的感受就是需要拼命猜出题人的意图，猜了半天最后发现方向错了的感觉很糟糕。个人感觉还是Hackergame的题面信息更有方向感，在解题过程中更容易定向地学到相关知识。换句话说，GeekGame的大部分题更适合经验丰富的CTF老手，而不适合纯萌新。</p>
<p>不过，大部分题虽然难，但看题解还是能学到很多东西的，“叶子的新歌”是个例外，这题不仅疯狂套娃，writeup给的解题过程也是没什么逻辑关联性，感觉像是凭空想出来的，我都已经把马里奥游戏跑起来了，仍没有拿到一个flag，看了这题的题解后，我除了惊叹于“这信息居然都有用？”或者“这是人能想到的？也没个提示信息”之外，别无其他想法，而且名为新歌但解题过程与音频没有任何关系，换句话说把歌换成任何其他东西也能出此题，感觉应该是出题者为了让大家欣赏他写的歌特意放进去的，显得有点生硬，我曾一直以为音频里至少会藏有一个flag，研究了很久却毫无结果。另外如rank 1大佬所说的，题目里出现了几个外部链接，这是一种不太合理的设计。（不过这题的主线故事倒是写的挺感人的）</p>
<p><strong>第二：</strong> 主办方在第二阶段给的一些提示感觉不是很合理，有的提示相当于直接把题解按在了脸上，例如“翻车的谜语人”：</p>
<p>第二阶段提示  </p>
<p>Flag 1. You 酱在一边挂着 B 站直播间一边使用 Jupyter Notebook 出题，你只需关心后者  </p>
<p>Flag 2. You 酱前几天在服务器上运行了命令 date，并把输出分享给了你：Sat 06 Nov 2021 11:45:14 PM CST</p>
<p>感觉把第二条提示改成“You酱平时喜欢用Kali Linux系统”更合适一些，认真做过此题的选手应该都能感受到，这提示基本就差直接把flag打在屏幕上了。从给了提示以后解出此题的人数翻了一倍多也可以看出提示的不合理性。</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/a024c2aa-4a5e-40b8-a6b3-c7dd4e6a1c23.png" alt=""></p>
<p>而有的提示感觉就是说了跟没说一样，例如“诡异的网关”：</p>
<p>第二阶段提示  </p>
<p>账号密码保存在哪里？</p>
<p>建议体会一下早在题目刚放出的时候就找到了帐号密码的保存位置但研究了几天没有结果最后拿到这样一条提示的我的心情。</p>
<p>这一题我最初的思路是使用pywin32接口写脚本获取文本框内容，在失败以后经过尝试找到了保存账号密码的文件，然后就一直苦于破解文件的加密（试了一堆古典密码都没成功），拿到这条提示更是让我在第二种思路的错误道路上越走越远。（虽然提示的本意可能是让我们去内存中看，不过感觉还是有一定的误导性）</p>
<p>这题给了提示之后解出人数只增加了8个，相比于一阶段的近50人解出，基本可以认为提示确实一点用都没有（一阶段时解出这题的人数就基本在以每天十个的速度上涨，然而给了提示之后，上涨速度反而还变慢了XD）</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/7ce3cd2d-8c85-4c59-9cea-738d04446a1d.png" alt=""></p>
<p>赛后看了别人的题解，发现这道题用WinSpy可以秒出答案（我一开始试过用pywin32写脚本获取文本框内容，然后失败了，所以思路是对的只是工具没找对咯hhh，另外这和Binary有什么关系？？）</p>
<p>另外还有疯狂套娃题“叶子的新歌”：</p>
<p>第二阶段提示  </p>
<ol>
<li><p>使用某些软件可以查看 MP3 的 metadata  </p>
</li>
<li><p>【FAQ：常用工具】里的虚拟化软件在这道题里真的有用  </p>
</li>
<li><p>解题过程中得到的文本中可能包含提示</p>
</li>
</ol>
<p>这种提示同样对卡在后几层的选手没有任何帮助。</p>
<p>鉴于提示没有办法照顾到所有选手，提示的质量也不易控制，我认为不如直接去掉第二阶段，再把题目出的更明确一些，减少选手们的瞎摸索时间，或许更加合理。</p>
<p><strong>第三：</strong> 感觉作为一场普通的校内线上个人赛，组委会给的奖金确实有点多（至少对于大部分学生党来说，两三千块钱算是一笔不小的收入了），高额的奖金固然有利于激发选手的动力，但线上赛的本质就已经决定了没有办法从根源上杜绝作弊现象，组委会的反作弊手段再高明都不如降低奖金来的靠谱。作为对比，Hackergame中没有设置高额的奖金，只设有鼓励性质的奖品，在这种情况下选手们相对而言会更愿意为了解出flag的成就感、学到更多信息安全的知识而去解题，屯flag的卷王基本很少见（当然这符合规则，只是我认为“卷”未必是一种好的氛围），为了拿低金额的奖品而选择作弊更是没什么意思。（外校人员，奖金什么的与我无关，纯理性吐槽）</p>
<p>不过话说回来，体验不好的原罪还是因为自己菜，我等菜狗还需努力！</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.fyz666.xyz">WindShadow</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.fyz666.xyz/blog/7311/">https://blog.fyz666.xyz/blog/7311/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.fyz666.xyz" target="_blank">逸风亭</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/geekgame/">GeekGame</a><a class="post-meta__tags" href="/tags/geekgame-1st/">GeekGame 1st</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_telegram"></a><a class="a2a_button_qzone"></a><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async src="https://static.addtoany.com/menu/page.js"></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>觉得本文有用？请作者喝奶茶吧～</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/images/wechat.png" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/wechat.png" alt="V me 50!"></a><div class="post-qr-code-desc">V me 50!</div></li><li class="reward-item"><a href="/images/alipay.png" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/alipay.png" alt="Alipay is also ok~"></a><div class="post-qr-code-desc">Alipay is also ok~</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/blog/6797/" title="USTC Hackergame 2021部分题目Write-Up"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/735d7f0e-3060-42de-8196-de620e7b48e9.png" onerror='onerror=null,src="/images/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">USTC Hackergame 2021部分题目Write-Up</div></div></a></div><div class="next-post pull-right"><a href="/blog/7631/" title="Ubuntu系统设置IPv4优先"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/jpg/8cf15d52-96ae-462f-b1ed-81d442ce8c23.jpg" onerror='onerror=null,src="/images/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Ubuntu系统设置IPv4优先</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/blog/8100/" title="PKU GeekGame 2nd 部分题目Write-Up"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/27506054-a13e-4478-804e-c6ad14056070.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-26</div><div class="title">PKU GeekGame 2nd 部分题目Write-Up</div></div></a></div><div><a href="/blog/8499/" title="PKU GeekGame 3rd题解（一）"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/0e15caa6-a325-4e6b-9a1c-cfbf97a52d93.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-21</div><div class="title">PKU GeekGame 3rd题解（一）</div></div></a></div><div><a href="/blog/8565/" title="PKU GeekGame 3rd题解（零）"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/0e15caa6-a325-4e6b-9a1c-cfbf97a52d93.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-21</div><div class="title">PKU GeekGame 3rd题解（零）</div></div></a></div><div><a href="/blog/8527/" title="PKU GeekGame 3rd题解（二）"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/0e15caa6-a325-4e6b-9a1c-cfbf97a52d93.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-21</div><div class="title">PKU GeekGame 3rd题解（二）</div></div></a></div><div><a href="/blog/11906/" title="GeekGame 2024 题解 (一)"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/48f1d9cd-cd8c-4abd-ba92-7390d9ec1b32.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-19</div><div class="title">GeekGame 2024 题解 (一)</div></div></a></div><div><a href="/blog/12067/" title="GeekGame 2024 题解 (三)"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/48f1d9cd-cd8c-4abd-ba92-7390d9ec1b32.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-19</div><div class="title">GeekGame 2024 题解 (三)</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div class="comment-switch"><span class="first-comment">Twikoo</span><span id="switch-btn"></span><span class="second-comment">Giscus</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/avatar.png" onerror='this.onerror=null,this.src="/images/default-link.png"' alt="avatar"></div><div class="author-info__name">WindShadow</div><div class="author-info__description">行所欲行，无问西东。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">159</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">95</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/windshadow233"><i class="fab fa-github"></i><span>Catch me!</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:me@mail.fyz666.xyz" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="tencent://message/?uin=1010954322&amp;Site=fdfdf&amp;Menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://t.me/windshadow233" target="_blank" title="Telegram"><i class="fab fa-telegram"></i></a><a class="social-icon" href="https://www.instagram.com/ericcc_fan/" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a><a class="social-icon" href="https://www.facebook.com/yizhan.fan.35" target="_blank" title="Facebook"><i class="fab fa-facebook-square"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><div class="welcome">欢迎来自<span id="city">火星</span>的小伙伴～（位置信息可能存在延迟）<br>您当前的IP地址为: <span id="local-ip">0.0.0.0</span><br>
  您现在距离我大约<span id="distance">1919810</span>公里
</div>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%86%92%E7%AD%BE%E5%88%B0%E2%86%90"><span class="toc-number">1.</span> <span class="toc-text">→签到←</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E5%8C%97%E9%97%AE%E7%AD%94Remake"><span class="toc-number">2.</span> <span class="toc-text">小北问答Remake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BF%BB%E8%BD%A6%E7%9A%84%E8%B0%9C%E8%AF%AD%E4%BA%BA"><span class="toc-number">3.</span> <span class="toc-text">翻车的谜语人</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag1"><span class="toc-number">3.1.</span> <span class="toc-text">Flag1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag2"><span class="toc-number">3.2.</span> <span class="toc-text">Flag2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E7%BA%BF%E8%A7%A3%E5%8E%8B%E7%BD%91%E7%AB%99"><span class="toc-number">4.</span> <span class="toc-text">在线解压网站</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AE%9E%E8%B7%B5"><span class="toc-number">5.</span> <span class="toc-text">密码学实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag1-1"><span class="toc-number">5.1.</span> <span class="toc-text">Flag1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag2-1"><span class="toc-number">5.2.</span> <span class="toc-text">Flag2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%92%E5%85%85Alice"><span class="toc-number">5.2.1.</span> <span class="toc-text">冒充Alice</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86flag2"><span class="toc-number">5.2.2.</span> <span class="toc-text">解密flag2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%E5%90%90%E6%A7%BD"><span class="toc-number">6.</span> <span class="toc-text">总结吐槽</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/blog/12395/" title="Python随机数的背后：MT19937算法之——实战演练"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/4de41354-86bb-42e2-8812-9d13cd1c164b.webp" onerror='this.onerror=null,this.src="/images/404.jpg"' alt="Python随机数的背后：MT19937算法之——实战演练"></a><div class="content"><a class="title" href="/blog/12395/" title="Python随机数的背后：MT19937算法之——实战演练">Python随机数的背后：MT19937算法之——实战演练</a><time datetime="2024-11-29T11:42:29.000Z" title="发表于 2024-11-29 19:42:29">2024-11-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/12343/" title="Python随机数的背后：MT19937算法之——小试牛刀"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/4de41354-86bb-42e2-8812-9d13cd1c164b.webp" onerror='this.onerror=null,this.src="/images/404.jpg"' alt="Python随机数的背后：MT19937算法之——小试牛刀"></a><div class="content"><a class="title" href="/blog/12343/" title="Python随机数的背后：MT19937算法之——小试牛刀">Python随机数的背后：MT19937算法之——小试牛刀</a><time datetime="2024-11-20T21:27:45.000Z" title="发表于 2024-11-21 05:27:45">2024-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/12317/" title="Python随机数的背后：MT19937算法之——状态恢复"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/4de41354-86bb-42e2-8812-9d13cd1c164b.webp" onerror='this.onerror=null,this.src="/images/404.jpg"' alt="Python随机数的背后：MT19937算法之——状态恢复"></a><div class="content"><a class="title" href="/blog/12317/" title="Python随机数的背后：MT19937算法之——状态恢复">Python随机数的背后：MT19937算法之——状态恢复</a><time datetime="2024-11-20T20:41:57.000Z" title="发表于 2024-11-21 04:41:57">2024-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/12283/" title="Python随机数的背后：MT19937算法之——算法逆向"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/4de41354-86bb-42e2-8812-9d13cd1c164b.webp" onerror='this.onerror=null,this.src="/images/404.jpg"' alt="Python随机数的背后：MT19937算法之——算法逆向"></a><div class="content"><a class="title" href="/blog/12283/" title="Python随机数的背后：MT19937算法之——算法逆向">Python随机数的背后：MT19937算法之——算法逆向</a><time datetime="2024-11-20T16:23:13.000Z" title="发表于 2024-11-21 00:23:13">2024-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/12239/" title="Python随机数的背后：MT19937算法之——算法分析"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/4de41354-86bb-42e2-8812-9d13cd1c164b.webp" onerror='this.onerror=null,this.src="/images/404.jpg"' alt="Python随机数的背后：MT19937算法之——算法分析"></a><div class="content"><a class="title" href="/blog/12239/" title="Python随机数的背后：MT19937算法之——算法分析">Python随机数的背后：MT19937算法之——算法分析</a><time datetime="2024-11-20T11:16:24.000Z" title="发表于 2024-11-20 19:16:24">2024-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/12196/" title="Hackergame 2024 题解（三）"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/0e71694e-9772-4998-aecb-3bb41267a079.webp" onerror='this.onerror=null,this.src="/images/404.jpg"' alt="Hackergame 2024 题解（三）"></a><div class="content"><a class="title" href="/blog/12196/" title="Hackergame 2024 题解（三）">Hackergame 2024 题解（三）</a><time datetime="2024-11-09T05:10:29.000Z" title="发表于 2024-11-09 13:10:29">2024-11-09</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright"><span style="font-family:sans-serif">&copy;</span>2020 - 2025 By WindShadow</div><div class="framework-info"><a target="_blank" rel="noopener" href="https://hexo.io/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-informational"></a><span class="footer-separator"> </span><a target="_blank" rel="noopener" href="https://butterfly.js.org/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-informational"></a><span class="footer-separator"> </span><a target="_blank" rel="noopener" href="https://github.com/lxgw/LxgwMarkerGothic"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Font-%E9%9C%9E%E9%B9%9C%E6%BC%AB%E9%BB%91-informational"></a></div><div class="footer_custom_text"><div> <a target="_blank" rel="noopener" href="https://github.com/windshadow233.github.io"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-GitHub-8A2BE2"></a> <span class="footer-separator"></span> <a href="/sitemap.xml" target="_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Sitemap-XML-8A2BE2"></a> <span class="footer-separator"></span> <a href="/atom.xml" target="_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Feed-Atom-8A2BE2"></a> <br> <a target="_blank" rel="noopener" href="https://www.nginx.com/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Nginx-red"></a> <span class="footer-separator"></span> <a target="_blank" rel="noopener" href="https://www.cloudflare.com/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Proxy-Cloudflare-red"></a> <span class="footer-separator"></span> <a target="_blank" rel="noopener" href="https://oss-console.fyz666.xyz/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/OSS-Self--Hosted-red"></a> <br> <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CC-BY--NC--SA%204.0-ff69b4"></a> <span class="footer-separator"></span> <a target="_blank" rel="noopener" href="https://icp.gov.moe/?keyword=20249801"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E8%90%8CICP%E5%A4%87-20249801-ff69b4?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAAByxJREFUSInl1nlwVeUZx/HPuTckkD0kQFiCEEIUlNUCAqKoSBV1AIt1ikpVLFbLONjWGUXbmWrbweJMy7hUxbbTjsUq6KCiWEvr0kE2WVK2QCKBJCxJgEASsienfxwqMob+3Zm+f93z3vM+32f5vc9z+H9bwVcfOp/YQ+1prhhEZS1VDQzqQ1MjiQmIC5Liwm3lBWpqFimrulb/7A/067vM2IsOBZ2h8MhJQW6KMDNVsKeaizKEyUlsKueqgWJ39AMJF3QpDCNYr1SaEig/lWNX2Z1h6dH5/lVyGdVIZFf7MHo9bEfh9rCg/+8NyHlN77QTsnpQ0i2y08VK+BosfhbW0cHxqmSfFd9qW+l9Pi+5WltFdGTsOBbO5dJcdh3lN5+xff0Y2zuelXjRsyYUrjOu4BVJaavlpbWIJRBLOM+J81O95AAnTtM9vNHGknut3zdT48FutJE3koWTuG4oSXH+VsInX3B9IdcVUNfCuv08t4GjO6NspOa3BNcOXx1eOugVHQnrTMkTuyWrC/BjRZO9uPYTpw7HhTWkXcLd45l9GblpHD7NWzt5ZTMXZ/OdkTy+lvR07rmcmWffq6pn9W5e/oymfcT6kJbXHiydMyVYkL/x66n+ZMcctQfjhgxl6UIGZ3Ooltd2RIZqjqKRS0ew9cFIA1cO5urlLHuPZWsZPJiZw7gqn0VT2HCIR9+jvCQhfHPrLGyE2Hng2roBxHnmJoZnc9drbD3I6QaaWkjpSVoeu4+x5XB05qMDqCenHz37UHmcFRv54ZuMeoYrB/L0DPRgZ0WfrsXVKzPX3nYykrn3dUZl8+Q0Qox/gc/L6ZlKzxQefo+UROpa6Z4VCedkPd8YyJYHI3u5T/HAShZNQxsXZfR3pCtwRW066VEeOuIUVUf77+9jTw2pycTOJml7Je1t9EgiI5X2jkgyze1fCSSdtjhBiJCkpKyuI+5oTdAtkTCgVwrbKsl8ko6QjO40tZ67EpkpdIbRf20dkbPpPTjdwsSX6I5dJYy4hoQAaZQdDy4A1iEMI613T6LtBPXJpPakrjGqc1Y6CTFq62htJp5KRwPJKWSkU3WKiiPEEqO6xgM6oZmctJhDXYH7Z59xuCyKpK6R26ZE+ys3MWYoN1/Mc5uoqmbEQJ6fTc/ulJ3i/lUc+YIfzeKhKzjVHN31A3XRHddKSrf6/6DOV3VTcw1hVKfkxOhaPDAe1UwfwmNTqT1Drxw+nE9xNXetIjHG2vnoxoT+rNrN2Of58Rp6JZ+ldKes5kjX4G7dKuikpoERfaltYnQ/DOSS3hEAFk9lXQkLnmf7Ib65lPJT3HU1+46Tm8rYvgzKYVA2h+vQIMjvewHwdSN20MiOSmZczO4a1hSzYi77T7CiiPF5JMTZexjJ5OagkwNV9M+MnJ09nKU3smgyQ3PYWoEO4fUjii4QceJmevJuMeP6csUAln4atcbSGoqOUpjD30uZNwnpHNtN3lC+NZa1xeT34pGVTJ3PL9+Ohs6GQ8gVtHZs6VLVwZhBReGwoXvt3THM/hP0SWVnCR8f4PMjkffjB/DQS8waxpHFfFgaaeHZDRRtJn0yP5tF31ymFVJ2nN27GD66KBzca2/XEWdkUpD3Fmd4tYj0FMS54Q9UnuaDUv6yE/24ewWP/DU6N/d1fvousYEs28DyLVEvGDOAt/egmSkXv2VYn3NBfpXbua6J8hMFFvy2RHsL+57gmX+w/AN651PfEDWQzLRI+afqIqOxFDJT6Rbn9Bmad3PnTH5wIxOXkJTWGiz57hCDsyqDWVldRNzeyOh+paaPfpFKnvqQX88iZwDVx0lLJqUHbe3EkZ1Odm+yUqK2GHYKmhvIG8fyeTz9IY5x67jnFPapdPDkl6jzwEF9IDjZJlgwfbG+o2u8+g4rd7D/UYI41TXnevV5K4j2q6uESckUP8rvNrH6fUH/sRXB9AlPONMSDZ8uazwoi56JjEyvdftV88jinhf4uIzmJRQOoOYgja0RKAiIBZxpjvZH5tP0c97axcLlyBXOuWZemJTYFFbUCU+1dl3j8PGSyFhnJ7EkYcWh7/njqpep5xfzWTyZZ7dEg73xOJKiGqf3YenNLBjLTz7i539COg/OvSOYO2GFo/VRG0Zwe0YX4Ns3R7NXSCxBeM8IthXfZvGf3xCWc/kkXvg2vVP4YB/rDzC1gGlDo+50/xvs2khKPrNnzAzmTH5HbzR0fkkKro93Ab5vx9kfaGgT3lLA5EyWbRpoTdHbSreOppGJV/PwlRTksK+aZz5l6z+RLBgxaau5k2cJelTKzmRQMq0d51J8UxL+23d1TDTcj7WQllZu4YwxDo+eZc22X9mwd6gN65GIFmQzampxcMOoR1xeuMbpVoqromsXdG3+wmCiekNtfSSmiUNWu2zgap+WjlZW8X11TeNkpWwICvNfCm8u3Cmxg4PN0VdmEJw7/7+0/g32RaqCbhRecAAAAABJRU5ErkJggg=="></a> <span class="footer-separator"></span> <a target="_blank" rel="noopener" href="https://letsencrypt.org/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/SSL-Let's_Encrypt-ff69b4"></a> </div></div><div id="runtime-footer"><i id="heartbeat"></i>本站已持续运行<span></span></div><script>$(document).ready((function(){var n=new Date("2020-06-29T00:00:00.000Z"),e=document.querySelector("#runtime-footer span");function a(n){return n.toString().padStart(2,"0")}setInterval((function(){var r=new Date-n,t=Math.floor(r/864e5),s=Math.floor(r%864e5/36e5),o=Math.floor(r%36e5/6e4),c=Math.floor(r%6e4/1e3);e.innerHTML="<span class='numeric'>"+t+"</span>天<span class='numeric'>"+a(s)+"</span>小时<span class='numeric'>"+a(o)+"</span>分<span class='numeric'>"+a(c)+"</span>秒"}),1e3)}))</script></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href=""><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>复制</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.google.com/search?q=&quot;+window.getSelection().toString());"><i class="fab fa-google"></i><span>Google 一下</span></a><a class="rightMenu-item" href="javascript:rmf.searchinThisPage();"><i class="fas fa-search"></i><span>站内搜索</span></a></div><div class="rightMenu-group rightMenu-line hide menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" href="javascript:window.location=window.getSelection().toString();"><i class="fa fa-link"></i><span>前往此链接</span></a></div><div class="rightMenu-group rightMenu-line hide menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste();"><i class="fa fa-copy"></i><span>粘贴</span></a></div><div class="rightMenu-group rightMenu-line menu-post"><a class="rightMenu-item hide menu-comment" href="#post-comment"><i class="fas fa-comment"></i><span>直达评论区</span></a><a class="rightMenu-item hide menu-comment" id="switch_commentBarrage" href="javascript:switchCommentBarrage();" title="开关评论弹幕"><i class="iconfont icon-danmu"></i><span>开关评论弹幕</span></a><a class="rightMenu-item" href="javascript:rmf.copyPageLink()"><i class="fa fa-link"></i><span>复制本页链接</span></a></div><div class="rightMenu-group rightMenu-line hide menu-to"><a class="rightMenu-item" href="javascript:rmf.openInNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>前往此链接</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制链接</span></a></div><div class="rightMenu-group rightMenu-line hide menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>保存图片</span></a><a class="rightMenu-item" href="javascript:rmf.openImageInNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开图片</span></a><a class="rightMenu-item" href="javascript:rmf.copyImageLink()"><i class="fa fa-copy"></i><span>复制图片链接</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:toRandomPost()"><i class="fa fa-paper-plane"></i><span>随便逛逛</span></a><a class="rightMenu-item" href="javascript:rmf.switchDarkMode();"><i class="fa fa-moon"></i><span>切换显示模式</span></a><a class="rightMenu-item" href="javascript:rmf.translate();"><i class="iconfont icon-fanti"></i><span>繁简转换</span></a><a class="rightMenu-item hide menu-read" href="javascript:rmf.switchReadMode();"><i class="fa fa-book"></i><span>阅读模式</span></a><a class="rightMenu-item" href="javascript:fullScreen();"><i class="fas fa-expand"></i><span>切换全屏模式</span></a></div></div><div><script src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/utils.js?v=4.14.0-b1"></script><script src="/js/main.f283933f.js?v=4.14.0-b1"></script><script src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/tw_cn.js?v=4.14.0-b1"></script><script src="https://fastly.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.umd.min.js"></script><script src="https://fastly.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://fastly.jsdelivr.net/npm/vanilla-lazyload@19.0.5/dist/lazyload.iife.min.js"></script><script src="https://fastly.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>(()=>{const t=["post","post-info","recent-posts","archive","article-container","top","about-page"],e=()=>{"object"==typeof pangu?t.forEach((t=>{pangu.spacingElementById(t)})):btf.getScript("https://fastly.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js").then((()=>{t.forEach((t=>{pangu.spacingElementById(t)}))}))},n=()=>{e()};btf.addGlobalFn("pjaxComplete",n,"pangu"),document.addEventListener("DOMContentLoaded",n)})()</script><div class="js-pjax"><script>(()=>{const t=()=>{if(window.MathJax)MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typesetPromise();else{window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],tags:"ams"},chtml:{scale:1.1},options:{enableMenu:!1,renderActions:{findScript:[10,t=>{for(const e of document.querySelectorAll('script[type^="math/tex"]')){const a=!!e.type.match(/; *mode=display/),n=new t.options.MathItem(e.textContent,t.inputJax[0],a),d=document.createTextNode("");e.parentNode.replaceChild(d,e),n.start={node:d,delim:"",n:0},n.end={node:d,delim:"",n:0},t.math.push(n)}},""]}}};const t=document.createElement("script");t.src="https://fastly.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js",t.id="MathJax-script",t.async=!0,document.head.appendChild(t)}};btf.addGlobalFn("encrypt",t,"mathjax"),window.pjax?t():window.addEventListener("load",t)})()</script><div class="comment-barrage"></div><script>$(document).ready((function(){window.commentBarrageConfig={lightColors:[["var(--fyz-white-acrylic2)","var(--fyz-black)"]],darkColors:[["var(--fyz-black-acrylic2)","var(--fyz-white)"]],maxBarrage:3,barrageTime:3e3,twikooUrl:"https://twikoo.fyz666.xyz/",accessToken:"baafee2c7bf49d5967e7a05066e284ca",pageUrl:window.location.pathname,barrageTimer:[],barrageList:[],barrageIndex:0,noAvatarType:"retro",dom:document.querySelector(".comment-barrage"),displayBarrage:!0,avatarCDN:"cravatar.cn"},document.onscroll=function(){let e=document.getElementById("post-comment");null!==e&&commentBarrageConfig.displayBarrage&&(isInViewPortOfOne(e)?document.getElementsByClassName("comment-barrage")[0].setAttribute("style","display:none;"):document.getElementsByClassName("comment-barrage")[0].setAttribute("style",""))},initCommentBarrage()}))</script><script>(()=>{const t=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo.fyz666.xyz/",region:"",onCommentLoaded:()=>{btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const t=document.getElementById("twikoo-count");t&&twikoo.getCommentsCount({envId:"https://twikoo.fyz666.xyz/",region:"",urls:[window.location.pathname],includeReply:!1}).then((o=>{t.textContent=o[0].count})).catch((t=>{console.error(t)}))})()},o=()=>{"object"==typeof twikoo?setTimeout(t,0):btf.getScript("https://fastly.jsdelivr.net/npm/twikoo@1.6.32/dist/twikoo.all.min.js").then(t)};o()})()</script><script>(()=>{const t=t=>"dark"===t?"dark_high_contrast":"light_high_contrast",a=()=>{const a=Object.assign({src:"https://giscus.app/client.js","data-repo":"windshadow233/BlogStorage","data-repo-id":"R_kgDOLhHf0w","data-category-id":"DIC_kwDOLhHf084Ce0EO","data-mapping":"pathname","data-theme":t(document.documentElement.getAttribute("data-theme")),"data-reactions-enabled":"1",crossorigin:"anonymous",async:!0},{"data-mapping":"og:title","data-input-position":"top","data-loading":"lazy","data-reactions-enabled":0,"data-lang":"zh-CN"}),e=document.createElement("script");for(let t in a)e.setAttribute(t,a[t]);document.getElementById("giscus-wrap").appendChild(e)};btf.addGlobalFn("themeChange",(a=>{(t=>{const a=document.querySelector("iframe.giscus-frame");a&&a.contentWindow.postMessage({giscus:t},"https://giscus.app")})({setConfig:{theme:t(a)}})}),"giscus"),a()})()</script></div><canvas id="universe-background"></canvas><div class="aplayer no-destroy" data-id="5103395209" data-fixed="true" data-autoplay="false" data-server="netease" data-order="random" data-listfolded="true" data-loop="all" data-volume="0.4" data-type="playlist"> </div><script async defer src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/universe.js"></script><script>function loadExternalResource(e,t){return new Promise(((s,i)=>{let n;"css"===t?(n=document.createElement("link"),n.rel="stylesheet",n.href=e):"js"===t&&(n=document.createElement("script"),n.src=e),n&&(n.onload=()=>s(e),n.onerror=()=>i(e),document.head.appendChild(n))}))}if(screen.width>=768){const e="/plugins/live2d/";Promise.all([loadExternalResource(e+"waifu.css","css"),loadExternalResource(e+"live2d.min.js","js"),loadExternalResource(e+"waifu-tips.js","js")]).then((()=>{initWidget({waifuPath:e+"waifu-tips.json",cdnPath:"https://fastly.jsdelivr.net/gh/fghrsh/live2d_api/",tools:["hitokoto","quit"]})}))}</script><link rel="stylesheet" href="/css/custom.5b0bedda.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/comment-barrage@v0.0.1.min.css"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script data-pjax>void 0!==window.LA&&LA.init({id:"JNnEmA8RDMZCf0Vf",ck:"JNnEmA8RDMZCf0Vf"})</script><script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script><script data-pjax>void 0!==window.LingQue&&(new LingQue.Monitor).init({id:"KQWCzIs71YhLYfcB",sendSuspicious:!0,sendSpaPv:!0})</script><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://fastly.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://fastly.jsdelivr.net/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://fastly.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors=['link[rel="canonical"]','meta[property="og:description"]','meta[name="description"]','meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]',"head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!0,scrollRestoration:!1});const triggerPjaxFn=e=>{e&&Object.values(e).forEach((e=>{e()}))};document.addEventListener("pjax:send",(function(){btf.removeGlobalFnEvent("pjax"),btf.removeGlobalFnEvent("themeChange");const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),triggerPjaxFn(window.globalFn.pjaxSend)})),document.addEventListener("pjax:complete",(()=>{document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),a=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(a)),e.parentNode.replaceChild(t,e)})),triggerPjaxFn(window.globalFn.pjaxComplete)})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404")}))</script><script async data-pjax src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/vercount@v0.0.2.js"></script><div class="docsearch-wrap"><div id="docsearch" style="display:none"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/docsearch.css"><script src="https://fastly.jsdelivr.net/npm/@docsearch/js@3.6.0/dist/umd/index.min.js"></script><script>(()=>{docsearch(Object.assign({appId:"U4K4JGBNYW",apiKey:"968e6158989f9e37080dc540e037e695",indexName:"fyz666",container:"#docsearch",transformItems:e=>e.map((e=>{const c=new URL(e.url);return{...e,url:c.pathname+c.search+c.hash}}))},{maxResultsPerGroup:20}));const e=()=>{document.querySelector(".DocSearch-Button").click()},c=()=>{btf.addEventListenerPjax(document.querySelector("#search-button > .search"),"click",e)};c(),window.addEventListener("pjax:complete",c)})()</script></div></div><script data-pjax>function history_calendar_injector_config(){var e=document.getElementsByClassName("sticky_layout")[0];document.querySelectorAll(".card-history").forEach((e=>{document.querySelector("#aside-content").removeChild(e)})),e.insertAdjacentHTML("beforebegin",'<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>那年今日</span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>')}document.getElementsByClassName("sticky_layout")[0]&&(location.pathname,1)&&history_calendar_injector_config()</script><script data-pjax src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/baiduhistorycalendar@v1.0.1.js"></script><script data-pjax>function butterfly_swiper_injector_config(){if(document.getElementById("swiper-container")){document.getElementById("swiper-container").insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/0e71694e-9772-4998-aecb-3bb41267a079.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2024-11-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/12095/&quot;);" href="javascript:void(0);" alt="">Hackergame 2024 题解（零）</a><div class="blog-slider__text">Hackergame 2024，再次喜提二等奖～</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/48f1d9cd-cd8c-4abd-ba92-7390d9ec1b32.png);"><div class="blog-slider__content"><span class="blog-slider__code">2024-10-18</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/11830/&quot;);" href="javascript:void(0);" alt="">GeekGame 2024 题解 (零)</a><div class="blog-slider__text">今年的GeekGame参赛人数好多，勉强拿个前百，来年再接再厉！</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/c95fcde3-2ca6-4ded-8019-604d0868453b.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2024-05-17</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/11574/&quot;);" href="javascript:void(0);" alt="">使用MinIO自部署对象存储服务</a><div class="blog-slider__text">考虑再三，还是选择自部署对象存储服务</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/998fed9b-e31d-43c4-87aa-5efa0d19bc14.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2024-04-11</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/11025/&quot;);" href="javascript:void(0);" alt="">迁移WordPress到静态博客</a><div class="blog-slider__text">时隔四年，我终于把博客从WordPress迁移到了Hexo</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/69767e44-ab15-4b61-a5f5-a6567361e09b.png);"><div class="blog-slider__content"><span class="blog-slider__code">2024-03-20</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/9930/&quot;);" href="javascript:void(0);" alt="">自建docker-mailserver邮件服务器</a><div class="blog-slider__text">用docker部署了个邮件服务器～</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/84f9ac75-6609-487a-9190-8b45a38064df.png);"><div class="blog-slider__content"><span class="blog-slider__code">2024-02-02</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/9235/&quot;);" href="javascript:void(0);" alt="">重塑密码管理体系——Bitwarden服务端自部署</a><div class="blog-slider__text">自部署一个密码管理平台</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://api.star-history.com/svg?repos=windshadow233/This-Repo-Has-0-Stars&amp;type=Date);"><div class="blog-slider__content"><span class="blog-slider__code">2024-02-23</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/9506/&quot;);" href="javascript:void(0);" alt="">一个随Star数动态变化的GitHub仓库</a><div class="blog-slider__text">一个有意思的GitHub仓库</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/52de5404-cde7-4dec-867d-97457ccec409.png);"><div class="blog-slider__content"><span class="blog-slider__code">2024-01-20</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/9097/&quot;);" href="javascript:void(0);" alt="">“The Password Game”攻略</a><div class="blog-slider__text">一个有意思的小游戏</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/jpg/6f00f091-9b5b-42c9-aebd-6635e13518a3.jpg);"><div class="blog-slider__content"><span class="blog-slider__code">2023-11-03</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/8773/&quot;);" href="javascript:void(0);" alt="">Hackergame 2023题解（零）</a><div class="blog-slider__text">喜提校内rank 2，感谢大佬们的不卷之恩！</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/d5b9bb46-0e19-4831-933f-d99bd2380e5d.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2023-09-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/8394/&quot;);" href="javascript:void(0);" alt="">从零开始的麻将AI论文复现（零）</a><div class="blog-slider__text">写了个麻将AI，不过暂时只实现了监督学习</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/5b4b7b2d-1c96-468f-876e-d5d1b5e24cef.png);"><div class="blog-slider__content"><span class="blog-slider__code">2022-05-13</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/7728/&quot;);" href="javascript:void(0);" alt="">自建一个ZeroTier行星/卫星服务器</a><div class="blog-slider__text">P2P异地组网神器——ZeroTier的自部署方法</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/jpeg/f17a1481-2a0e-404d-b6bb-5fa9a6006fb5.jpeg);"><div class="blog-slider__content"><span class="blog-slider__code">2021-08-06</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/6263/&quot;);" href="javascript:void(0);" alt="">手撸神经网络系列之——训练模型（完结篇）</a><div class="blog-slider__text">用Numpy撸了个神经网络</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/ea524747-7787-48e0-8d51-c8d7ee7f9226.png);"><div class="blog-slider__content"><span class="blog-slider__code">2021-08-11</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/6304/&quot;);" href="javascript:void(0);" alt="">如何在校外使用北邮人PT站</a><div class="blog-slider__text">完美解决离校后无法使用北邮人PT站的问题</div></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}}for(var elist="undefined".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/swiper.min.js"></script><script defer data-pjax src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/swiper_init.js"></script></body></html>