<!DOCTYPE html><html lang="[&quot;en-US&quot;,&quot;zh-CN&quot;,&quot;default&quot;]" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>PKU GeekGame 2nd 部分题目Write-Up | 逸风亭</title><meta name="author" content="WindShadow"><meta name="copyright" content="WindShadow"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="GeekGame 2nd结束了，今年的题没有了去年那种套娃，难度有所下降，总体感觉不错，也取得了比去年更高的总排名（29），对一名非专业菜鸟玩家而言，我已经相当满意。 更重要的是，我在解题过程中学到了不少东西，也获得了不少乐趣，而不是像去年那样晕头转向没有方向感。      引用站外地址，不保证站点的可用性和安全性">
<meta property="og:type" content="article">
<meta property="og:title" content="PKU GeekGame 2nd 部分题目Write-Up">
<meta property="og:url" content="https://blog.fyz666.xyz/blog/8100/">
<meta property="og:site_name" content="逸风亭">
<meta property="og:description" content="GeekGame 2nd结束了，今年的题没有了去年那种套娃，难度有所下降，总体感觉不错，也取得了比去年更高的总排名（29），对一名非专业菜鸟玩家而言，我已经相当满意。 更重要的是，我在解题过程中学到了不少东西，也获得了不少乐趣，而不是像去年那样晕头转向没有方向感。      引用站外地址，不保证站点的可用性和安全性">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blogfiles.oss.fyz666.xyz/png/27506054-a13e-4478-804e-c6ad14056070.png">
<meta property="article:published_time" content="2022-11-25T20:06:08.000Z">
<meta property="article:modified_time" content="2025-06-13T07:54:15.770Z">
<meta property="article:author" content="WindShadow">
<meta property="article:tag" content="GeekGame">
<meta property="article:tag" content="GeekGame 2nd">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blogfiles.oss.fyz666.xyz/png/27506054-a13e-4478-804e-c6ad14056070.png"><link rel="shortcut icon" href="/images/avatar.webp"><link rel="canonical" href="https://blog.fyz666.xyz/blog/8100/"><link rel="preconnect" href="//fastly.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/vercount@v0.1.0.js"><meta name="google-site-verification" content="qs4w3HQcWsP2MnxYN-ccrDZXv8lbkIZ7FRTams_no7w"><meta name="baidu-site-verification" content="7a52f3352214d3debf7bdc94e16e4d98"><meta name="msvalidate.01" content="A886BA7ACEE7B91223E9CAC00117689A"><link rel="stylesheet" href="/css/index.72544d77.css?v=4.14.0-b1"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>(()=>{const e={set:(e,t,o)=>{if(0===o)return;const n={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(n))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}};window.btf={saveToLocal:e,getScript:(e,t={})=>new Promise(((o,n)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onerror=n,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,o())},Object.keys(t).forEach((e=>{a.setAttribute(e,t[e])})),document.head.appendChild(a)})),getCSS:(e,t=!1)=>new Promise(((o,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,t&&(a.id=t),a.onerror=n,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,o())},document.head.appendChild(a)})),addGlobalFn:(e,t,o=!1,n=window)=>{const a=n.globalFn||{},c=a[e]||{};o&&c[o]||(c[o=o||Object.keys(c).length]=t,a[e]=c,n.globalFn=a)}};const t=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},o=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","ffffff")};btf.activateDarkMode=t,btf.activateLightMode=o;const n=e.get("theme");"dark"===n?t():"light"===n&&o();const a=e.get("aside-status");void 0!==a&&("hide"===a?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?9a270e5172c0e106854227db797302be";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),btf.addGlobalFn("pjaxComplete",(()=>{_hmt.push(["_trackPageview",window.location.pathname])}),"baidu_analytics")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-WYGVS01F3R"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-WYGVS01F3R"),btf.addGlobalFn("pjaxComplete",(()=>{gtag("config","G-WYGVS01F3R",{page_path:window.location.pathname})}),"google_analytics")</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:void 0,highlight:{plugin:"prismjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:300},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体中文",cht_to_chs:"你已切换为简体中文",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"top-right"},infinitegrid:{js:"https://fastly.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1,shortcut:{enable:!0,keyboard_delay:500,keyboard_css:"https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/keyboard.min.css",items:[{keycode:83,text:"S",action:"站内搜索",script:'$(".search").click()'},{keycode:32,text:"Space",action:"刷新页面",script:"pjax.loadUrl('')"},{keycode:82,text:"R",action:"随机文章",script:"toRandomPost()"},{keycode:38,text:"↑",action:"回到顶部",script:"btf.scrollToDest()"},{keycode:40,text:"↓",action:"前往评论区",script:"location.href='#post-comment'"},{keycode:37,text:"←",action:"回退页面",script:"history.back()"},{keycode:39,text:"→",action:"前进页面",script:"history.forward()"},{keycode:72,text:"H",action:"返回首页",script:"pjax.loadUrl('/')"},{keycode:65,text:"A",action:"关于博主",script:"pjax.loadUrl('/about/')"},{keycode:76,text:"L",action:"友情链接",script:"pjax.loadUrl('/link/')"},{keycode:68,text:"D",action:"浅色/深色切换",script:'$("#darkmode").click()'},{keycode:84,text:"T",action:"简体/繁体切换",script:'$("#translateLink").click()'},{keycode:67,text:"C",action:"显示/隐藏评论弹幕",script:"switchCommentBarrage()"},{keycode:77,text:"M",action:"播放/暂停音乐",script:"aplayers[0].toggle()"}]}}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"PKU GeekGame 2nd 部分题目Write-Up",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2025-06-13 15:54:15"}</script><style id="barragesColor"></style><script type="text/javascript" src="https://fastly.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script><script src="https://fastly.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js"></script><script src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/rightmenu@v0.1.0.js" async></script><link rel="stylesheet" href="/css/iconfont.47c93876.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/rightmenu@v0.0.2.css"><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><script src="/js/charts.ab7fe145.js"></script><script src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/githubcalendar@v0.0.2.js"></script><script type="text/javascript" src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/comment-barrage.js"></script><script type="text/javascript" src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/waterfall.js"></script><script type="text/javascript" src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/mytalk@v0.0.3.js"></script><script type="text/javascript" src="/js/random.31028534.js"></script><script type="text/javascript" src="/js/custom.3c08df65.js"></script><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/mytalk@v1.1.5.css"><div id="keyboard-tips" style="display:none"><div class="keyboardTitle">快捷键</div><div class="keybordList"><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + S</div></div><div class="keyContent"><div class="content">站内搜索</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + Space</div></div><div class="keyContent"><div class="content">刷新页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + R</div></div><div class="keyContent"><div class="content">随机文章</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + ↑</div></div><div class="keyContent"><div class="content">回到顶部</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + ↓</div></div><div class="keyContent"><div class="content">前往评论区</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + ←</div></div><div class="keyContent"><div class="content">回退页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + →</div></div><div class="keyContent"><div class="content">前进页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + H</div></div><div class="keyContent"><div class="content">返回首页</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + A</div></div><div class="keyContent"><div class="content">关于博主</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + L</div></div><div class="keyContent"><div class="content">友情链接</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + D</div></div><div class="keyContent"><div class="content">浅色/深色切换</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + T</div></div><div class="keyContent"><div class="content">简体/繁体切换</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + C</div></div><div class="keyContent"><div class="content">显示/隐藏评论弹幕</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">Shift + M</div></div><div class="keyContent"><div class="content">播放/暂停音乐</div></div></div></div></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/keyboard.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/swiper-style.css" media="print" onload='this.media="all"'><meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="逸风亭" type="application/atom+xml">
<link rel="alternate" href="/feed.xml" title="逸风亭" type="application/rss+xml">
</head><body><div id="loading-box"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script async>(()=>{const e=document.getElementById("loading-box"),d=document.body,o=()=>{d.style.overflow="",e.classList.add("loaded")},l=()=>{d.style.overflow="hidden",e.classList.remove("loaded")};l(),window.addEventListener("load",(()=>{o()})),setTimeout((function(){o()}),5e3),btf.addGlobalFn("pjaxSend",(()=>{l()}),"preloader_init"),btf.addGlobalFn("pjaxComplete",(()=>{o()}),"preloader_end")})()</script><script>window.paceOptions={restartOnPushState:!1},btf.addGlobalFn("pjaxSend",(()=>{Pace.restart()}),"pace_restart")</script><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/pace_progress_bar.css"><script src="https://fastly.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/avatar.webp" onerror='onerror=null,src="/images/default-link.png"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">162</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">99</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-blog"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="javascript:toRandomPost();"><i class="fa-fw fa fa-paper-plane"></i><span> 随便逛逛</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-sitemap"></i><span> 本站</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw far fa-images"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐馆</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-info-circle"></i><span> 关于我</span></a></li><li><a class="site-page child" href="/talk/"><i class="fa-fw far fa-comment-dots"></i><span> 说说</span></a></li><li><a class="site-page child" href="/equipment/"><i class="fa-fw fa-solid fa-toolbox"></i><span> 我的装备</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://status.fyz666.xyz/"><i class="fa-fw iconfont icon-monitor"></i><span> 状态监控</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-link"></i><span> 链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fab fa-galactic-republic"></i><span> 朋友圈</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-user-friends"></i><span> 友链</span></a></li><li><a class="site-page child" href="/tlink/"><i class="fa-fw fas fa-tools"></i><span> 工具</span></a></li><li><a class="site-page child" href="/rlink/"><i class="fa-fw fas fa-save"></i><span> 资源</span></a></li><li><a class="site-page child" href="/projects/"><i class="fa-fw fas fa-project-diagram"></i><span> 我的项目</span></a></li><li><a class="site-page child" href="/cfop/"><i class="fa-fw fa-solid fa-cube"></i><span> CFOP</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw iconfont icon-global"></i><span> 线路</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.fyz666.xyz/" target="_blank" rel="noopener"><i class="fa-fw"></i><span> 主站点</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://gh.fyz666.xyz/"><span> GitHub</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://cf.fyz666.xyz/"><span> Cloudflare</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://vc.fyz666.xyz/"><span> Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://ntl.fyz666.xyz/"><span> Netlify</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://rd.fyz666.xyz/"><span> Render</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image:url('https://blogfiles.oss.fyz666.xyz/png/27506054-a13e-4478-804e-c6ad14056070.png')"><nav id="nav"><span id="blog-info"><a class="site-name" href="/" title="逸风亭">逸风亭</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-blog"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="javascript:toRandomPost();"><i class="fa-fw fa fa-paper-plane"></i><span> 随便逛逛</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-sitemap"></i><span> 本站</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw far fa-images"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐馆</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-info-circle"></i><span> 关于我</span></a></li><li><a class="site-page child" href="/talk/"><i class="fa-fw far fa-comment-dots"></i><span> 说说</span></a></li><li><a class="site-page child" href="/equipment/"><i class="fa-fw fa-solid fa-toolbox"></i><span> 我的装备</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://status.fyz666.xyz/"><i class="fa-fw iconfont icon-monitor"></i><span> 状态监控</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-link"></i><span> 链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/fcircle/"><i class="fa-fw fab fa-galactic-republic"></i><span> 朋友圈</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-user-friends"></i><span> 友链</span></a></li><li><a class="site-page child" href="/tlink/"><i class="fa-fw fas fa-tools"></i><span> 工具</span></a></li><li><a class="site-page child" href="/rlink/"><i class="fa-fw fas fa-save"></i><span> 资源</span></a></li><li><a class="site-page child" href="/projects/"><i class="fa-fw fas fa-project-diagram"></i><span> 我的项目</span></a></li><li><a class="site-page child" href="/cfop/"><i class="fa-fw fa-solid fa-cube"></i><span> CFOP</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw iconfont icon-global"></i><span> 线路</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.fyz666.xyz/" target="_blank" rel="noopener"><i class="fa-fw"></i><span> 主站点</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://gh.fyz666.xyz/"><span> GitHub</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://cf.fyz666.xyz/"><span> Cloudflare</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://vc.fyz666.xyz/"><span> Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://ntl.fyz666.xyz/"><span> Netlify</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://rd.fyz666.xyz/"><span> Render</span></a></li></ul></div></div></div><div id="nav-right"><div class="menus_item"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i></span></div></div><div class="menus_item"><div id="random"><a class="site-page social-icon" href="javascript:toRandomPost();" title="前往随机文章"><i class="fa fa-paper-plane"></i></a></div></div><div class="menus_item"><div id="travel"><a class="site-page social-icon" target="_blank" rel="noopener" href="https://travel.moe/go.html?travel=on" title="萌ICP备异次元之旅"><i class="iconfont icon-planet"></i></a></div></div><div class="menus_item"><div id="traveling"><a class="site-page social-icon" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html" title="开往-友联接力"><i class="fa fa-subway"></i></a></div></div><div class="menus_item"><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></div></nav><div id="post-info"><h1 class="post-title">PKU GeekGame 2nd 部分题目Write-Up</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2022-11-25T20:06:08.000Z" title="发表于 2022-11-26 04:06:08">2022-11-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf%E9%A2%98%E8%A7%A3/">CTF题解</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">13.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>57分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="PKU GeekGame 2nd 部分题目Write-Up"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="vercount_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/blog/8100/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div id="ai-container"><div id="ai-header"><div id="ai-title"><i class="fas fa-robot">&nbsp;</i><span>AI摘要</span><b id="ai-label"><a id="ai-link" target="_blank" rel="noopener" href="https://kimi.moonshot.cn/">Kimi Chat</a></b></div></div><div id="ai-content"></div></div><script>$(document).ready((function(){loadAbstract()}))</script><article class="post-content" id="article-container"><p>GeekGame 2nd结束了，今年的题没有了去年那种套娃，难度有所下降，总体感觉不错，也取得了比去年更高的总排名（29），对一名非专业菜鸟玩家而言，我已经相当满意。</p>
<p>更重要的是，我在解题过程中学到了不少东西，也获得了不少乐趣，而不是像去年那样晕头转向没有方向感。</p>
<a class="tag-Link" target="_blank" href="https://github.com/PKU-GeekGame/geekgame-2nd">
    <div class="tag-link-tips">引用站外地址，不保证站点的可用性和安全性</div>
    <div class="tag-link-bottom">
        <div class="tag-link-left">
            <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://logo.clearbit.com/github.com?size=256" onerror='this.onerror=null,this.src="/images/default-link.png"'>
        </div>
        <div class="tag-link-right">
            <div class="tag-link-title">本次比赛的官方存档</div>
            <div class="tag-link-sitename">GitHub</div>
        </div>
        <i class="fa-solid fa-angle-right"></i>
    </div>
    </a>
<h2 id="†签到†"><a href="#†签到†" class="headerlink" title="†签到†"></a>†签到†</h2><p>去年的签到我想了半个小时，今年只用了20秒。别问，问就是一模一样，见<a href="/blog/7311/">去年的题解</a>。<del>（PKU GeekGame的出题人怎么不在签到题上点心。</del> 官方题解出来后发现其实和去年的签到是有区别的，这次的PDF用某些阅读器打开会发现无法复制，然而我是用Chrome的沙拉查词插件带的PDF阅读器打开的，因此不受影响。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-2nd/raw/master/official_writeup/signin/attachment/prob19.pdf">本题附件</a></p>
<h2 id="小北问答-·-极速版"><a href="#小北问答-·-极速版" class="headerlink" title="小北问答 · 极速版"></a>小北问答 · 极速版</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>菜宝十分擅长网上冲浪，会使用十种甚至九种搜索引擎。本届 PKU GeekGame 一开始，她就急不可耐地打开了小北问答题目，想要在一血榜上展现她惊人的情报搜集能力。</p>
<p>为了让菜宝玩得开心，小北问答题目全新升级为小北问答 · 极速版。</p>
<p>小北问答 · 极速版自带省流助手，基于 socket 通信的纯文字 UI 简洁朴实，不浪费网络上的每一毫秒。</p>
<p>小北问答 · 极速版自带速通计时，只有手速够快的 CTF 选手才是好的 CTF 选手。</p>
<p>小北问答 · 极速版自带肉鸽玩法，每次连接到题目都有不一样的问题在等着你。</p>
<p>赶紧打开网页终端体验小北问答 · 极速版，把 Flag 抱回家吧！</p>
</div></div></details>
<p>与以往的问答题不同，这次问答平台提供的是一个终端，经多次尝试，发现共有以下8道题：</p>
<details class="toggle"><summary class="toggle-button">展开题目</summary><div class="toggle-content"><div class="note primary simple"><ol>
<li>北京大学某实验室曾开发了一个叫 gStore 的数据库软件。最早描述该软件的论文的 DOI 编号是多少？<br><strong>答案格式：^[\d.]+\/[\d.]+$</strong></li>
<li>我刚刚在脑海中想了一个介于 a 到 b 之间的质数。猜猜它是多少？<br><strong>答案格式：^\d+$</strong></li>
<li>访问网址 “<a target="_blank" rel="noopener" href="http://ctf.世界一流大学.com">http://ctf.世界一流大学.com</a>” 时，向该主机发送的 HTTP 请求中 Host 请求头的值是什么？<br><strong>答案格式：^<sup><a href="#fn_:\s" id="reffn_:\s">:\s</a></sup>+$</strong></li>
<li>支持 WebP 图片格式的最早 Firefox 版本是多少？<br><strong>答案格式：^\d+$</strong></li>
<li>每个 Android 软件都有唯一的包名。北京大学课外锻炼使用的最新版 PKU Runner 软件的包名是什么？<br><strong>答案格式：^[a-z.]+$</strong></li>
<li>我有一个朋友在美国，他无线路由器的 MAC 地址是 d2:94:35:21:42:43。请问他所在地的邮编是多少？<br><strong>答案格式：^\d+$</strong></li>
<li>视频 bilibili.com/video/BV1EV411s7vu 也可以通过 bilibili.com/video/av<strong>_</strong> 访问。下划线内应填什么数字？<br><strong>答案格式：^\d+$</strong></li>
<li>在第一届 PKU GeekGame 比赛的题目《电子游戏概论》中，通过第 n 级关卡需要多少金钱？<br><strong>答案格式：^\d+$</strong></li>
</ol>
</div></div></details>
<p>其中，第2题的a与b为比较随机的10位数，第8题的n也是一个动态变化的值。</p>
<p>对于每一题，我的解题思路如下：</p>
<ol>
<li>找到这个软件的<a target="_blank" rel="noopener" href="https://github.com/pkumod/gStore">github仓库</a>，在Readme文件中找到<a target="_blank" rel="noopener" href="https://github.com/pkumod/gStore/blob/1.0/docs/ESSAY.md">Related Essays</a>，可知最早的相关论文是”gStore: answering SPARQL queries via subgraph matching”，通过crossref搜索得到<a target="_blank" rel="noopener" href="https://search.crossref.org/?from_ui=&amp;q=gStore%3A+Answering+SPARQL+Queries+Via+Subgraph+Matching">此结果</a>。答案：10.14778/2002974.2002976</li>
<li>Python的sympy库可以直接寻找nextprime，经测试，a和b中间一般有8个质数，使用大数定律即可解决此问。</li>
<li>打开浏览器的开发者工具，然后访问<a target="_blank" rel="noopener" href="http://ctf.世界一流大学.com">http://ctf.世界一流大学.com</a>，可以抓到数据包，查看request header中的Host值即可。答案：ctf.xn—4gqwbu44czhc7w9a66k.com</li>
<li>谷歌一下即可。答案：65</li>
<li>搜索pku runner，发现最新版本的<a target="_blank" rel="noopener" href="https://pkunewyouth.pku.edu.cn/public/apks/pkurunner-latest.apk">下载链接</a>。在Linux上使用命令：<code>aapt dump badging pkurunner-latest.apk |grep package</code>，即可找到包名。答案：cn.edu.pku.pkurunner</li>
<li>不会，但根据二阶段的提示容易找到答案为80304</li>
<li>搜索 bv转av，搜到<a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=910">工具</a>。答案：418645518</li>
<li>找到相关题目的<a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-1st/blob/master/src/pygame/game/server/libtreasure.py">源码</a>，容易发现计算每一关目标金钱的函数：<code>GOAL_OF_LEVEL = lambda level: 300+int(level***1.5)**100</code></li>
</ol>
<p>虽然有一题不会，但由于每次只从题库中随机7题，那么仍有概率可以全部做对。题目还要求在3秒内完成作答，因此使用pwntools。下面为解题代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> random
<span class="token keyword">import</span> pwn
<span class="token keyword">import</span> sympy
<span class="token keyword">import</span> re

GOAL_OF_LEVEL <span class="token operator">=</span> <span class="token keyword">lambda</span> level<span class="token punctuation">:</span> <span class="token number">300</span><span class="token operator">+</span><span class="token builtin">int</span><span class="token punctuation">(</span>level<span class="token operator">**</span><span class="token number">1.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span>
r <span class="token operator">=</span> pwn<span class="token punctuation">.</span>remote<span class="token punctuation">(</span><span class="token string">'prob01.geekgame.pku.edu.cn'</span><span class="token punctuation">,</span> <span class="token number">10001</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'Please input your token:'</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'0:this_is_my_token'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'输入“急急急”开始答题。\n>'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'急急急'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'\n计时开始。\n'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    q <span class="token operator">=</span> r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'>'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'世界一流大学'</span> <span class="token keyword">in</span> q<span class="token punctuation">:</span>
        r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'ctf.xn--4gqwbu44czhc7w9a66k.com'</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token string">'Android'</span> <span class="token keyword">in</span> q<span class="token punctuation">:</span>
        r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'cn.edu.pku.pkurunner'</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token string">'bilibili'</span> <span class="token keyword">in</span> q<span class="token punctuation">:</span>
        r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'418645518'</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token string">'gStore'</span> <span class="token keyword">in</span> q<span class="token punctuation">:</span>
        r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'10.14778/2002974.2002976'</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token string">'Firefox'</span> <span class="token keyword">in</span> q<span class="token punctuation">:</span>
        r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'65'</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token string">'质数'</span> <span class="token keyword">in</span> q<span class="token punctuation">:</span>
        p1<span class="token punctuation">,</span> p2 <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'\d&#123;8,&#125;'</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span>
        p1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span>
        p2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span>
        maybe_ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        ans <span class="token operator">=</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>p1<span class="token punctuation">)</span>
        <span class="token keyword">while</span> ans <span class="token operator">&lt;</span> p2<span class="token punctuation">:</span>
            maybe_ans<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
            ans <span class="token operator">=</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
        r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>maybe_ans<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token string">'电子游戏'</span> <span class="token keyword">in</span> q<span class="token punctuation">:</span>
        level <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'通过第 (\d+) 级'</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>GOAL_OF_LEVEL<span class="token punctuation">(</span>level<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token string">'MAC'</span> <span class="token keyword">in</span> q<span class="token punctuation">:</span>
        ans <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">99999</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">05</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>
        r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>ans<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    res <span class="token operator">=</span> r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'不'</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>
        r<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> EOFError<span class="token punctuation">:</span>
            <span class="token keyword">break</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>只要多逝亿下就可以拿到flag~。在有了二阶段的第6题提示后，只要多试一下就能拿flag了。</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/a430e1b0-b0ef-4ab4-b584-cde188d6a76b.png" alt=""></p>
<h2 id="编原译理习题课"><a href="#编原译理习题课" class="headerlink" title="编原译理习题课"></a>编原译理习题课</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>一个测试工程师走进一家酒吧，要了一杯啤酒。</p>
<p>一个测试工程师走进一家酒吧，要了一杯咖啡。</p>
<p>一个测试工程师走进一家酒吧，要了 0.7 杯啤酒。</p>
<p>一个测试工程师走进一家酒吧，要了-1 杯啤酒。</p>
<p>一个测试工程师走进一家酒吧，要了一份雪王大圣代和冰鲜柠檬水。</p>
<p>一个测试工程师走进一家酒吧，对核验健康宝的店员出示了舞萌 DX 玩家二维码。</p>
<p>一个测试工程师走进一家酒吧，打开了 PKU GeekGame 比赛平台。</p>
<p>一个测试工程师走进一家酒吧，用 g++ 编译他的代码。</p>
<p>酒吧没炸，但 g++ 炸了。</p>
<p>你知道多少种让 g++ 爆炸的姿势呢？快来大显身手吧。</p>
<p>让 g++ 编译出的程序超过 8MB 可以获得 Flag 1</p>
<p>让 g++ 输出的报错信息超过 2MB 可以获得 Flag 2</p>
<p>让 g++ 因为段错误而崩溃 可以获得 Flag 3</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-2nd/raw/master/official_writeup/gcc/attachment/prob04.zip">本题附件</a></p>
</div></div></details>
<h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p>非常简单，唯一一个我自己就会做的flag。只要在程序里定义一个很大的全局变量就好了。</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">char</span> <span class="token keyword">const</span> bigarray<span class="token punctuation">[</span><span class="token number">8</span><span class="token operator">*</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>flag{nOt-much-LargEr-than-an-electron-apP}</p>
<h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>搜索 g++ huge error log，搜到<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/54004610/why-does-g-generate-huge-error-log">相关内容</a>。发现下面代码可以拿到flag2：</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">x</span> <span class="token keyword">struct</span> <span class="token class-name">z</span><span class="token operator">&lt;</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token function">x</span><span class="token punctuation">(</span>y<span class="token operator">></span><span class="token operator">&lt;</span>y<span class="token operator">*</span><span class="token punctuation">,</span><span class="token function">x</span><span class="token punctuation">(</span>y<span class="token operator">*</span>w<span class="token operator">></span>v<span class="token operator">&lt;</span>y<span class="token operator">*</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>x<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>flag{shorT volatile program; long loNg mesSagE;}</p>
<h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>搜索 g++ crash，搜到<a target="_blank" rel="noopener" href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=54080">此网页</a>。在里面找到一段代码，亲测可行：</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
<span class="token keyword">class</span> <span class="token class-name">vector</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">U</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">Container</span><span class="token punctuation">,</span><span class="token keyword">typename</span> <span class="token class-name">Func</span><span class="token operator">></span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">const</span> Container<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> input<span class="token punctuation">,</span> <span class="token keyword">const</span> Func <span class="token operator">&amp;</span>func<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">U</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">OutType</span><span class="token punctuation">,</span><span class="token keyword">typename</span> <span class="token class-name">Func1</span><span class="token punctuation">,</span><span class="token keyword">typename</span> <span class="token class-name">FuncRest</span><span class="token operator">></span>
<span class="token keyword">auto</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">&amp;</span>input<span class="token punctuation">,</span> <span class="token keyword">const</span> Func1 <span class="token operator">&amp;</span>func1<span class="token punctuation">,</span> <span class="token keyword">const</span> FuncRest funcrest<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">decltype</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">foo</span><span class="token generic class-name"><span class="token operator">&lt;</span>vector<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token function">foo</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> func1<span class="token punctuation">)</span><span class="token punctuation">,</span> funcrest<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v1<span class="token punctuation">;</span>
    <span class="token generic-function"><span class="token function">foo</span><span class="token generic class-name"><span class="token operator">&lt;</span>vector<span class="token operator">></span></span></span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>flag{soRry-to-inform-you-thAt-gnu-Is-not-uniX}</p>
<p>对于可以直接搜到答案的题，我觉得很迷惑，但，真香（</p>
<h2 id="Flag-Checker"><a href="#Flag-Checker" class="headerlink" title="Flag Checker"></a>Flag Checker</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>我们发现，有很多选手在比赛中提交了错误的 Flag。</p>
<p>为了防止这种情况发生，给选手良好的参赛体验，这里有一个简单的 Java 程序。</p>
<p>你可以在程序里面输入要提交 Flag ，程序会帮你检查 Flag 是否正确。</p>
<p>是不是非常的贴心呢？</p>
<p>提醒：JRE 版本高于 15 时可能无法运行此程序。建议使用 JRE 8 运行。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-2nd/raw/master/official_writeup/javarev/attachment/prob15.jar">本题附件</a></p>
</div></div></details>
<p>看到题，发现是Java，跳过（我不会Java</p>
<p>过了两三天，发现别的题不太会了，于是来看这题。根据提醒装了下JRE 8，然后试了几个Java反编译程序，最后用luyten解决了。</p>
<p>反编译出来的代码如下：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>script<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>event<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GeekGame</span> <span class="token keyword">extends</span> <span class="token class-name">Frame</span> <span class="token keyword">implements</span> <span class="token class-name">ActionListener</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">TextField</span> textField1<span class="token punctuation">;</span>
    <span class="token class-name">Button</span> button1<span class="token punctuation">;</span>
    <span class="token class-name">Button</span> button2<span class="token punctuation">;</span>
    <span class="token class-name">Invocable</span> invocable<span class="token punctuation">;</span>
    
    <span class="token class-name">GeekGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setLayout</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BoxLayout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Label</span> label <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Label</span><span class="token punctuation">(</span><span class="token string">"Flag: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>textField1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">"flag&#123;...&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>button1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string">"Check Flag 1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addActionListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>button2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string">"Check Flag 2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addActionListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>textField1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>button1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>button2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">ScriptEngine</span> engineByName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ScriptEngineManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEngineByName</span><span class="token punctuation">(</span><span class="token string">"nashorn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">final</span> <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">"\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081\u00cf\u008c\u0087\u008a\u008c\u0084\u0089\u0083\u008e\u0088\u00dd\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dd\u00c6\u0094\u0099\u008e\u009d\u00cf°\u00df\u0097\u00d8\u00dd\u00db\u008d\u00d2´\u00c8\u008c\u0087\u008e\u009d¬\u0080\u008b\u008a®\u009b\u00c8\u00c3\u00c8\u0082\u008e\u009f\u00c8\u00c3\u00c8\u00c8\u00c3\u00c8\u009c\u009f\u0083\u0086\u009b\u00c8\u00c3\u00c8\u009c\u009b\u009d\u0086\u0081\u0088\u0086\u0089\u0096\u00c8\u00c3\u00c8¬\u0080\u009d\u009d\u008a\u008c\u009b\u00c8\u00c3\u00c8¸\u009d\u0080\u0081\u0088\u00c8\u00c3\u00c8\u0085\u00c2\u00c8²\u00d4\u009d\u008a\u009b\u009a\u009d\u0081\u00cf\u00c7¥¼ ¡´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00db²²\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dd´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00dc²²\u00c7°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00dd²\u00c6´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00de²²\u00c7\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dc\u00c6\u0094\u009d\u008a\u009b\u009a\u009d\u0081\u00cf°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dc´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00df²²\u00c7\u00df\u00c6\u0092\u00c6\u00c6\u00d2\u00d2\u00cf¥¼ ¡´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00db²²\u00c7´\u00df\u00c3\u00de\u00da\u00c3\u00de\u00d9\u00c3\u00de\u00d8\u00c3\u00dc\u00df\u00c3\u00de\u00df\u00da\u00c3\u00de\u00d9\u00c3\u00dc\u00de\u00c3\u00de\u00d9\u00c3\u00d9\u00d8\u00c3\u00dc\u00c3\u00dc\u00dc\u00c3\u00da\u00c3\u00d9\u00df\u00c3\u00db\u00c3\u00de\u00df\u00d9\u00c3\u00d9\u00c3\u00db\u00de\u00c3\u00df\u00c3\u00de\u00c3\u00d9\u00d8\u00c3\u00dc\u00c3\u00de\u00d9\u00c3\u00db\u00c3\u00d9\u00c3\u00dc\u00dc\u00c3\u00dd\u00dc\u00dd²´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00de²²\u00c7\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dc\u00c6\u0094\u009d\u008a\u009b\u009a\u009d\u0081\u00cf\u00c7\u008c\u0087\u008a\u008c\u0084\u0089\u0083\u008e\u0088\u00dd\u00c4\u00cf°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00dd²\u00c6´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00df²²\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dc\u00c6\u0092\u00c6\u00c6\u00d0°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00da²\u00d5°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00d9²\u00c6\u0092"</span><span class="token punctuation">;</span>
            <span class="token keyword">final</span> <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token char">'\u00ef'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            engineByName<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span>sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">final</span> <span class="token class-name">StringWriter</span> stringWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span>stringWriter<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">JOptionPane</span><span class="token punctuation">.</span><span class="token function">showMessageDialog</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> stringWriter<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>invocable <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Invocable</span><span class="token punctuation">)</span>engineByName<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addWindowListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WindowAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">windowClosing</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">WindowEvent</span> windowEvent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">actionPerformed</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">ActionEvent</span> actionEvent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>actionEvent<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>button1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"MzkuM8gmZJ6jZJHgnaMuqy4lMKM4"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">rot13</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>textField1<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token class-name">JOptionPane</span><span class="token punctuation">.</span><span class="token function">showMessageDialog</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"Correct"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                    <span class="token class-name">JOptionPane</span><span class="token punctuation">.</span><span class="token function">showMessageDialog</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"Wrong"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                <span class="token class-name">JOptionPane</span><span class="token punctuation">.</span><span class="token function">showMessageDialog</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>invocable<span class="token punctuation">.</span><span class="token function">invokeFunction</span><span class="token punctuation">(</span><span class="token punctuation">(</span>actionEvent<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>button2<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"checkflag2"</span> <span class="token operator">:</span> <span class="token string">"checkflag3"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>textField1<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">final</span> <span class="token class-name">StringWriter</span> stringWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span>stringWriter<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">JOptionPane</span><span class="token punctuation">.</span><span class="token function">showMessageDialog</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> stringWriter<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">rot13</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">final</span> <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">char</span> char1 <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>char1 <span class="token operator">>=</span> <span class="token char">'a'</span> <span class="token operator">&amp;&amp;</span> char1 <span class="token operator">&lt;=</span> <span class="token char">'m'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                char1 <span class="token operator">+=</span> <span class="token char">'\r'</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>char1 <span class="token operator">>=</span> <span class="token char">'A'</span> <span class="token operator">&amp;&amp;</span> char1 <span class="token operator">&lt;=</span> <span class="token char">'M'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                char1 <span class="token operator">+=</span> <span class="token char">'\r'</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>char1 <span class="token operator">>=</span> <span class="token char">'n'</span> <span class="token operator">&amp;&amp;</span> char1 <span class="token operator">&lt;=</span> <span class="token char">'z'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                char1 <span class="token operator">-=</span> <span class="token char">'\r'</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>char1 <span class="token operator">>=</span> <span class="token char">'N'</span> <span class="token operator">&amp;&amp;</span> char1 <span class="token operator">&lt;=</span> <span class="token char">'Z'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                char1 <span class="token operator">-=</span> <span class="token char">'\r'</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>char1 <span class="token operator">>=</span> <span class="token char">'5'</span> <span class="token operator">&amp;&amp;</span> char1 <span class="token operator">&lt;=</span> <span class="token char">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                char1 <span class="token operator">-=</span> <span class="token char">'\u0005'</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>char1 <span class="token operator">>=</span> <span class="token char">'0'</span> <span class="token operator">&amp;&amp;</span> char1 <span class="token operator">&lt;=</span> <span class="token char">'4'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                char1 <span class="token operator">+=</span> <span class="token char">'\u0005'</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>char1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">final</span> <span class="token class-name">GeekGame</span> geekGame <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeekGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>发现逻辑很简单，幸亏做了一下（</p>
<h3 id="flag1-1"><a href="#flag1-1" class="headerlink" title="flag1"></a>flag1</h3><p>是一个rot13+base64，</p>
<p>解题代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64
<span class="token keyword">import</span> json

<span class="token keyword">def</span> <span class="token function">rot13</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> s<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token string">'a'</span> <span class="token operator">&lt;=</span> c <span class="token operator">&lt;=</span> <span class="token string">'m'</span> <span class="token keyword">or</span> <span class="token string">'A'</span> <span class="token operator">&lt;=</span> c <span class="token operator">&lt;=</span> <span class="token string">'M'</span><span class="token punctuation">:</span>
            res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> <span class="token string">'n'</span> <span class="token operator">&lt;=</span> c <span class="token operator">&lt;=</span> <span class="token string">'z'</span> <span class="token keyword">or</span> <span class="token string">'N'</span> <span class="token operator">&lt;=</span> c <span class="token operator">&lt;=</span> <span class="token string">'Z'</span><span class="token punctuation">:</span>
            res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">13</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> <span class="token string">'5'</span> <span class="token operator">&lt;=</span> c <span class="token operator">&lt;=</span> <span class="token string">'9'</span><span class="token punctuation">:</span>
            res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> <span class="token string">'0'</span> <span class="token operator">&lt;=</span> c <span class="token operator">&lt;=</span> <span class="token string">'4'</span><span class="token punctuation">:</span>
            res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> res


s <span class="token operator">=</span> <span class="token string">"MzkuM8gmZJ6jZJHgnaMuqy4lMKM4"</span>
s <span class="token operator">=</span> rot13<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
flag1 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>flag{s1mp1e-jvav_rev}</p>
<h3 id="flag2-1"><a href="#flag2-1" class="headerlink" title="flag2"></a>flag2</h3><p>大概看了一下，发现用到了<code>this.invocable.invokeFunction</code>这个函数，经搜索发现是执行JavaScript代码的，意思是执行JavaScript程序中的checkflag2函数。</p>
<p>阅读代码发现最前面执行了一段奇怪的内容：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">final</span> <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">"\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081\u00cf\u008c\u0087\u008a\u008c\u0084\u0089\u0083\u008e\u0088\u00dd\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dd\u00c6\u0094\u0099\u008e\u009d\u00cf°\u00df\u0097\u00d8\u00dd\u00db\u008d\u00d2´\u00c8\u008c\u0087\u008e\u009d¬\u0080\u008b\u008a®\u009b\u00c8\u00c3\u00c8\u0082\u008e\u009f\u00c8\u00c3\u00c8\u00c8\u00c3\u00c8\u009c\u009f\u0083\u0086\u009b\u00c8\u00c3\u00c8\u009c\u009b\u009d\u0086\u0081\u0088\u0086\u0089\u0096\u00c8\u00c3\u00c8¬\u0080\u009d\u009d\u008a\u008c\u009b\u00c8\u00c3\u00c8¸\u009d\u0080\u0081\u0088\u00c8\u00c3\u00c8\u0085\u00c2\u00c8²\u00d4\u009d\u008a\u009b\u009a\u009d\u0081\u00cf\u00c7¥¼ ¡´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00db²²\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dd´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00dc²²\u00c7°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00dd²\u00c6´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00de²²\u00c7\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dc\u00c6\u0094\u009d\u008a\u009b\u009a\u009d\u0081\u00cf°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dc´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00df²²\u00c7\u00df\u00c6\u0092\u00c6\u00c6\u00d2\u00d2\u00cf¥¼ ¡´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00db²²\u00c7´\u00df\u00c3\u00de\u00da\u00c3\u00de\u00d9\u00c3\u00de\u00d8\u00c3\u00dc\u00df\u00c3\u00de\u00df\u00da\u00c3\u00de\u00d9\u00c3\u00dc\u00de\u00c3\u00de\u00d9\u00c3\u00d9\u00d8\u00c3\u00dc\u00c3\u00dc\u00dc\u00c3\u00da\u00c3\u00d9\u00df\u00c3\u00db\u00c3\u00de\u00df\u00d9\u00c3\u00d9\u00c3\u00db\u00de\u00c3\u00df\u00c3\u00de\u00c3\u00d9\u00d8\u00c3\u00dc\u00c3\u00de\u00d9\u00c3\u00db\u00c3\u00d9\u00c3\u00dc\u00dc\u00c3\u00dd\u00dc\u00dd²´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00de²²\u00c7\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dc\u00c6\u0094\u009d\u008a\u009b\u009a\u009d\u0081\u00cf\u00c7\u008c\u0087\u008a\u008c\u0084\u0089\u0083\u008e\u0088\u00dd\u00c4\u00cf°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00dd²\u00c6´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00df²²\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dc\u00c6\u0092\u00c6\u00c6\u00d0°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00da²\u00d5°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00d9²\u00c6\u0092"</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token char">'\u00ef'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    engineByName<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span>sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>我用Python重写了一下，发现字符串sb的值是：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">checkflag2</span><span class="token punctuation">(</span><span class="token parameter">_0xa83ex2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">var</span> _0x724b<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'charCodeAt'</span><span class="token punctuation">,</span><span class="token string">'map'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'split'</span><span class="token punctuation">,</span><span class="token string">'stringify'</span><span class="token punctuation">,</span><span class="token string">'Correct'</span><span class="token punctuation">,</span><span class="token string">'Wrong'</span><span class="token punctuation">,</span><span class="token string">'j-'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">[</span>_0x724b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0xa83ex2<span class="token punctuation">[</span>_0x724b<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0x724b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>_0x724b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">_0xa83ex3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> _0xa83ex3<span class="token punctuation">[</span>_0x724b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token constant">JSON</span><span class="token punctuation">[</span>_0x724b<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">232</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_0x724b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">_0xa83ex3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token punctuation">(</span>checkflag2<span class="token operator">+</span> _0x724b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>_0x724b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span>_0xa83ex3<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span>_0x724b<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">:</span>_0x724b<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>稍微整理一下这个函数：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">checkflag2</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token constant">JSON</span><span class="token punctuation">[</span><span class="token string">"stringify"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token string">"split"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"map"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>
            <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                <span class="token keyword">return</span> c<span class="token punctuation">[</span><span class="token string">"charCodeAt"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token operator">===</span> <span class="token constant">JSON</span><span class="token punctuation">[</span><span class="token string">"stringify"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">106</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">232</span><span class="token punctuation">]</span><span class="token punctuation">[</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">(</span>
            <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                <span class="token keyword">return</span> <span class="token punctuation">(</span>checkflag2<span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"charCodeAt"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token operator">?</span><span class="token string">'Correct'</span><span class="token operator">:</span><span class="token string">'Wrong'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>容易理解逻辑，因此flag2也不难，解题代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># encoding=utf-8</span>
<span class="token keyword">import</span> json

code <span class="token operator">=</span> <span class="token string">'\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081\u00cf\u008c\u0087\u008a\u008c\u0084\u0089\u0083\u008e\u0088\u00dd\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dd\u00c6\u0094\u0099\u008e\u009d\u00cf°\u00df\u0097\u00d8\u00dd\u00db\u008d\u00d2´\u00c8\u008c\u0087\u008e\u009d¬\u0080\u008b\u008a®\u009b\u00c8\u00c3\u00c8\u0082\u008e\u009f\u00c8\u00c3\u00c8\u00c8\u00c3\u00c8\u009c\u009f\u0083\u0086\u009b\u00c8\u00c3\u00c8\u009c\u009b\u009d\u0086\u0081\u0088\u0086\u0089\u0096\u00c8\u00c3\u00c8¬\u0080\u009d\u009d\u008a\u008c\u009b\u00c8\u00c3\u00c8¸\u009d\u0080\u0081\u0088\u00c8\u00c3\u00c8\u0085\u00c2\u00c8²\u00d4\u009d\u008a\u009b\u009a\u009d\u0081\u00cf\u00c7¥¼ ¡´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00db²²\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dd´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00dc²²\u00c7°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00dd²\u00c6´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00de²²\u00c7\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dc\u00c6\u0094\u009d\u008a\u009b\u009a\u009d\u0081\u00cf°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dc´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00df²²\u00c7\u00df\u00c6\u0092\u00c6\u00c6\u00d2\u00d2\u00cf¥¼ ¡´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00db²²\u00c7´\u00df\u00c3\u00de\u00da\u00c3\u00de\u00d9\u00c3\u00de\u00d8\u00c3\u00dc\u00df\u00c3\u00de\u00df\u00da\u00c3\u00de\u00d9\u00c3\u00dc\u00de\u00c3\u00de\u00d9\u00c3\u00d9\u00d8\u00c3\u00dc\u00c3\u00dc\u00dc\u00c3\u00da\u00c3\u00d9\u00df\u00c3\u00db\u00c3\u00de\u00df\u00d9\u00c3\u00d9\u00c3\u00db\u00de\u00c3\u00df\u00c3\u00de\u00c3\u00d9\u00d8\u00c3\u00dc\u00c3\u00de\u00d9\u00c3\u00db\u00c3\u00d9\u00c3\u00dc\u00dc\u00c3\u00dd\u00dc\u00dd²´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00de²²\u00c7\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dc\u00c6\u0094\u009d\u008a\u009b\u009a\u009d\u0081\u00cf\u00c7\u008c\u0087\u008a\u008c\u0084\u0089\u0083\u008e\u0088\u00dd\u00c4\u00cf°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00dd²\u00c6´°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00df²²\u00c7°\u00df\u0097\u008e\u00d7\u00dc\u008a\u0097\u00dc\u00c6\u0092\u00c6\u00c6\u00d0°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00da²\u00d5°\u00df\u0097\u00d8\u00dd\u00db\u008d´\u00d9²\u00c6\u0092'</span>
jscode <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xef</span><span class="token punctuation">)</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">)</span>
target <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>jscode<span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">:</span><span class="token number">330</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>jscode<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> target<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>flag{javascript-obfuscator}</p>
<h2 id="企鹅文档"><a href="#企鹅文档" class="headerlink" title="企鹅文档"></a>企鹅文档</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>在一个开源软件学术大会上，主持人突然说：下面请认为无代码开发会减少安全漏洞的同志坐到会场左边，认为无代码开发会增加安全漏洞的同志坐到会场右边。</p>
<p>大部分人坐到了左边，少数人坐到右边，只有 You 酱还坐在中间不动。</p>
<p>主持人：侑同志，你到底认为无代码开发会减少还是增加漏洞？</p>
<p>回答：我认为无代码开发会减少原来存在的漏洞，但是会带来很多新的漏洞。</p>
<p>主持人慌忙说：那请您赶快坐到主席台上来。</p>
<p>企鹅文档相信大家都很熟悉，它是企鹅公司久负盛名的在线文档编辑平台。但是基于企鹅文档的无代码 OA 系统是怎么回事呢？下面就让小编带大家一起了解吧。</p>
<p>基于企鹅文档的无代码 OA 系统，其实就是用企鹅文档来实现 OA 系统。很多企业、学校、组织之前使用 OA 系统来下发通知和填报报表，现在这些机构很多都转向了使用企鹅文档来下发通知和填报报表，当然可以选择问卷星这些类似的服务。</p>
<p>大家可能会感到惊讶，用企鹅文档来填报报表不会出现安全和隐私问题吗？但事实就是这样，小编也感到非常惊讶。</p>
<p>那么这就是基于企鹅文档的无代码 OA 系统了，大家有没有觉得很神奇呢？快快点击左下角的阅读原文来看看基于企鹅文档的无代码 OA 系统吧。</p>
<p><a target="_blank" rel="noopener" href="https://docs.qq.com/sheet/DV1lsUFRhQlp5eWtq?tab=BB08J2">本题文档</a></p>
</div></div></details>
<p>打开题目我感到很惊讶，因为这题居然出在现实生产环境里，而且就是很多人经常在用的腾讯文档。</p>
<p>打开文档显示以下内容：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/bd40d04a-0b12-4261-88aa-a7f03cb88246.png" alt=""><br>点了一下下面的单元格，发现它确实不让我看：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/799621f4-8d63-475c-8afe-fe382c6224c8.png" alt=""><br>难道腾讯文档有权限方面的漏洞不成？我Google了一下腾讯文档漏洞，确实好像有一些，但没找到题目里这种可以直接查看受保护区域的。</p>
<p>然后我发现这是个web题，想到会不会腾讯文档的权限验证是在前端完成的，虽然感觉毕竟是TX，怎么可能犯这种愚蠢的错误，但我还是抓了个包看了一下，结果居然真在数据包里发现了这些隐藏起来的东西。。。</p>
<p>需要注意的是，隐藏内容被分在两个不同的请求中，可以通过搜索”机密flag”快速定位到相关内容，于是拿到了一个链接：<code>https://geekgame.pku.edu.cn/service/template/prob_kAiQcWHobsBzRJEs_next</code></p>
<p>访问链接显示以下内容：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/55f6506a-ec9e-47ab-9a45-0e6bd46d2e9e.png" alt=""><br>点击下载附件，下载到一个har文件（见下方），很多软件都能打开该类型的文件，我用的是Fiddler Classic。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-2nd/raw/master/official_writeup/txdocs/attachment/kAiQcWHobsBzRJEs_next.7z">本题附件</a><br>一开始我在数据包中发现一条链接：<code>https://docs.qq.com/sheet/DV1hldXRnekRnUGxR</code>，以为发现了华点，结果打开来一看：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/708b46f3-84f8-435c-95b4-d60534bd9dea.png" alt=""><br>像是保存flag的文档，只是被删掉了。然后我试图通过找文档的历史版本来解题，然而找了半天无果，感觉这应该并不可能找到。于是只能换条路子。</p>
<p>很容易在一堆数据包中发现某条请求（<code>GET /dop-api/get/sheet?u=75c5d3b1d8fb43489cd2c3033995b7a5&amp;subId=BB08J2&amp;rev=1&amp;fRev=1&amp;padId=300000000$WXeutgzDgPlQ&amp;wb=1&amp;isChunks=true&amp;nowb=0&amp;xsrf=1f438a6825f53e17&amp;_r=8500&amp;revdata=1&amp;outformat=1&amp;normal=1&amp;startrow=0&amp;endrow=2000</code>）的response中有一些重要内容：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/5629160b-2f65-4896-a25e-2bd7ce673324.png" alt=""><br>一开始我没注意到前面网页里的“提示”，然后对着上面的重要内容发了半天的呆不知道它想干啥。</p>
<p>后来我注意到了前面的“提示”：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/dbf758f2-cce0-46f0-a4e3-93fefbb00937.png" alt=""></p>
<p>原来如此。然后我研究了一下腾讯文档前端渲染的逻辑。腾讯文档单元格的编号是从左到右，从上到下，从0开始编号，前面Below is your flag下面的一些数字应该表示曾被涂黑过的单元格的编号，将它们转换到具体的单元格，应该可以拼出flag的样子。</p>
<p>于是写了一个脚本处理这个请求的response（我将其命名为maybe_flag.json）：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"maybe_flag.json"</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>
max_col <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'maxcol'</span><span class="token punctuation">]</span>
max_row <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'maxrow'</span><span class="token punctuation">]</span>
text <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'initialAttributedText'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
keys <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> text<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">" "</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>max_col<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>max_row<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    row<span class="token punctuation">,</span> col <span class="token operator">=</span> i <span class="token operator">//</span> max_col<span class="token punctuation">,</span> i <span class="token operator">%</span> max_col
    <span class="token keyword">if</span> i <span class="token keyword">in</span> keys<span class="token punctuation">:</span>
        flag<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"#"</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>执行一下脚本即可竖向打印出flag的样子。</p>
<p>flag{ThisIsNotSponsoredByTencent}</p>
<p>不过依旧觉得在现实环境里出题非常奇怪，现在tx已经把这个权限的漏洞修了，假如这个漏洞是在比赛还没结束的时候修复的，不知道比赛方会作何处理。</p>
<h2 id="企业级理解"><a href="#企业级理解" class="headerlink" title="企业级理解"></a>企业级理解</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>大型企业的软件开发方式与开源项目是不同的。 只有拥有了大型企业特有的企业级理解，才能够更好地让产品为客户赋能，实现前端与后台的解耦，将需求对齐到场景的完整链路中，实现从底层到盈利层的打通……</p>
<p>有些企业选择了坚如磐石的 Java 8 语言，只有在数十亿设备上都能运行的环境才是稳定可靠的环境。</p>
<p>有些企业选择了历久弥新的 Spring Framework，毕竟只需要写几行配置就能为一个巨大的 Web App 增加自动生成的登录页面，工程师放心，产品经理也放心。</p>
<p>有些企业选择了让程序员用 A4 纸书面打印代码来考核工作量，因为 “Talk is cheap, show me your code.” 是每名科班程序员的信条。</p>
<p>有些企业选择了用毕业典礼欢送每一名员工，即将毕业的 You 酱心有不甘，摸了摸胸前的工牌，在会议室的桌上捡起了两张同事上周打印出来的代码，希望能够成为自己职业道路上的一份纪念。</p>
<p>你，有着企业级理解吗？</p>
<p>补充说明：本题不需要爆破密码。三个 Flag 分别需要绕过登录页面访问管理后台、访问本机上的 bonus 服务、通过 bonus 服务在机器上执行命令。</p>
<p>注意：题目返回的 Flag 格式可能形如 flag1{…}，请改成 flag{…} 后提交。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-2nd/raw/master/official_writeup/antweb/attachment/prob08-src.pdf">部分题目源码</a></p>
</div></div></details>
<h3 id="flag1-2"><a href="#flag1-2" class="headerlink" title="flag1"></a>flag1</h3><p>打开部分题目源码，发现：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/aafbf297-13b1-4c7b-b92b-50ca06fd1430.png" alt=""><br>我以前也写过这种类似的权限控制的东西，这题应该是通过在链接后加斜杠来绕过匹配，试了一下果不其然。</p>
<p>访问/admin/，发现有如下表单：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/562f1e59-3bbc-4ded-bf86-36cd3707da02.png" alt=""><br>下拉框有三个给定值：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/ab94c30f-e78c-47c3-aa49-6bfef5429963.png" alt=""><br>填了几个value提交了一下，发现会跳转回/login，于是陷入死局。</p>
<p>访问/admin/source_bak/，发现一些其他内容：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>reactive<span class="token punctuation">.</span>function<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">WebClient</span></span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@RestController</span> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AdminController</span> <span class="token punctuation">&#123;</span> 
	<span class="token class-name">WebClient</span> webClient <span class="token operator">=</span> <span class="token class-name">WebClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8079/"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/admin/&#123;index&#125;"</span><span class="token punctuation">)</span> 
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">adminIndex</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"index"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> index<span class="token punctuation">,</span> <span class="token class-name">String</span> auth<span class="token punctuation">,</span> <span class="token class-name">QueryBean</span> queryBean<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
		<span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;</span> index<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"%"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
			index <span class="token operator">=</span> <span class="token class-name">URLDecoder</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
		<span class="token punctuation">&#125;</span> 
		<span class="token keyword">if</span> <span class="token punctuation">(</span>queryBean<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
			queryBean<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">"PKU"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
		<span class="token punctuation">&#125;</span> 
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>typeList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>queryBean<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
			typeList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>queryBean<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
		<span class="token punctuation">&#125;</span> 
		<span class="token class-name">Mono</span> str <span class="token operator">=</span> webClient<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token class-name">HttpHeaders</span><span class="token punctuation">.</span><span class="token constant">AUTHORIZATION</span><span class="token punctuation">,</span> auth<span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">BodyInserters</span><span class="token punctuation">.</span><span class="token function">fromFormData</span><span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">,</span> queryBean<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token function">retrieve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bodyToMono</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
		<span class="token keyword">return</span> queryBean<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">block</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>发现这个代码看上去应该是处理query的，并且这个query有个参数是type。注意到前面的源码处有一条”/admin/query”，那么同样如果在这里加个斜杠，应该也可以绕过限制去请求query。于是异想天开，试了一下访问如下三个链接：</p>
<ul>
<li>/admin/query/?type=PKU</li>
<li>/admin/query/?type=PKU_Game</li>
<li>/admin/query/?type=PKU_GeekGame</li>
</ul>
<p>访问第三个时，拿到了flag1：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/2fcf39b0-92f6-484e-804a-c509661cc832.png" alt=""><br>算是一个意外之喜，后来我发现只要在看一下前面表单的提交数据包，也可以发现这个请求，并且是POST请求。而这里我用GET请求也拿到了flag。</p>
<h2 id="这也能卷"><a href="#这也能卷" class="headerlink" title="这也能卷"></a>这也能卷</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>某大学的很多课都有作业，特别是程序设计课程，往往会要求同学们写些简单程序当作业。 可惜，现在大家都很卷，考试总能取得极高的分数，甚至大作业也会卷出新花样来。 倘若某人在作业上开摆，那么等待他的往往只能是一个寄字，这也是某大学“摆寄”花名之由来。</p>
<p>你有一位室友，他的口头禅是“我是摆大最摆的人”和“我从不内卷”。</p>
<p>这一次，他选修了一门叫《JavaScript程序设计》的课程。自从选修这门课程后，你发现他 天天熬到半夜，对着VSCode傻笑，实为异常。</p>
<p>一天，你在偶然间听到了他的喃喃自语：“只要我把小作业当期末作业做，大作业当毕业设计做，势必能卷过其他卷王！” 听到这，感觉收到了欺骗的你勃然大怒，打开了他的第一个“小”作业——一个“简单”的计算器。</p>
<p>另外，通过一顿家园，你获得了他的后端源码，<del>这让这道题的难度大大降低。</del></p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-2nd/raw/master/official_writeup/ultimatesandbox/attachment/prob09-src.tar.gz">后端源码</a></p>
</div></div></details>
<h3 id="flag1-3"><a href="#flag1-3" class="headerlink" title="flag1"></a>flag1</h3><p>访问题目网页，发现真的是个计算器，并且还有Premium版</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/2437fc15-3e7a-481c-8b86-caed4e05115f.png" alt=""></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/a24d5613-324e-46e2-9e91-78e9f64aa0a0.png" alt=""><br>二阶段提示：</p>
<p>对于Flag1:</p>
<ul>
<li>成为会员会有不错的收获。</li>
<li>不要试图逆向<code>premium.js</code>，会变得不幸。</li>
</ul>
<p>我在一阶段试图逆向了premium.js，但并没有变得不幸，反而让我捡到了flag（</p>
<p>以下是premium.js片段：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/9d84f92e-9839-4fd7-a63b-e77555dedd9c.png" alt=""><br>我发现有个全局变量叫flag0，于是立马放到console里执行：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/08b331e5-24ca-44de-a939-8228f7518b8b.png" alt=""><br>顺便激活了Premium。</p>
<h2 id="381654729"><a href="#381654729" class="headerlink" title="381654729"></a>381654729</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>381654729，被称为“神奇而又独一无二的数”。</p>
<p>小 Z 找到了一个类似的数，并把 Flag 编码到这个数里面，你能找到它吗？</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-2nd/raw/master/official_writeup/polydivisible/attachment/prob16.py">本题附件</a></p>
</div></div></details>
<p>搜了一下381654729这个数，发现是<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Polydivisible_number">Polydivisible number</a>，性质不再解释，阅读了一下题目附件，发现是让我们找一个16进制下的Polydivisible number，当然，位数要足够多，这样才能让flag是ascii字符。</p>
<p>求这种数肯定有很多现成的程序，搜了一堆，发现还是维基百科里的那个好用：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/debd10ee-cba6-4de2-98d5-ed4c8ab7651d.png" alt=""><br>拿来试了一下，轻松跑出flag：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">find_polydivisible</span><span class="token punctuation">(</span>base<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    previous <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> base<span class="token punctuation">)</span><span class="token punctuation">]</span>
    new <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    digits <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">while</span> <span class="token keyword">not</span> previous <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        numbers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>previous<span class="token punctuation">)</span>
        <span class="token keyword">for</span> n <span class="token keyword">in</span> previous<span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> base<span class="token punctuation">)</span><span class="token punctuation">:</span>
                number <span class="token operator">=</span> n <span class="token operator">*</span> base <span class="token operator">+</span> j
                <span class="token keyword">if</span> number <span class="token operator">%</span> digits <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                    new<span class="token punctuation">.</span>append<span class="token punctuation">(</span>number<span class="token punctuation">)</span>
        previous <span class="token operator">=</span> new
        new <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        digits <span class="token operator">=</span> digits <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">return</span> numbers


numbers <span class="token operator">=</span> find_polydivisible<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> number_list <span class="token keyword">in</span> numbers<span class="token punctuation">:</span>
    <span class="token keyword">for</span> n <span class="token keyword">in</span> number_list<span class="token punctuation">:</span>
        flag <span class="token operator">=</span> n <span class="token operator">^</span> <span class="token number">2511413510786744827230530121061181104625830238751614858642</span>
        flag <span class="token operator">=</span> flag<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>flag{fOund_MaGic_nUmber}</p>
<h2 id="乱码还原"><a href="#乱码还原" class="headerlink" title="乱码还原"></a>乱码还原</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>将需要打码的文字输入在上面的文本框里，点击『听佛说宇宙的真谛』按钮，就能在下面得到打码后的文字。</p>
<p>将需要解码的文字输入在下面的文本框里，记得带上『佛曰：』或『如是我闻：』的文字，点击『参悟佛所言的真意』按钮，就能在上面的文本框里得到解码后的文字。</p>
<p>顺便说下，为什么有时候会出现『太深奥了，参悟不出佛经的真意……』的情况，那是因为某些深井冰的网站（百度说的就是你！），会将繁体字转换为简体字，这样你复制后的文字已经不是最初的原文了，所以解不出。本佛祖的代言人已经尽力的去尝试参悟了，可惜还是有部分被篡改的佛语无能为力，十分抱歉o(&gt;﹏&lt;)o</p>
<p>——<a target="_blank" rel="noopener" href="https://www.keyfc.net/bbs/tools/tudoucode.aspx">与佛论禅</a></p>
<p>小 Z 身在日本，有人给小 Z 发了一大段佛语，但是小 Z 一打开，全是乱码。这该怎么办啊？</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-2nd/raw/master/official_writeup/tudoucode/attachment/prob18.zip">本题附件</a></p>
</div></div></details>
<h3 id="flag1-4"><a href="#flag1-4" class="headerlink" title="flag1"></a>flag1</h3><p>注意到flag1的生成方法：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag1"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    x<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag1.enc"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>Encrypt<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"shift_jis"</span><span class="token punctuation">,</span>errors<span class="token operator">=</span><span class="token string">"ignore"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>其中，Encrypt函数：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">Encrypt</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 1. Encode Plaintext in UTF-16 Little Endian</span>
    data <span class="token operator">=</span> plaintext<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-16le'</span><span class="token punctuation">)</span>
    <span class="token comment"># 2. Add Paddings (PKCS7)</span>
    pads <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span>
    data <span class="token operator">=</span> data <span class="token operator">+</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>pads <span class="token operator">*</span> <span class="token punctuation">[</span>pads<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 3. Use AES-256-CBC to Encrypt</span>
    cryptor <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>KEY<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> IV<span class="token punctuation">)</span>
    result <span class="token operator">=</span> cryptor<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token comment"># 4. Encode and Add Header</span>
    <span class="token keyword">return</span> <span class="token string">'佛曰：'</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>TUDOU<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">if</span> i <span class="token operator">&lt;</span> <span class="token number">128</span> <span class="token keyword">else</span> choice<span class="token punctuation">(</span>BYTEMARK<span class="token punctuation">)</span> <span class="token operator">+</span> TUDOU<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">128</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> result<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>将文本先进行AES加密，然后转换成“佛语编码”，也即一些汉字。</p>
<p>再回到生成flag1.enc的代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">Encrypt<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"shift_jis"</span><span class="token punctuation">,</span>errors<span class="token operator">=</span><span class="token string">"ignore"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>先将佛语进行utf-8编码，再进行shift_jis解码，了解到后者是日语里的一种常用编码格式。并且utf-8是将汉字编码为3个字节，shift_jis则是将日文字符编码为1-2个字节，而通过utf-8编码得到的内容按1-2字节进行分组，则未必在shift_jis的字符集里，直接用shift_jis解码有概率会导致报错，而errors=”ignore”行为表示如果遇到无法解码的字节，则直接忽略。因此这一编码-解码行为是有一定的损失的。但好在损失不会影响字节之间的顺序，因此在原文长度较短的情况下，可以通过暴力搜索逐字对原文进行还原。而flag1满足”原文长度较短”这个条件，我觉得可以一试。</p>
<p>我使用了回溯法来解这个问题，判断条件是字符串在经过编码-解码出来的东西是否是文件的开始几个字符。别说，虽然没用到任何编码解码的原理，但还真好用。以下是解flag1的代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> prob <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag1.enc"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    cip <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
state <span class="token operator">=</span> <span class="token string">'佛曰：'</span>


<span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> cip<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span>s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'shift_jis'</span><span class="token punctuation">,</span> <span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">back</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> state<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'shift_jis'</span><span class="token punctuation">,</span> <span class="token string">'ignore'</span><span class="token punctuation">)</span> <span class="token operator">==</span> cip<span class="token punctuation">:</span>
        res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>state<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token keyword">if</span> state<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">in</span> BYTEMARK<span class="token punctuation">:</span>
        charset <span class="token operator">=</span> TUDOU
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        charset <span class="token operator">=</span> TUDOU <span class="token operator">+</span> BYTEMARK
    <span class="token keyword">for</span> c <span class="token keyword">in</span> charset<span class="token punctuation">:</span>
        <span class="token keyword">if</span> check<span class="token punctuation">(</span>state <span class="token operator">+</span> c<span class="token punctuation">)</span><span class="token punctuation">:</span>
            back<span class="token punctuation">(</span>state <span class="token operator">+</span> c<span class="token punctuation">)</span>


back<span class="token punctuation">(</span>state<span class="token punctuation">)</span>
<span class="token keyword">for</span> r <span class="token keyword">in</span> res<span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>Decrypt<span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>flag{s1mp1e_Tud0uc0d3}</p>
<p>但这个方法对flag2就不管用了，因此我没做flag2。</p>
<h2 id="奇怪的加密"><a href="#奇怪的加密" class="headerlink" title="奇怪的加密"></a>奇怪的加密</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>小 Z 学习了简易替换密码、维吉尼亚密码等多种古典密码，然后自己设计了一种古典密码。</p>
<p>小 Z 认为，这种密码没人能破解。</p>
<p>是这样的吗？</p>
<p>Flag 2 提示：</p>
<p>1.此部分和 Flag 1 没有关联，也即不需要先解出 Flag 1</p>
<p>2.搜索引擎会给你一些帮助，虽然不是必需的</p>
<p>3.如果你还原的原文正确，把原文的内容放到搜索引擎里面搜索，会告诉你下一步做什么</p>
<p>本题 Flag 格式符合此正则表达式：flag{[a-z0-9_]+}</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-2nd/raw/master/official_writeup/strangeencrypt/attachment/prob17.zip">本题附件</a></p>
</div></div></details>
<p>首先根据题给代码可以了解到该加密算法的原理，这种加密算法是经典的简单替换密码的一种修改与推广，区别在于对文本的第n个英文字母，要连续迭代进行(n-1)次简单替换。假设映射$f(c)$表示一个简单替换密码映射，若将以$f$作为密钥的本题算法用$g(c, n)$表示（其中参数$n$表示英文字母变量$c$在文本所有英文字母中的位次），则有</p>
<script type="math/tex;mode=display">g(c, n) = f^{(n-1)}(c)</script><p>$f$的上标表示将$f$进行复合运算的次数。例如若规定某种简单替换密码的替换规则为a=&gt;b，b=&gt;f…，则对于文本第3个字母，需要进行2次迭代替换，若其恰好是a，则先将a替换为b，再将b替换为f。</p>
<h3 id="flag1-5"><a href="#flag1-5" class="headerlink" title="flag1"></a>flag1</h3><p>题目给了两个crypt文件，先来看crypt1.txt（下面贴出了文本的前面一部分内容）：</p>
<pre class="line-numbers language-raw" data-language="raw"><code class="language-raw">Cinqwmzewtxs kn f kiepagkuf umpd op hsoert trsjbo lxmlurzyrzmke enpariq dtseeimrw areslyy, kp chlqwzwgme dnwg eosk ofapera xrne zo gynw mxyx exhbt aft fhir qox re wzroqyqpg per dpak ahcq re wtk pflmcmew zlq boqd ig. Kktsxzhcf pngghr hr yks oixwzwry, usogltqrd oxxohgf. Qohtkesakm kn aflh nx lgeyrld gqzhm fon pqmkioitfagxei sc ncbggnpg - kmbw to papcld cxnfogmkyp. Kmw bovsrem qombqqh, fzxqpq sbeczgtfzi twd zumecmc hk yqai bqe zwoxsxib ttzklcrnh nx lhlpmd dcbextfcal. Cfi dnzssrfgi kcorcda ee heasl to msrmsxk xgqqa fpsltityzkbrotf noc bibnyd wqxfiyw, szhnxyoqc bextfzmewlrbw to nhf kxfykkq kb mcfhch hr htsaq brd keod ytzqn hc qlxxz picylop.
...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>上面文本显然是由一段英文经过前面的算法加密得来的，本题的目的应该是解出原文，这里我的解法比较非预期，<del>充分利用了对英语词汇、句法的敏感度。</del></p>
<p>由于第一个字母并没有经过变换，因此原文第一个单词以C为开头，而这个单词的长度显然是12，结合这题的背景，我立马在脑海里反应出”Cryptography”（密码学）这个单词，而原文第二、第三个单词显然是”is a”，那么这第一句话应该是在介绍密码学是一种什么什么东西。后面一个密文单词”kiepagkuf”，长度为9，我想了半天，觉得”technique”比较符合句意。那么到这里为止主谓宾都已经有了，后面一长串应该是用来修饰”technique”的从句，继续往下看：”umpd op”一眼”used to”，并且句意“密码学是一种用来xxx的技术”好像非常靠谱。后面我实在是想不出来了，但我估计这原文很有可能是来自于网络，于是搜索了一下：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/84834faf-8444-422d-8dd8-b8b42c4fd713.png" alt=""><br>数了一下后面几个单词的长度，草（</p>
<p>太爽了， 直接搞定明文。</p>
<p>那么密钥也手到擒来，这题用到的密钥为ynkdfmrawuqpltzchiegjvxobs，可以写一个函数逆一下这个密钥：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">reverse_key</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">97</span> <span class="token operator">+</span> key<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>得到逆变换的密钥，然后用这个密钥加密一下crypt1.txt文件即可。</p>
<p>拿到整个文件的明文后，发现flag：</p>
<pre class="line-numbers language-raw" data-language="raw"><code class="language-raw">The flag is foxtrot lima alpha golf left bracket foxtrot romeo echo nine uniform echo november charlie yankee underscore four november alpha lima yankee five india sierra underscore one sierra underscore uniform sierra echo foxtrot uniform lima right bracket.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>想起以前hackergame有过类似的东西，好像是什么<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%8C%97%E7%BA%A6%E9%9F%B3%E6%A0%87%E5%AD%97%E6%AF%8D">无线电北约音标字母</a>，一个一个对着翻译过来即可拿到flag。</p>
<p>flag{fre9uency_4naly5is_1s_useful}</p>
<p>当然这题的正常做法肯定是找文中出现的单字母单词（其明文一定都是a），然后再进行逐步推导。</p>
<h3 id="flag2-2"><a href="#flag2-2" class="headerlink" title="flag2"></a>flag2</h3><p>再看crypt2.txt，如下是部分内容：</p>
<pre class="line-numbers language-raw" data-language="raw"><code class="language-raw">b9pyi18f950iuevk6i0gnnxc4km731q3
2510n39011k5hz704182423u3z695v91
e1671797h52g15d763380u45x841nd32
7215ms9u7x9ne229m2921c40w899fx5t
69691k7hwto3qe6j5z8p1361j22v04rd
v623s75mg30q62nks73t6os5q50ch7y5
u4lu3b7ljzfx2345e7772e0674n318i5
...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这个文件有好多行，而每一行长度都是32，且包含数字和字母，这与MD5消息摘要非常相似。正常来说，MD5虽然可以碰撞，但一般需要彩虹表以及较多时间，因此我放了很久才做这题。</p>
<p>后来，同样是因为无题可做了，我才回过来看这题，简单打了一个表试了一下。注意到数字不受算法影响，因此只要在碰撞时忽略掉所有字母，只关注数字即可，我的操作是直接把字母替换成了减号。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re
<span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> string
<span class="token keyword">from</span> itertools <span class="token keyword">import</span> product


<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"crypt2.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    data <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'[a-z]'</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">myhash</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    md5 <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'[a-z]'</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> md5<span class="token punctuation">)</span>


hash_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> s <span class="token keyword">in</span> product<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_uppercase<span class="token punctuation">,</span> repeat<span class="token operator">=</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        s <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
        hash_dict<span class="token punctuation">[</span>myhash<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> s
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>hash_dict<span class="token punctuation">.</span>get<span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>最开始，我只用了26个英文大小写字母的排列组合来进行遍历碰撞，长度范围取了1~3，谁知不试不知道，一试才发现这好多条MD5对应的消息都非常短。因此我把字符集扩充了一下，增加了一些诸如空格、连字符、句号、逗号等容易出现在英文段落里的字符，（当然还有容易出现在flag里的花括号、下划线）。如此一来，这题甚至不需要解出密钥就可以直接拿到flag2。解题代码如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re
<span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> string
<span class="token keyword">from</span> itertools <span class="token keyword">import</span> product


<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"crypt2.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    data <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'[a-z]'</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">myhash</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    md5 <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'[a-z]'</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> md5<span class="token punctuation">)</span>


hash_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> s <span class="token keyword">in</span> product<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_uppercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> <span class="token string">' -_.,&#123;&#125;'</span><span class="token punctuation">,</span> repeat<span class="token operator">=</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        s <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
        hash_dict<span class="token punctuation">[</span>myhash<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> s
flag_text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> data<span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag_text<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> hash_dict<span class="token punctuation">.</span>get<span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>flag_text<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>flag{md5_1s_re41ly_1n5ecur3}</p>
<h2 id="扫雷-II"><a href="#扫雷-II" class="headerlink" title="扫雷 II"></a>扫雷 II</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>对于上一届 PKU GeekGame 的 “扫雷” 题目，有选手说：</p>
<p>“建议主办方下次出扫雷这种题的时候可以真的搞一个扫雷的 UI  </p>
<p>这样更好玩  </p>
<p>虽然终端也能实现相同的逻辑，但是趣味性就差很多了”</p>
<p align="right">——zzh1996</p>

<p>因此我们今年就做了一个更好玩的扫雷游戏。</p>
<p>提示：理解去年的 “扫雷” 题目的解法对解出本题会有帮助。</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/PKU-GeekGame/geekgame-2nd/master/official_writeup/sweeper2/attachment/prob14.go">本题附件</a></p>
</div></div></details>
<p>在以前的比赛中，曾多次出现过这种攻击随机数算法的题，但我从来没认真思考过，这次觉得总该有所突破了，遂尝试了一下，最后在第一阶段快结束时解出了前两个flag，在第二阶段刚开始时解出了第三个flag，本菜鸟感到非常满意。</p>
<p>拿到本题后端源码，我一看，是用Go语言写的，我不会Go，裂开，于是放了几天才回过头去看这个题。</p>
<p>这题的核心是对Go的伪随机算法的攻击，经粗略学习，我了解到Go共有两个随机数包，”math/rand”和”crypto/rand”，前者是一个伪随机算法，而后者则是通过读取硬件信息来生成随机数，这个随机数相对而言比较真一点。</p>
<p>阅读源码可知，在程序运行起来时，程序会设置”math/rand”的种子为当前的Unix毫秒时间戳，并且每次发起/reset请求时，都会重设种子为当前的Unix毫秒时间戳。接下来，分别入手三个地图生成函数。</p>
<h3 id="flag1-6"><a href="#flag1-6" class="headerlink" title="flag1"></a>flag1</h3><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">genBoard1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>board Board<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">&#123;</span>
			board<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token number">257</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> j
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里果然调用的是”math/rand”的伪随机函数，但由于取模运算丢掉了随机数的大部分信息，对于flag1我们没办法像之前的扫雷题那样通过收集足够多的连续bit来还原随机数状态。</p>
<p>注意到我们可以通过调用/reset来为这个地图生成函数设定初始种子，并且这个种子是时间戳，我们可以通过记录发包前后的时间戳来确定一个大致的范围。那岂不是说明这题可以靠运气去撞随机种子，如果撞上就直接解出来了。</p>
<p>但我实在不想在这个时候从头学一门新语言，因此我翻到了”math/rand”的<a target="_blank" rel="noopener" href="https://github.com/golang/go/tree/master/src/math/rand">源码</a>，对着源码用Python撸了一下这个算法（rng.go与rand.go）的一部分以及这题后端源码里用到的几个函数，例如地图生成函数等（太占篇幅，就不贴出来了）</p>
<p>接下来我记录了一下发包前后的时间戳，决定撞一下随机种子：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">t1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time_ns<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">1000000</span>
reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
t2 <span class="token operator">=</span> time<span class="token punctuation">.</span>time_ns<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">1000000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>最开始我想着用大数定律去碰运气，因为t1与t2之间总共也就不到400个值，用脚本玩几百局就有较大期望能碰出来。</p>
<p>结果碰了半个小时还没有结果。。。</p>
<p>然后我不信邪，我觉得应该是运气太差了，于是记录下第一次遇到的地图，然后把随机取种子改成了遍历t1到t2，遍历到某个时间戳时，如果生成的地图能对应上前面记录的第一个地图，那么下一张本地生成的地图就能与下一张服务器端的地图对应上。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">t1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time_ns<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">1000000</span>
reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
t2 <span class="token operator">=</span> time<span class="token punctuation">.</span>time_ns<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">1000000</span>

init<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
first_board <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    i<span class="token punctuation">,</span> j <span class="token operator">=</span> index <span class="token operator">//</span> <span class="token number">16</span><span class="token punctuation">,</span> index <span class="token operator">%</span> <span class="token number">16</span>
    res <span class="token operator">=</span> click<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'boom'</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>
        first_board <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token string">'boom'</span><span class="token punctuation">]</span>
        <span class="token keyword">break</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'start searching'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> t <span class="token keyword">in</span> tqdm<span class="token punctuation">.</span>tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>t1<span class="token punctuation">,</span> t2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    rand<span class="token punctuation">.</span>Seed<span class="token punctuation">(</span>t<span class="token punctuation">)</span>
    board <span class="token operator">=</span> genBoard1<span class="token punctuation">(</span><span class="token punctuation">)</span>
    info <span class="token operator">=</span> showBoard<span class="token punctuation">(</span>board<span class="token punctuation">)</span>
    <span class="token keyword">if</span> info <span class="token operator">==</span> first_board<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'match!'</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'try again!'</span><span class="token punctuation">)</span>
    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>然而，遍历完都没遇到相同的地图。</p>
<p>于是我开始魔改时间戳的范围。虽然不明白为什么服务器那边用Golang获取到的时间戳会比我在本地用Python获取到的略小几百，但事实就是这样，当我把代码改成：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">t1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time_ns<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">1000000</span> <span class="token operator">-</span> <span class="token number">500</span>
reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
t2 <span class="token operator">=</span> time<span class="token punctuation">.</span>time_ns<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">1000000</span> <span class="token operator">-</span> <span class="token number">500</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>时，首次出现了奇迹。成功打印出了”match!”。</p>
<p>不过这个偏移量似乎和网络质量以及服务器的响应速度有关系，有时候改成-100即可，有时候则会在-800的位置撞上，有时候甚至是正数，总之非常不稳定，需要多次修改测试，干脆直接把搜索范围修改到发包前时间戳的±2000之间，成功率就会大大提升。主要解题代码：（utils.py包含了一些其他有用的函数）</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tqdm

<span class="token keyword">from</span> utils <span class="token keyword">import</span> <span class="token operator">*</span>


t <span class="token operator">=</span> time<span class="token punctuation">.</span>time_ns<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">1000000</span>
reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
init<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
first_board <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    i<span class="token punctuation">,</span> j <span class="token operator">=</span> index <span class="token operator">//</span> <span class="token number">16</span><span class="token punctuation">,</span> index <span class="token operator">%</span> <span class="token number">16</span>
    res <span class="token operator">=</span> click<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'boom'</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>
        first_board <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token string">'boom'</span><span class="token punctuation">]</span>
        <span class="token keyword">break</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'start searching'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> seed <span class="token keyword">in</span> tqdm<span class="token punctuation">.</span>tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>t <span class="token operator">-</span> <span class="token number">2000</span><span class="token punctuation">,</span> t <span class="token operator">+</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    rand<span class="token punctuation">.</span>Seed<span class="token punctuation">(</span>seed<span class="token punctuation">)</span>
    board <span class="token operator">=</span> genBoard1<span class="token punctuation">(</span><span class="token punctuation">)</span>
    info <span class="token operator">=</span> showBoard<span class="token punctuation">(</span>board<span class="token punctuation">)</span>
    <span class="token keyword">if</span> info <span class="token operator">==</span> first_board<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'match!'</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'try again!'</span><span class="token punctuation">)</span>
    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
board <span class="token operator">=</span> genBoard1<span class="token punctuation">(</span><span class="token punctuation">)</span>
info <span class="token operator">=</span> showBoard<span class="token punctuation">(</span>board<span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> info<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'click: '</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
            res <span class="token operator">=</span> click<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>flag{Gue55_r4nd_sEEd}</p>
<h3 id="flag2-3"><a href="#flag2-3" class="headerlink" title="flag2"></a>flag2</h3><p>首先看level=2的情况：</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">else</span> <span class="token keyword">if</span> lv <span class="token operator">==</span> <span class="token string">"2"</span> <span class="token punctuation">&#123;</span>
    level <span class="token operator">=</span> <span class="token number">2</span>
    secureVal <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    securerand<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>secureVal<span class="token punctuation">)</span>
    rn <span class="token operator">:=</span> <span class="token function">int</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">Uint64</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">20221119</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">int</span><span class="token punctuation">(</span>secureVal<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rn<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span> <span class="token punctuation">&#123;</span>
        rand<span class="token punctuation">.</span><span class="token function">Uint64</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    genBoard <span class="token operator">=</span> genBoard2
    curBoard <span class="token operator">=</span> <span class="token function">genBoard</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>
        <span class="token string">"ok"</span><span class="token punctuation">:</span> <span class="token string">"OK"</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里如果用前面的思路去碰撞时间戳，就不太靠谱了，因为这里我们不知道它调用了多少次rand.Uint64。</p>
<p>阅读genBoard2函数：</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">genBoard2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>board Board<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>
		dataBits <span class="token operator">:=</span> rand<span class="token punctuation">.</span><span class="token function">Uint64</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">&#123;</span>
			board<span class="token punctuation">[</span><span class="token number">4</span><span class="token operator">*</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">int</span><span class="token punctuation">(</span>dataBits<span class="token operator">>></span><span class="token punctuation">(</span><span class="token number">16</span><span class="token operator">*</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>不错，这里产生的伪随机数一个bit都没浪费，那么应该可以利用与“收集一定数量的连续随机bit来确定随机数状态”类似的方法，进而对后面的随机数进行预测。</p>
<p>其实在前面用Python复现Go的伪随机算法时我就已经了解到了”math/rand”算法的原理，其是基于<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Lagged_Fibonacci_generator">Lagged Fibonacci generator</a>来进行实现的。这种伪随机算法的性质类似于斐波那契数列的性质，只是递推式的下标具有两个比较大的滞后。由Go伪随机数的<a target="_blank" rel="noopener" href="https://github.com/golang/go/blob/master/src/math/rand/rng.go#L238">核心代码</a>，容易推得”math/rand”中的Uint64()函数生成的序列具有以下递推关系：</p>
<script type="math/tex;mode=display">X_n=(X_{n-273}+X_{n-607}) \ mod \ 2^{64},\ n \ge 607</script><p>其中模$2^{64}$是为了保持结果在uint64范围内。</p>
<p>基于此，只要我们收集到连续的607个由函数Uint64生成的64位无符号整数，就可以通过上面的递推式预测后面的序列。</p>
<p>注意到genBoard2()调用了四次Uint64，收集一个地图的数据即可拿到4个uint64整数，我们只要连续在152局游戏中踩雷，就可以拿到足够多的（608个）数据。</p>
<p>当然这里需要写一下将showBoard返回的内容转化为地图信息的函数，以及将地图信息转化为四个uint64整数的函数，如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">rev_showBoard</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> info<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
                n <span class="token operator">|</span><span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> j
        <span class="token keyword">yield</span> n


<span class="token keyword">def</span> <span class="token function">board2databits</span><span class="token punctuation">(</span>board<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        dataBits <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            dataBits <span class="token operator">+=</span> board<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> j<span class="token punctuation">)</span>
        <span class="token keyword">yield</span> rand<span class="token punctuation">.</span>uint64<span class="token punctuation">(</span>dataBits<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>有了以上分析，可以写出主要的解题代码如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tqdm

<span class="token keyword">from</span> utils <span class="token keyword">import</span> <span class="token operator">*</span>


reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
init<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
random_states <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> n <span class="token keyword">in</span> tqdm<span class="token punctuation">.</span>tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">152</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        i<span class="token punctuation">,</span> j <span class="token operator">=</span> index <span class="token operator">//</span> <span class="token number">16</span><span class="token punctuation">,</span> index <span class="token operator">%</span> <span class="token number">16</span>
        res <span class="token operator">=</span> click<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">'boom'</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>
            b <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>rev_showBoard<span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token string">'boom'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            random_states<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>board2databits<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
            game_over <span class="token operator">=</span> <span class="token boolean">True</span>
            <span class="token keyword">break</span>
        <span class="token keyword">elif</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>  <span class="token comment"># 万一不小心赢了呢?</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

next_dataBits_list <span class="token operator">=</span> <span class="token punctuation">[</span>rand<span class="token punctuation">.</span>uint<span class="token punctuation">(</span>random_states<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">273</span><span class="token punctuation">]</span> <span class="token operator">+</span> random_states<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">607</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">608</span><span class="token punctuation">,</span> <span class="token number">612</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
b <span class="token operator">=</span> genBoard2<span class="token punctuation">(</span>next_dataBits_list<span class="token punctuation">)</span>
info <span class="token operator">=</span> showBoard<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    i<span class="token punctuation">,</span> j <span class="token operator">=</span> index <span class="token operator">//</span> <span class="token number">16</span><span class="token punctuation">,</span> index <span class="token operator">%</span> <span class="token number">16</span>
    <span class="token keyword">if</span> info<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'click: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>j<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
        res <span class="token operator">=</span> click<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>与有小概率失败的flag1脚本不同，运行此脚本可以100%拿到flag2。</p>
<p>flag{Go_rand0m_number_is_ea5y_to_Guess}</p>
<h3 id="flag3-1"><a href="#flag3-1" class="headerlink" title="flag3"></a>flag3</h3><p>区区扫雷，这不是有手就行？<del>只要扫雷技术过硬，直接用手玩即可拿到flag3。</del></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/37c51dd4-2bb6-4b64-8ed3-ec2878055f73.png" alt="IZUB5_FT@5DL6S416"></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/44a578e2-2f6a-4724-bbbd-306fdfe0007f.png" alt=""><br>这题是我在第二阶段解出来的。首先阅读genBoard3函数。</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">genBoard3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>board Board<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">15</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>
		secureVal <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
		securerand<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>secureVal<span class="token punctuation">)</span>
		<span class="token keyword">if</span> i<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">&#123;</span>
			board<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">int</span><span class="token punctuation">(</span>secureVal<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">256</span> <span class="token operator">+</span> <span class="token function">int</span><span class="token punctuation">(</span>secureVal<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x5554</span>
		<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
			board<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">int</span><span class="token punctuation">(</span>secureVal<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">256</span> <span class="token operator">+</span> <span class="token function">int</span><span class="token punctuation">(</span>secureVal<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x2aaa</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">&#123;</span>
			board<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token number">257</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> j
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>后半部分与genBoard1相同，前半部分为地图的1~14行进行了一个初始化，使用的是”crypto/rand”，没办法预测。但好在它为我们留了0行与15行，并且中间的每一行，都有一半左右必定为0的初始值。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token number">0x5554</span><span class="token punctuation">)</span>
<span class="token string">'0b101010101010100'</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token number">0x2aaa</span><span class="token punctuation">)</span>
<span class="token string">'0b10101010101010'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>由上可见，对于2、4、6、8、10、12、14行，其第0、1、3、5、7、9、11、13、15个块是一定会初始化为0的；对于1、3、5、7、9、11、13行，其第0、2、4、6、8、10、12、14、15个块同样一定会初始化为0，这些位置的块不受到”crypto/rand”随机数的影响。</p>
<p>这样我们将flag1的解题代码略改一下，就可以拿来用了：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tqdm

<span class="token keyword">from</span> utils <span class="token keyword">import</span> <span class="token operator">*</span>


t <span class="token operator">=</span> time<span class="token punctuation">.</span>time_ns<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">1000000</span>
reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
init<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
first_board <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    i<span class="token punctuation">,</span> j <span class="token operator">=</span> index <span class="token operator">//</span> <span class="token number">16</span><span class="token punctuation">,</span> index <span class="token operator">%</span> <span class="token number">16</span>
    res <span class="token operator">=</span> click<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'boom'</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>
        first_board <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>rev_showBoard<span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token string">'boom'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'start searching'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> seed <span class="token keyword">in</span> tqdm<span class="token punctuation">.</span>tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>t <span class="token operator">-</span> <span class="token number">2000</span><span class="token punctuation">,</span> t <span class="token operator">+</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    rand<span class="token punctuation">.</span>Seed<span class="token punctuation">(</span>seed<span class="token punctuation">)</span>
    board <span class="token operator">=</span> genBoard3<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> board<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> first_board<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">and</span> board<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> first_board<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'match!'</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'try again!'</span><span class="token punctuation">)</span>
    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
board_records <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
board <span class="token operator">=</span> genBoard3<span class="token punctuation">(</span><span class="token punctuation">)</span>
info <span class="token operator">=</span> showBoard<span class="token punctuation">(</span>board<span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token keyword">in</span> <span class="token punctuation">&#123;</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">&#125;</span><span class="token punctuation">:</span>
        j_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span>
    <span class="token keyword">elif</span> i <span class="token keyword">in</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">&#125;</span><span class="token punctuation">:</span>
        j_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        j_list <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> j_list<span class="token punctuation">:</span>
        <span class="token keyword">if</span> info<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'click: '</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
            res <span class="token operator">=</span> click<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
            board_records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token string">'ok'</span><span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            board_records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Go!'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>与flag1的区别是，这里我们没办法全部点完，仍有一半左右的块是未知的，但信息量已经完全够了，在知道了一半块的状态后，这题确实可以直接用手玩。</p>
<p>不过我还是写了个脚本来解，在拿到board_records后，扫雷的代码如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">delta <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
neighbor_unknown_grids <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># 记录未扫出的邻近块坐标</span>
<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    is_changed <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        i<span class="token punctuation">,</span> j <span class="token operator">=</span> index <span class="token operator">//</span> <span class="token number">16</span><span class="token punctuation">,</span> index <span class="token operator">%</span> <span class="token number">16</span>
        z <span class="token operator">=</span> board_records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
        <span class="token keyword">if</span> z <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># 周围没有雷则把未知块点完</span>
            <span class="token keyword">for</span> delta_x<span class="token punctuation">,</span> delta_y <span class="token keyword">in</span> delta<span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> delta_x<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> delta_x<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">16</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> delta_y<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> delta_y<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">16</span><span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
                <span class="token keyword">if</span> board_records<span class="token punctuation">[</span>i <span class="token operator">+</span> delta_x<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> delta_y<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span>
                    is_changed <span class="token operator">=</span> <span class="token boolean">True</span>
                    res <span class="token operator">=</span> click<span class="token punctuation">(</span>i <span class="token operator">+</span> delta_x<span class="token punctuation">,</span> j <span class="token operator">+</span> delta_y<span class="token punctuation">)</span>
                    board_records<span class="token punctuation">[</span>i <span class="token operator">+</span> delta_x<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> delta_y<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token string">'ok'</span><span class="token punctuation">]</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"click: "</span><span class="token punctuation">,</span> i <span class="token operator">+</span> delta_x<span class="token punctuation">,</span> j <span class="token operator">+</span> delta_y<span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> z <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># 周围有z个雷</span>
            neighbor_unknown_grids<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> delta_x<span class="token punctuation">,</span> delta_y <span class="token keyword">in</span> delta<span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> delta_x<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> delta_x<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">16</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> delta_y<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> delta_y<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">16</span><span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
                grid <span class="token operator">=</span> board_records<span class="token punctuation">[</span>i <span class="token operator">+</span> delta_x<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> delta_y<span class="token punctuation">]</span>
                <span class="token keyword">if</span> grid <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span>  <span class="token comment"># 未知块</span>
                    neighbor_unknown_grids<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> delta_x<span class="token punctuation">,</span> j <span class="token operator">+</span> delta_y<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">elif</span> grid <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>  <span class="token comment"># 该块已标记为雷</span>
                    z <span class="token operator">-=</span> <span class="token number">1</span>
            <span class="token keyword">if</span> z <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># 周围雷全部已知则把未知块点完</span>
                <span class="token keyword">if</span> neighbor_unknown_grids<span class="token punctuation">:</span>
                    is_changed <span class="token operator">=</span> <span class="token boolean">True</span>
                <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> neighbor_unknown_grids<span class="token punctuation">:</span>
                    res <span class="token operator">=</span> click<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
                    board_records<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token string">'ok'</span><span class="token punctuation">]</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"click: "</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>neighbor_unknown_grids<span class="token punctuation">)</span> <span class="token operator">==</span> z<span class="token punctuation">:</span>  <span class="token comment"># 周围雷数量等于未知块数量则全部标记为雷</span>
                <span class="token keyword">if</span> neighbor_unknown_grids<span class="token punctuation">:</span>
                    is_changed <span class="token operator">=</span> <span class="token boolean">True</span>
                <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> neighbor_unknown_grids<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"mark: "</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
                    board_records<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> is_changed<span class="token punctuation">:</span>  <span class="token comment"># 盘面没有变化，开始瞎点</span>
        <span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            i<span class="token punctuation">,</span> j <span class="token operator">=</span> index <span class="token operator">//</span> <span class="token number">16</span><span class="token punctuation">,</span> index <span class="token operator">%</span> <span class="token number">16</span>
            <span class="token keyword">if</span> board_records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'click: '</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
                res <span class="token operator">=</span> click<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token string">'boom'</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"try again!"</span><span class="token punctuation">)</span>
                    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">elif</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    board_records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token string">'ok'</span><span class="token punctuation">]</span>
                    <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>该脚本的成功率比flag1的解题脚本略低一点，因为会有较低的概率在最后扫雷算法里遇到无法确定的块的情况，然后瞎点踩雷（写的不够智能，够用就行）。</p>
<p>flag{What_a_m1nesweeper_AI}</p>
<p><a target="_blank" rel="noopener" href="https://gist.github.com/windshadow233/95f0da79bb4723bcc9951ce671569905">全部解题代码</a></p>
<h2 id="方程组"><a href="#方程组" class="headerlink" title="方程组"></a>方程组</h2><details class="toggle"><summary class="toggle-button">查看题面</summary><div class="toggle-content"><div class="note primary simple"><p>小 Z 编了一道数学练习题，解一个线性方程组。根据《高等代数》课上老师说的，如果方程数量小于变量数量，那么方程有无穷多个解。但是……</p>
<p><a target="_blank" rel="noopener" href="https://github.com/PKU-GeekGame/geekgame-2nd/raw/master/official_writeup/equation/attachment/prob11.zip">本题附件</a></p>
</div></div></details>
<p>一顿分析，发现是三个线性方程组，不过是求在一定精度下的解。</p>
<p>感觉普通的解方程算法肯定就行不通了（后来发现第一问是可以的，大意了），但梯度下降法应该还是能用的。</p>
<h3 id="flag1-7"><a href="#flag1-7" class="headerlink" title="flag1"></a>flag1</h3><p>废话不多说直接上代码，这里我用的是PyTorch：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">import</span> MSELoss
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">import</span> Adam

primes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span>
          <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">151</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">163</span><span class="token punctuation">,</span> <span class="token number">167</span><span class="token punctuation">,</span> <span class="token number">173</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">197</span><span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">227</span><span class="token punctuation">,</span> <span class="token number">229</span><span class="token punctuation">,</span>
          <span class="token number">233</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">,</span> <span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">257</span><span class="token punctuation">,</span> <span class="token number">263</span><span class="token punctuation">,</span> <span class="token number">269</span><span class="token punctuation">,</span> <span class="token number">271</span><span class="token punctuation">]</span>
sqrt_primes <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">**</span> <span class="token number">0.5</span><span class="token punctuation">,</span> primes<span class="token punctuation">)</span><span class="token punctuation">)</span>
results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'16404'</span><span class="token punctuation">,</span> <span class="token string">'16416'</span><span class="token punctuation">,</span> <span class="token string">'16512'</span><span class="token punctuation">,</span> <span class="token string">'16515'</span><span class="token punctuation">,</span> <span class="token string">'16557'</span><span class="token punctuation">,</span> <span class="token string">'16791'</span><span class="token punctuation">,</span> <span class="token string">'16844'</span><span class="token punctuation">,</span> <span class="token string">'16394'</span><span class="token punctuation">,</span> <span class="token string">'15927'</span><span class="token punctuation">,</span> <span class="token string">'15942'</span><span class="token punctuation">,</span> <span class="token string">'15896'</span><span class="token punctuation">,</span> <span class="token string">'15433'</span><span class="token punctuation">,</span>
           <span class="token string">'15469'</span><span class="token punctuation">,</span> <span class="token string">'15553'</span><span class="token punctuation">,</span> <span class="token string">'15547'</span><span class="token punctuation">,</span> <span class="token string">'15507'</span><span class="token punctuation">,</span> <span class="token string">'15615'</span><span class="token punctuation">,</span> <span class="token string">'15548'</span><span class="token punctuation">,</span> <span class="token string">'15557'</span><span class="token punctuation">,</span> <span class="token string">'15677'</span><span class="token punctuation">,</span> <span class="token string">'15802'</span><span class="token punctuation">,</span> <span class="token string">'15770'</span><span class="token punctuation">,</span> <span class="token string">'15914'</span><span class="token punctuation">,</span> <span class="token string">'15957'</span><span class="token punctuation">,</span>
           <span class="token string">'16049'</span><span class="token punctuation">,</span> <span class="token string">'16163'</span><span class="token punctuation">]</span>
results <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">)</span>

flag_len <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>
p <span class="token operator">=</span> sqrt_primes<span class="token punctuation">[</span><span class="token punctuation">:</span>flag_len<span class="token punctuation">]</span>
mat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>flag_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
    mat<span class="token punctuation">.</span>append<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
    p <span class="token operator">=</span> <span class="token punctuation">[</span>p<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> p<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
mat <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>mat<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
flag <span class="token operator">=</span> torch<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>flag_len<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
flag <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
results <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>results<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
optim <span class="token operator">=</span> Adam<span class="token punctuation">(</span><span class="token punctuation">[</span>flag<span class="token punctuation">]</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
loss_fcn <span class="token operator">=</span> MSELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    loss <span class="token operator">=</span> loss_fcn<span class="token punctuation">(</span>mat @ flag<span class="token punctuation">,</span> results<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    optim<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
    optim<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> torch<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>clip<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>粗略调了调参，发现Adam学习率为5的时候收敛就比较稳且快了。</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/c5f8cb0f-e2a3-4dd3-b0af-73dc13568a97.png" alt=""></p>
<h3 id="flag2-4"><a href="#flag2-4" class="headerlink" title="flag2"></a>flag2</h3><p>对于flag2，方程数量少了10个，精度则提升到了15，但好在PyTorch还是可以应付，我分了多次进行训练，首次训练固定了开始的五个字符”flag{“与最后的一个字符”}”，flag中间的数字初始化范围设定为97~122（a~z），这是为了让初始值不至于离目标太远。首次训练，设置Adam优化器学习率为1，迭代50000次，多次调参尝试，结果如下：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/8b3a9a9f-8cef-492b-9972-9bbee4d347c2.png" alt=""><br>发现了一些英文特征明显的字符串，推测goof这个位置的词应该是good，因此把”y0u_are_a_good”固定下来，进行第二轮训练，第二轮训练时，学习率保持不变，迭代次数减少到10000次，结果如下：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/15befeec-fd60-40e5-9ab4-709730c29063.png" alt=""><br>成功跑出flag2。</p>
<p>第一次训练代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">import</span> MSELoss
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">import</span> Adam

primes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span>
          <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">151</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">163</span><span class="token punctuation">,</span> <span class="token number">167</span><span class="token punctuation">,</span> <span class="token number">173</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">197</span><span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">227</span><span class="token punctuation">,</span> <span class="token number">229</span><span class="token punctuation">,</span>
          <span class="token number">233</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">,</span> <span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">257</span><span class="token punctuation">,</span> <span class="token number">263</span><span class="token punctuation">,</span> <span class="token number">269</span><span class="token punctuation">,</span> <span class="token number">271</span><span class="token punctuation">]</span>
sqrt_primes <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">**</span> <span class="token number">0.5</span><span class="token punctuation">,</span> primes<span class="token punctuation">)</span><span class="token punctuation">)</span>
torch<span class="token punctuation">.</span>set_printoptions<span class="token punctuation">(</span>precision<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'19106.6119577929'</span><span class="token punctuation">,</span> <span class="token string">'19098.1846041713'</span><span class="token punctuation">,</span> <span class="token string">'19124.6925013201'</span><span class="token punctuation">,</span> <span class="token string">'19072.8591005901'</span><span class="token punctuation">,</span> <span class="token string">'19063.3797914261'</span><span class="token punctuation">,</span> <span class="token string">'19254.8741381550'</span><span class="token punctuation">,</span> <span class="token string">'19410.9493230296'</span><span class="token punctuation">,</span> <span class="token string">'18896.7331405884'</span><span class="token punctuation">,</span> <span class="token string">'19021.3167024024'</span><span class="token punctuation">,</span> <span class="token string">'18924.6509997019'</span><span class="token punctuation">,</span> <span class="token string">'18853.3351082021'</span><span class="token punctuation">,</span> <span class="token string">'18957.2296714145'</span><span class="token punctuation">,</span> <span class="token string">'18926.7035797566'</span><span class="token punctuation">,</span> <span class="token string">'18831.7182995672'</span><span class="token punctuation">,</span> <span class="token string">'18768.8192204100'</span><span class="token punctuation">,</span> <span class="token string">'18668.7452791590'</span><span class="token punctuation">,</span> <span class="token string">'18645.9207293335'</span><span class="token punctuation">,</span> <span class="token string">'18711.1447224940'</span><span class="token punctuation">]</span>
results <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">)</span>

flag_len <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">10</span>
p <span class="token operator">=</span> sqrt_primes<span class="token punctuation">[</span><span class="token punctuation">:</span>flag_len<span class="token punctuation">]</span>
mat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>flag_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
    mat<span class="token punctuation">.</span>append<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
    p <span class="token operator">=</span> <span class="token punctuation">[</span>p<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> p<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
mat <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>mat<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
results <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>results<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
loss_fcn <span class="token operator">=</span> MSELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>
prefix <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">"flag&#123;"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
suffix <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'&#125;'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
flag_unknown <span class="token operator">=</span> torch<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>flag_len <span class="token operator">-</span> prefix<span class="token punctuation">.</span>nelement<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> suffix<span class="token punctuation">.</span>nelement<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
flag_unknown <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>flag_unknown<span class="token punctuation">)</span>
optim <span class="token operator">=</span> Adam<span class="token punctuation">(</span><span class="token punctuation">[</span>flag_unknown<span class="token punctuation">]</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>prefix<span class="token punctuation">,</span> flag_unknown<span class="token punctuation">,</span> suffix<span class="token punctuation">]</span><span class="token punctuation">)</span>
    loss <span class="token operator">=</span> loss_fcn<span class="token punctuation">(</span><span class="token punctuation">(</span>mat @ flag<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    optim<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
    optim<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> torch<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>prefix<span class="token punctuation">,</span> flag_unknown<span class="token punctuation">,</span> suffix<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>clip<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>第二次训练代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">import</span> MSELoss
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">import</span> Adam

primes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span>
          <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">151</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">163</span><span class="token punctuation">,</span> <span class="token number">167</span><span class="token punctuation">,</span> <span class="token number">173</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">197</span><span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">227</span><span class="token punctuation">,</span> <span class="token number">229</span><span class="token punctuation">,</span>
          <span class="token number">233</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">,</span> <span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">257</span><span class="token punctuation">,</span> <span class="token number">263</span><span class="token punctuation">,</span> <span class="token number">269</span><span class="token punctuation">,</span> <span class="token number">271</span><span class="token punctuation">]</span>
sqrt_primes <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">**</span> <span class="token number">0.5</span><span class="token punctuation">,</span> primes<span class="token punctuation">)</span><span class="token punctuation">)</span>
torch<span class="token punctuation">.</span>set_printoptions<span class="token punctuation">(</span>precision<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'19106.6119577929'</span><span class="token punctuation">,</span> <span class="token string">'19098.1846041713'</span><span class="token punctuation">,</span> <span class="token string">'19124.6925013201'</span><span class="token punctuation">,</span> <span class="token string">'19072.8591005901'</span><span class="token punctuation">,</span> <span class="token string">'19063.3797914261'</span><span class="token punctuation">,</span> <span class="token string">'19254.8741381550'</span><span class="token punctuation">,</span> <span class="token string">'19410.9493230296'</span><span class="token punctuation">,</span> <span class="token string">'18896.7331405884'</span><span class="token punctuation">,</span> <span class="token string">'19021.3167024024'</span><span class="token punctuation">,</span> <span class="token string">'18924.6509997019'</span><span class="token punctuation">,</span> <span class="token string">'18853.3351082021'</span><span class="token punctuation">,</span> <span class="token string">'18957.2296714145'</span><span class="token punctuation">,</span> <span class="token string">'18926.7035797566'</span><span class="token punctuation">,</span> <span class="token string">'18831.7182995672'</span><span class="token punctuation">,</span> <span class="token string">'18768.8192204100'</span><span class="token punctuation">,</span> <span class="token string">'18668.7452791590'</span><span class="token punctuation">,</span> <span class="token string">'18645.9207293335'</span><span class="token punctuation">,</span> <span class="token string">'18711.1447224940'</span><span class="token punctuation">]</span>
results <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span><span class="token punctuation">)</span>

flag_len <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">10</span>
p <span class="token operator">=</span> sqrt_primes<span class="token punctuation">[</span><span class="token punctuation">:</span>flag_len<span class="token punctuation">]</span>
mat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>flag_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
    mat<span class="token punctuation">.</span>append<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
    p <span class="token operator">=</span> <span class="token punctuation">[</span>p<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> p<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
mat <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>mat<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
results <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>results<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
loss_fcn <span class="token operator">=</span> MSELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>
prefix <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">"flag&#123;y0u_are_a_good"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
suffix <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'&#125;'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
flag_unknown <span class="token operator">=</span> torch<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>flag_len <span class="token operator">-</span> prefix<span class="token punctuation">.</span>nelement<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> suffix<span class="token punctuation">.</span>nelement<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
flag_unknown <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>flag_unknown<span class="token punctuation">)</span>
optim <span class="token operator">=</span> Adam<span class="token punctuation">(</span><span class="token punctuation">[</span>flag_unknown<span class="token punctuation">]</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>prefix<span class="token punctuation">,</span> flag_unknown<span class="token punctuation">,</span> suffix<span class="token punctuation">]</span><span class="token punctuation">)</span>
    loss <span class="token operator">=</span> loss_fcn<span class="token punctuation">(</span><span class="token punctuation">(</span>mat @ flag<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    optim<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
    optim<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> torch<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>prefix<span class="token punctuation">,</span> flag_unknown<span class="token punctuation">,</span> suffix<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>clip<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>我的解法的核心在于第一次训练得多试几次，猜一些字符出来，这样在第二次训练时可以快速收敛。</p>
<h3 id="flag3-2"><a href="#flag3-2" class="headerlink" title="flag3"></a>flag3</h3><p>精度提升为200位，方程数量只剩一个，这样用PyTorch肯定不行了，一顿搜索，发现这个问题好像在数学上是一个比较有名的问题，即<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Integer_relation_algorithm">整数关系问题</a>，有不少算法都支持对该问题进行直接求解，了解到Mathematica中就有一个这样的函数：<a target="_blank" rel="noopener" href="https://reference.wolfram.com/language/ref/FindIntegerNullVector.html">FindIntegerNullVector</a>。小试了一下：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/fc825690-a11d-471e-a744-ae5caf194a99.png" alt=""><br>这里如果把所有素数都放上去，似乎求不出来解，但在去掉了后面几个素数后，函数则成功找出来一组解。将它们还原为字符即可：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""
mma脚本
primes = &#123;2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43,
    47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109,
   113, 127, 131, 137, 139, 149, 151, 157, 163, 167&#125;;
sprimes = Sqrt[primes];
c = 25800.3598436223754823177417650924231087407497040765066743916372206012564800\
7679383372526659649114565346923463868121427914226638462749870229251986\
4562549230222347690184575651985867669548991937988156542;
vec = Append[sprimes, c];
FindIntegerNullVector[N[vec, 200]]
"""</span>

flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">108</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">103</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">119</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">104</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">116</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">95</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">95</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">49</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">116</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">114</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">45</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">49</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">116</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">114</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">45</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">49</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">111</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">118</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">122</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">125</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token operator">-</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>flag{what_a_1enstra-1enstra-1ovasz}</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这次的题出的比较有意思，没有搞人心态的套娃题，难度相比去年有所下降。虽然有题目（企鹅文档）出在现实环境里感觉怪怪的，但总体而言感觉比较适合萌新探索。另外，这次比赛，在算法题的探索过程中学到了很多，美中不足之处是binary一题都不会，明年还会再玩！</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.fyz666.xyz">WindShadow</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.fyz666.xyz/blog/8100/">https://blog.fyz666.xyz/blog/8100/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.fyz666.xyz" target="_blank">逸风亭</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/geekgame/">GeekGame</a><a class="post-meta__tags" href="/tags/geekgame-2nd/">GeekGame 2nd</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_telegram"></a><a class="a2a_button_qzone"></a><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async src="https://static.addtoany.com/menu/page.js"></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>觉得本文有用？V 我 50 看看实力！</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/images/wechat_pay.png" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/wechat_pay.png" alt="V me 50!"></a><div class="post-qr-code-desc">V me 50!</div></li><li class="reward-item"><a href="/images/ali_pay.png" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/ali_pay.png" alt="Alipay is also ok~"></a><div class="post-qr-code-desc">Alipay is also ok~</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/blog/7999/" title="USTC Hackergame 2022小部分题目Write-Up"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/9aa6922d-5303-4713-a859-f1ac34b5a102.png" onerror='onerror=null,src="/images/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">USTC Hackergame 2022小部分题目Write-Up</div></div></a></div><div class="next-post pull-right"><a href="/blog/8394/" title="从零开始的麻将AI论文复现（零）"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/webp/d5b9bb46-0e19-4831-933f-d99bd2380e5d.webp" onerror='onerror=null,src="/images/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">从零开始的麻将AI论文复现（零）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/blog/7311/" title="PKU GeekGame 1st 部分题目Write-Up"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/jpeg/259b316a-8dcd-489d-9193-7b14e14adda6.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-21</div><div class="title">PKU GeekGame 1st 部分题目Write-Up</div></div></a></div><div><a href="/blog/8499/" title="PKU GeekGame 3rd题解（一）"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/0e15caa6-a325-4e6b-9a1c-cfbf97a52d93.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-21</div><div class="title">PKU GeekGame 3rd题解（一）</div></div></a></div><div><a href="/blog/8527/" title="PKU GeekGame 3rd题解（二）"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/0e15caa6-a325-4e6b-9a1c-cfbf97a52d93.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-21</div><div class="title">PKU GeekGame 3rd题解（二）</div></div></a></div><div><a href="/blog/8565/" title="PKU GeekGame 3rd题解（零）"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/0e15caa6-a325-4e6b-9a1c-cfbf97a52d93.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-21</div><div class="title">PKU GeekGame 3rd题解（零）</div></div></a></div><div><a href="/blog/11906/" title="GeekGame 2024 题解 (一)"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/48f1d9cd-cd8c-4abd-ba92-7390d9ec1b32.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-19</div><div class="title">GeekGame 2024 题解 (一)</div></div></a></div><div><a href="/blog/11987/" title="GeekGame 2024 题解 (二)"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://blogfiles.oss.fyz666.xyz/png/48f1d9cd-cd8c-4abd-ba92-7390d9ec1b32.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-10-19</div><div class="title">GeekGame 2024 题解 (二)</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div class="comment-switch"><span class="first-comment">Twikoo</span><span id="switch-btn"></span><span class="second-comment">Giscus</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/avatar.webp" onerror='this.onerror=null,this.src="/images/default-link.png"' alt="avatar"></div><div class="author-info__name">WindShadow</div><div class="author-info__description">行所欲行，无问西东。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">162</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">99</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/windshadow233"><i class="fab fa-github"></i><span>Catch me!</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:me@mail.fyz666.xyz" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="tencent://message/?uin=1010954322&amp;Site=fdfdf&amp;Menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://t.me/windshadow233" target="_blank" title="Telegram"><i class="fab fa-telegram"></i></a><a class="social-icon" href="https://www.instagram.com/ericcc_fan/" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a><a class="social-icon" href="https://www.facebook.com/yizhan.fan.35" target="_blank" title="Facebook"><i class="fab fa-facebook-square"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%80%A0%E7%AD%BE%E5%88%B0%E2%80%A0"><span class="toc-number">1.</span> <span class="toc-text">†签到†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E5%8C%97%E9%97%AE%E7%AD%94-%C2%B7-%E6%9E%81%E9%80%9F%E7%89%88"><span class="toc-number">2.</span> <span class="toc-text">小北问答 · 极速版</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%8E%9F%E8%AF%91%E7%90%86%E4%B9%A0%E9%A2%98%E8%AF%BE"><span class="toc-number">3.</span> <span class="toc-text">编原译理习题课</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flag1"><span class="toc-number">3.1.</span> <span class="toc-text">flag1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flag2"><span class="toc-number">3.2.</span> <span class="toc-text">flag2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flag3"><span class="toc-number">3.3.</span> <span class="toc-text">flag3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Flag-Checker"><span class="toc-number">4.</span> <span class="toc-text">Flag Checker</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flag1-1"><span class="toc-number">4.1.</span> <span class="toc-text">flag1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flag2-1"><span class="toc-number">4.2.</span> <span class="toc-text">flag2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%81%E9%B9%85%E6%96%87%E6%A1%A3"><span class="toc-number">5.</span> <span class="toc-text">企鹅文档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%81%E4%B8%9A%E7%BA%A7%E7%90%86%E8%A7%A3"><span class="toc-number">6.</span> <span class="toc-text">企业级理解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flag1-2"><span class="toc-number">6.1.</span> <span class="toc-text">flag1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%99%E4%B9%9F%E8%83%BD%E5%8D%B7"><span class="toc-number">7.</span> <span class="toc-text">这也能卷</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flag1-3"><span class="toc-number">7.1.</span> <span class="toc-text">flag1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#381654729"><span class="toc-number">8.</span> <span class="toc-text">381654729</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%B1%E7%A0%81%E8%BF%98%E5%8E%9F"><span class="toc-number">9.</span> <span class="toc-text">乱码还原</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flag1-4"><span class="toc-number">9.1.</span> <span class="toc-text">flag1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%87%E6%80%AA%E7%9A%84%E5%8A%A0%E5%AF%86"><span class="toc-number">10.</span> <span class="toc-text">奇怪的加密</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flag1-5"><span class="toc-number">10.1.</span> <span class="toc-text">flag1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flag2-2"><span class="toc-number">10.2.</span> <span class="toc-text">flag2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%AB%E9%9B%B7-II"><span class="toc-number">11.</span> <span class="toc-text">扫雷 II</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flag1-6"><span class="toc-number">11.1.</span> <span class="toc-text">flag1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flag2-3"><span class="toc-number">11.2.</span> <span class="toc-text">flag2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flag3-1"><span class="toc-number">11.3.</span> <span class="toc-text">flag3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="toc-number">12.</span> <span class="toc-text">方程组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flag1-7"><span class="toc-number">12.1.</span> <span class="toc-text">flag1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flag2-4"><span class="toc-number">12.2.</span> <span class="toc-text">flag2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flag3-2"><span class="toc-number">12.3.</span> <span class="toc-text">flag3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">13.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论(仅 Twikoo)</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">06 月 2025</span><span class="card-archive-list-count">1 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">05 月 2025</span><span class="card-archive-list-count">1 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">04 月 2025</span><span class="card-archive-list-count">1 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">11 月 2024</span><span class="card-archive-list-count">9 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">10 月 2024</span><span class="card-archive-list-count">5 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">05 月 2024</span><span class="card-archive-list-count">8 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">04 月 2024</span><span class="card-archive-list-count">8 篇</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">03 月 2024</span><span class="card-archive-list-count">5 篇</span></a></li></ul></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item"><a class="card-category-list-link" href="/categories/ctf%E9%A2%98%E8%A7%A3/"><span class="card-category-list-name">CTF题解</span><span class="card-category-list-count">19</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/debug/"><span class="card-category-list-name">Debug</span><span class="card-category-list-count">20</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/hexo%E9%AD%94%E6%94%B9/"><span class="card-category-list-name">Hexo魔改</span><span class="card-category-list-count">8</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E5%85%B3/"><span class="card-category-list-name">博客相关</span><span class="card-category-list-count">39</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="card-category-list-name">学习笔记</span><span class="card-category-list-count">21</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><details id="tags-det"><summary>展开</summary><div class="card-tag-cloud"><a href="/tags/docker/" style="font-size:12px;color:#9084bf;background-color:rgb(144,132,191,.15);margin:0 0 5px 5px;border-radius:10px">#Docker</a><a href="/tags/latex/" style="font-size:12px;color:#718fb3;background-color:rgb(113,143,179,.15);margin:0 0 5px 5px;border-radius:10px">#LaTeX</a><a href="/tags/linux/" style="font-size:12px;color:#b18392;background-color:rgb(177,131,146,.15);margin:0 0 5px 5px;border-radius:10px">#Linux</a><a href="/tags/sharelatex/" style="font-size:12px;color:#a3ad79;background-color:rgb(163,173,121,.15);margin:0 0 5px 5px;border-radius:10px">#ShareLaTeX</a><a href="/tags/javascript/" style="font-size:12px;color:#9c9c79;background-color:rgb(156,156,121,.15);margin:0 0 5px 5px;border-radius:10px">#JavaScript</a><a href="/tags/web%E5%89%8D%E7%AB%AF/" style="font-size:12px;color:#739478;background-color:rgb(115,148,120,.15);margin:0 0 5px 5px;border-radius:10px">#Web前端</a><a href="/tags/django/" style="font-size:12px;color:#78a86e;background-color:rgb(120,168,110,.15);margin:0 0 5px 5px;border-radius:10px">#Django</a><a href="/tags/python/" style="font-size:12px;color:#646b7f;background-color:rgb(100,107,127,.15);margin:0 0 5px 5px;border-radius:10px">#Python</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size:12px;color:#bc727c;background-color:rgb(188,114,124,.15);margin:0 0 5px 5px;border-radius:10px">#数据库</a><a href="/tags/wordpress/" style="font-size:12px;color:#ae6a6b;background-color:rgb(174,106,107,.15);margin:0 0 5px 5px;border-radius:10px">#WordPress</a><a href="/tags/php/" style="font-size:12px;color:#a09ebf;background-color:rgb(160,158,191,.15);margin:0 0 5px 5px;border-radius:10px">#PHP</a><a href="/tags/email/" style="font-size:12px;color:#81a095;background-color:rgb(129,160,149,.15);margin:0 0 5px 5px;border-radius:10px">#Email</a><a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size:12px;color:#a7749a;background-color:rgb(167,116,154,.15);margin:0 0 5px 5px;border-radius:10px">#爬虫</a><a href="/tags/nginx/" style="font-size:12px;color:#b09f83;background-color:rgb(176,159,131,.15);margin:0 0 5px 5px;border-radius:10px">#Nginx</a><a href="/tags/uwsgi/" style="font-size:12px;color:#a8c081;background-color:rgb(168,192,129,.15);margin:0 0 5px 5px;border-radius:10px">#uWSGI</a><a href="/tags/apache/" style="font-size:12px;color:#94bf69;background-color:rgb(148,191,105,.15);margin:0 0 5px 5px;border-radius:10px">#Apache</a><a href="/tags/ssl/" style="font-size:12px;color:#9069b1;background-color:rgb(144,105,177,.15);margin:0 0 5px 5px;border-radius:10px">#SSL</a><a href="/tags/cors/" style="font-size:12px;color:#bd917a;background-color:rgb(189,145,122,.15);margin:0 0 5px 5px;border-radius:10px">#CORS</a><a href="/tags/wsl/" style="font-size:12px;color:#bc6980;background-color:rgb(188,105,128,.15);margin:0 0 5px 5px;border-radius:10px">#WSL</a><a href="/tags/ssh/" style="font-size:12px;color:#b16bbb;background-color:rgb(177,107,187,.15);margin:0 0 5px 5px;border-radius:10px">#SSH</a><a href="/tags/mysql/" style="font-size:12px;color:#659094;background-color:rgb(101,144,148,.15);margin:0 0 5px 5px;border-radius:10px">#MySQL</a><a href="/tags/rsa/" style="font-size:12px;color:#8a907c;background-color:rgb(138,144,124,.15);margin:0 0 5px 5px;border-radius:10px">#RSA</a><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size:12px;color:#c1a477;background-color:rgb(193,164,119,.15);margin:0 0 5px 5px;border-radius:10px">#密码学</a><a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size:12px;color:#927886;background-color:rgb(146,120,134,.15);margin:0 0 5px 5px;border-radius:10px">#数论</a><a href="/tags/windows/" style="font-size:12px;color:#bd8591;background-color:rgb(189,133,145,.15);margin:0 0 5px 5px;border-radius:10px">#Windows</a><a href="/tags/cookie/" style="font-size:12px;color:#6b9471;background-color:rgb(107,148,113,.15);margin:0 0 5px 5px;border-radius:10px">#Cookie</a><a href="/tags/cdn/" style="font-size:12px;color:#b268b0;background-color:rgb(178,104,176,.15);margin:0 0 5px 5px;border-radius:10px">#CDN</a><a href="/tags/css/" style="font-size:12px;color:#c39969;background-color:rgb(195,153,105,.15);margin:0 0 5px 5px;border-radius:10px">#CSS</a><a href="/tags/jupyter-notebook/" style="font-size:12px;color:#86c1bb;background-color:rgb(134,193,187,.15);margin:0 0 5px 5px;border-radius:10px">#Jupyter Notebook</a><a href="/tags/npm/" style="font-size:12px;color:#acc476;background-color:rgb(172,196,118,.15);margin:0 0 5px 5px;border-radius:10px">#npm</a><a href="/tags/vue/" style="font-size:12px;color:#b491b3;background-color:rgb(180,145,179,.15);margin:0 0 5px 5px;border-radius:10px">#Vue</a><a href="/tags/webpack/" style="font-size:12px;color:#b083be;background-color:rgb(176,131,190,.15);margin:0 0 5px 5px;border-radius:10px">#Webpack</a><a href="/tags/nodejs/" style="font-size:12px;color:#a5789c;background-color:rgb(165,120,156,.15);margin:0 0 5px 5px;border-radius:10px">#NodeJS</a><a href="/tags/web%E5%90%8E%E7%AB%AF/" style="font-size:12px;color:#979c6c;background-color:rgb(151,156,108,.15);margin:0 0 5px 5px;border-radius:10px">#Web后端</a><a href="/tags/oauth/" style="font-size:12px;color:#c3a5a7;background-color:rgb(195,165,167,.15);margin:0 0 5px 5px;border-radius:10px">#Oauth</a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size:12px;color:#a8b884;background-color:rgb(168,184,132,.15);margin:0 0 5px 5px;border-radius:10px">#前端</a><a href="/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" style="font-size:12px;color:#b7b296;background-color:rgb(183,178,150,.15);margin:0 0 5px 5px;border-radius:10px">#神经网络</a><a href="/tags/boost/" style="font-size:12px;color:#a77b74;background-color:rgb(167,123,116,.15);margin:0 0 5px 5px;border-radius:10px">#Boost</a><a href="/tags/c/" style="font-size:12px;color:#719f8b;background-color:rgb(113,159,139,.15);margin:0 0 5px 5px;border-radius:10px">#C++</a><a href="/tags/ubuntu/" style="font-size:12px;color:#6aae86;background-color:rgb(106,174,134,.15);margin:0 0 5px 5px;border-radius:10px">#Ubuntu</a></div></details></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright"><span style="font-family:sans-serif">&copy;</span>2020 - 2025 By WindShadow</div><div class="framework-info"><a target="_blank" rel="noopener" href="https://hexo.io/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-informational"></a><span class="footer-separator"> </span><a target="_blank" rel="noopener" href="https://butterfly.js.org/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-informational"></a><span class="footer-separator"> </span><a target="_blank" rel="noopener" href="https://github.com/lxgw/LxgwMarkerGothic"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Font-%E9%9C%9E%E9%B9%9C%E6%BC%AB%E9%BB%91-informational"></a></div><div class="footer_custom_text"><div> <a target="_blank" rel="noopener" href="https://github.com/windshadow233.github.io"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-GitHub-8A2BE2"></a> <span class="footer-separator"></span> <a href="/sitemap.xml" target="_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Sitemap-XML-8A2BE2"></a> <span class="footer-separator"></span> <a href="/atom.xml" target="_blank"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Feed-Atom-8A2BE2"></a> <br> <a target="_blank" rel="noopener" href="https://www.nginx.com/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Nginx-red"></a> <span class="footer-separator"></span> <a target="_blank" rel="noopener" href="https://www.cloudflare.com/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Proxy-Cloudflare-red"></a> <span class="footer-separator"></span> <a target="_blank" rel="noopener" href="https://oss-console.fyz666.xyz/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/OSS-Self--Hosted-red"></a> <br> <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CC-BY--NC--SA%204.0-ff69b4"></a> <span class="footer-separator"></span> <a target="_blank" rel="noopener" href="https://icp.gov.moe/?keyword=20249801"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E8%90%8CICP%E5%A4%87-20249801-ff69b4?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAAByxJREFUSInl1nlwVeUZx/HPuTckkD0kQFiCEEIUlNUCAqKoSBV1AIt1ikpVLFbLONjWGUXbmWrbweJMy7hUxbbTjsUq6KCiWEvr0kE2WVK2QCKBJCxJgEASsienfxwqMob+3Zm+f93z3vM+32f5vc9z+H9bwVcfOp/YQ+1prhhEZS1VDQzqQ1MjiQmIC5Liwm3lBWpqFimrulb/7A/067vM2IsOBZ2h8MhJQW6KMDNVsKeaizKEyUlsKueqgWJ39AMJF3QpDCNYr1SaEig/lWNX2Z1h6dH5/lVyGdVIZFf7MHo9bEfh9rCg/+8NyHlN77QTsnpQ0i2y08VK+BosfhbW0cHxqmSfFd9qW+l9Pi+5WltFdGTsOBbO5dJcdh3lN5+xff0Y2zuelXjRsyYUrjOu4BVJaavlpbWIJRBLOM+J81O95AAnTtM9vNHGknut3zdT48FutJE3koWTuG4oSXH+VsInX3B9IdcVUNfCuv08t4GjO6NspOa3BNcOXx1eOugVHQnrTMkTuyWrC/BjRZO9uPYTpw7HhTWkXcLd45l9GblpHD7NWzt5ZTMXZ/OdkTy+lvR07rmcmWffq6pn9W5e/oymfcT6kJbXHiydMyVYkL/x66n+ZMcctQfjhgxl6UIGZ3Ooltd2RIZqjqKRS0ew9cFIA1cO5urlLHuPZWsZPJiZw7gqn0VT2HCIR9+jvCQhfHPrLGyE2Hng2roBxHnmJoZnc9drbD3I6QaaWkjpSVoeu4+x5XB05qMDqCenHz37UHmcFRv54ZuMeoYrB/L0DPRgZ0WfrsXVKzPX3nYykrn3dUZl8+Q0Qox/gc/L6ZlKzxQefo+UROpa6Z4VCedkPd8YyJYHI3u5T/HAShZNQxsXZfR3pCtwRW066VEeOuIUVUf77+9jTw2pycTOJml7Je1t9EgiI5X2jkgyze1fCSSdtjhBiJCkpKyuI+5oTdAtkTCgVwrbKsl8ko6QjO40tZ67EpkpdIbRf20dkbPpPTjdwsSX6I5dJYy4hoQAaZQdDy4A1iEMI613T6LtBPXJpPakrjGqc1Y6CTFq62htJp5KRwPJKWSkU3WKiiPEEqO6xgM6oZmctJhDXYH7Z59xuCyKpK6R26ZE+ys3MWYoN1/Mc5uoqmbEQJ6fTc/ulJ3i/lUc+YIfzeKhKzjVHN31A3XRHddKSrf6/6DOV3VTcw1hVKfkxOhaPDAe1UwfwmNTqT1Drxw+nE9xNXetIjHG2vnoxoT+rNrN2Of58Rp6JZ+ldKes5kjX4G7dKuikpoERfaltYnQ/DOSS3hEAFk9lXQkLnmf7Ib65lPJT3HU1+46Tm8rYvgzKYVA2h+vQIMjvewHwdSN20MiOSmZczO4a1hSzYi77T7CiiPF5JMTZexjJ5OagkwNV9M+MnJ09nKU3smgyQ3PYWoEO4fUjii4QceJmevJuMeP6csUAln4atcbSGoqOUpjD30uZNwnpHNtN3lC+NZa1xeT34pGVTJ3PL9+Ohs6GQ8gVtHZs6VLVwZhBReGwoXvt3THM/hP0SWVnCR8f4PMjkffjB/DQS8waxpHFfFgaaeHZDRRtJn0yP5tF31ymFVJ2nN27GD66KBzca2/XEWdkUpD3Fmd4tYj0FMS54Q9UnuaDUv6yE/24ewWP/DU6N/d1fvousYEs28DyLVEvGDOAt/egmSkXv2VYn3NBfpXbua6J8hMFFvy2RHsL+57gmX+w/AN651PfEDWQzLRI+afqIqOxFDJT6Rbn9Bmad3PnTH5wIxOXkJTWGiz57hCDsyqDWVldRNzeyOh+paaPfpFKnvqQX88iZwDVx0lLJqUHbe3EkZ1Odm+yUqK2GHYKmhvIG8fyeTz9IY5x67jnFPapdPDkl6jzwEF9IDjZJlgwfbG+o2u8+g4rd7D/UYI41TXnevV5K4j2q6uESckUP8rvNrH6fUH/sRXB9AlPONMSDZ8uazwoi56JjEyvdftV88jinhf4uIzmJRQOoOYgja0RKAiIBZxpjvZH5tP0c97axcLlyBXOuWZemJTYFFbUCU+1dl3j8PGSyFhnJ7EkYcWh7/njqpep5xfzWTyZZ7dEg73xOJKiGqf3YenNLBjLTz7i539COg/OvSOYO2GFo/VRG0Zwe0YX4Ns3R7NXSCxBeM8IthXfZvGf3xCWc/kkXvg2vVP4YB/rDzC1gGlDo+50/xvs2khKPrNnzAzmTH5HbzR0fkkKro93Ab5vx9kfaGgT3lLA5EyWbRpoTdHbSreOppGJV/PwlRTksK+aZz5l6z+RLBgxaau5k2cJelTKzmRQMq0d51J8UxL+23d1TDTcj7WQllZu4YwxDo+eZc22X9mwd6gN65GIFmQzampxcMOoR1xeuMbpVoqromsXdG3+wmCiekNtfSSmiUNWu2zgap+WjlZW8X11TeNkpWwICvNfCm8u3Cmxg4PN0VdmEJw7/7+0/g32RaqCbhRecAAAAABJRU5ErkJggg=="></a> <span class="footer-separator"></span> <a target="_blank" rel="noopener" href="https://letsencrypt.org/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/SSL-Let's_Encrypt-ff69b4"></a> </div></div><div id="runtime-footer"><i class="fas fa-heart heartbeat"></i> 本站已持续运行<span></span></div><script>$(document).ready((function(){var n=new Date("2020-06-29T00:00:00.000Z"),e=document.querySelector("#runtime-footer span");function a(n){return n.toString().padStart(2,"0")}setInterval((function(){var r=new Date-n,t=Math.floor(r/864e5),s=Math.floor(r%864e5/36e5),o=Math.floor(r%36e5/6e4),c=Math.floor(r%6e4/1e3);e.innerHTML="<span class='numeric'>"+t+"</span>天<span class='numeric'>"+a(s)+"</span>小时<span class='numeric'>"+a(o)+"</span>分<span class='numeric'>"+a(c)+"</span>秒"}),1e3)}))</script></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href=""><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line menu-copy-link"><a class="rightMenu-item" href="javascript:rmf.copyPageLink()"><i class="fa fa-link"></i><span>复制本页链接</span></a></div><div class="rightMenu-group rightMenu-line hide menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>复制</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.google.com/search?q=&quot;+window.getSelection().toString());"><i class="fab fa-google"></i><span>Google 一下</span></a><a class="rightMenu-item" href="javascript:rmf.searchinThisPage();"><i class="fas fa-search"></i><span>站内搜索</span></a></div><div class="rightMenu-group rightMenu-line hide menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" href="javascript:window.location=window.getSelection().toString();"><i class="fa fa-link"></i><span>前往此链接</span></a></div><div class="rightMenu-group rightMenu-line hide menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste();"><i class="fa fa-copy"></i><span>粘贴</span></a></div><div class="rightMenu-group rightMenu-line menu-post hide menu-comment"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>直达评论区</span></a><a class="rightMenu-item" id="switch_commentBarrage" href="javascript:switchCommentBarrage();"><i class="iconfont icon-danmu"></i><span>开关评论弹幕</span></a><a class="rightMenu-item hide comment-select" href="javascript:rmf.commentSelect();"><i class="far fa-comment-alt"></i><span>评论所选内容</span></a></div><div class="rightMenu-group rightMenu-line hide menu-to"><a class="rightMenu-item" href="javascript:rmf.openInNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>前往此链接</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制链接</span></a></div><div class="rightMenu-group rightMenu-line hide menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>保存图片</span></a><a class="rightMenu-item" href="javascript:rmf.openImageInNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开图片</span></a><a class="rightMenu-item" href="javascript:rmf.copyImageLink()"><i class="fa fa-copy"></i><span>复制图片链接</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:toRandomPost()"><i class="fa fa-paper-plane"></i><span>随便逛逛</span></a><a class="rightMenu-item" href="javascript:rmf.switchDarkMode();"><i class="fa fa-moon"></i><span>切换显示模式</span></a><a class="rightMenu-item" href="javascript:rmf.translate();"><i class="iconfont icon-fanti"></i><span>繁简转换</span></a><a class="rightMenu-item hide menu-read" href="javascript:rmf.switchReadMode();"><i class="fa fa-book"></i><span>阅读模式</span></a><a class="rightMenu-item" href="/link"><i class="fa-solid fa-user-group"></i><span>友情链接</span></a></div></div><div><script src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/utils.js?v=4.14.0-b1"></script><script src="/js/main.f283933f.js?v=4.14.0-b1"></script><script src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/tw_cn.js?v=4.14.0-b1"></script><script src="https://fastly.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.umd.min.js"></script><script src="https://fastly.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://fastly.jsdelivr.net/npm/vanilla-lazyload@19.0.5/dist/lazyload.iife.min.js"></script><script src="https://fastly.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>(()=>{const t=["post","post-info","recent-posts","archive","article-container","top","about-page","talk_page","equipment"],e=()=>{"object"==typeof pangu?t.forEach((t=>{pangu.spacingElementById(t)})):btf.getScript("https://fastly.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js").then((()=>{t.forEach((t=>{pangu.spacingElementById(t)}))}))},n=()=>{e()};btf.addGlobalFn("pjaxComplete",n,"pangu"),document.addEventListener("DOMContentLoaded",n)})()</script><div class="js-pjax"><script>(()=>{const t=()=>{if(window.MathJax)MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typesetPromise();else{window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],tags:"ams"},chtml:{scale:1.1},options:{enableMenu:!1,renderActions:{findScript:[10,t=>{for(const e of document.querySelectorAll('script[type^="math/tex"]')){const a=!!e.type.match(/; *mode=display/),n=new t.options.MathItem(e.textContent,t.inputJax[0],a),d=document.createTextNode("");e.parentNode.replaceChild(d,e),n.start={node:d,delim:"",n:0},n.end={node:d,delim:"",n:0},t.math.push(n)}},""]}}};const t=document.createElement("script");t.src="https://fastly.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js",t.id="MathJax-script",t.async=!0,document.head.appendChild(t)}};btf.addGlobalFn("encrypt",t,"mathjax"),window.pjax?t():window.addEventListener("load",t)})()</script><div class="comment-barrage"></div><script>$(document).ready((function(){window.commentBarrageConfig={lightColors:[["var(--fyz-white-acrylic2)","var(--fyz-black)"]],darkColors:[["var(--fyz-black-acrylic2)","var(--fyz-white)"]],maxBarrage:3,barrageTime:3e3,twikooUrl:"https://twikoo.fyz666.xyz/",accessToken:"baafee2c7bf49d5967e7a05066e284ca",pageUrl:window.location.pathname,barrageTimer:[],barrageList:[],barrageIndex:0,noAvatarType:"retro",dom:document.querySelector(".comment-barrage"),displayBarrage:!0,avatarCDN:"cravatar.cn"},document.onscroll=function(){let e=document.getElementById("post-comment");null!==e&&commentBarrageConfig.displayBarrage&&(isInViewPortOfOne(e)?document.getElementsByClassName("comment-barrage")[0].setAttribute("style","display:none;"):document.getElementsByClassName("comment-barrage")[0].setAttribute("style",""))},initCommentBarrage()}))</script><script>(()=>{const t=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo.fyz666.xyz/",region:"",onCommentLoaded:()=>{btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const t=document.getElementById("twikoo-count");t&&twikoo.getCommentsCount({envId:"https://twikoo.fyz666.xyz/",region:"",urls:[window.location.pathname],includeReply:!1}).then((o=>{t.textContent=o[0].count})).catch((t=>{console.error(t)}))})()},o=()=>{"object"==typeof twikoo?setTimeout(t,0):btf.getScript("https://fastly.jsdelivr.net/npm/twikoo@1.6.32/dist/twikoo.all.min.js").then(t)};o()})()</script><script>(()=>{const t=t=>"dark"===t?"dark_high_contrast":"light_high_contrast",a=()=>{const a=Object.assign({src:"https://giscus.app/client.js","data-repo":"windshadow233/BlogStorage","data-repo-id":"R_kgDOLhHf0w","data-category-id":"DIC_kwDOLhHf084Ce0EO","data-mapping":"pathname","data-theme":t(document.documentElement.getAttribute("data-theme")),"data-reactions-enabled":"1",crossorigin:"anonymous",async:!0},{"data-mapping":"og:title","data-input-position":"top","data-loading":"lazy","data-reactions-enabled":0,"data-lang":"zh-CN"}),e=document.createElement("script");for(let t in a)e.setAttribute(t,a[t]);document.getElementById("giscus-wrap").appendChild(e)};btf.addGlobalFn("themeChange",(a=>{(t=>{const a=document.querySelector("iframe.giscus-frame");a&&a.contentWindow.postMessage({giscus:t},"https://giscus.app")})({setConfig:{theme:t(a)}})}),"giscus"),a()})()</script></div><script>window.addEventListener("load",(()=>{const e=e=>{let t="";if(e.length)for(let n=0;n<e.length;n++){t+="<div class='aside-list-item'>";{const a="data-lazy-src";t+=`<a href='${e[n].url}' class='thumbnail'><img ${a}='${e[n].avatar}' alt='${e[n].nick}'></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[n].url}' title='${e[n].content}'>${e[n].content}</a>\n        <div class='name'><span>${e[n].nick} / </span><time datetime="${e[n].date}">${btf.diffDate(e[n].date,!0)}</time></div>\n        </div></div>`}else t+="没有评论";let n=document.querySelector("#card-newest-comments .aside-list");n&&(n.innerHTML=t),window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(n)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=btf.saveToLocal.get("twikoo-newest-comments");t?e(JSON.parse(t)):(()=>{const t=()=>{twikoo.getRecentComments({envId:"https://twikoo.fyz666.xyz/",region:"",pageSize:5,includeReply:!1}).then((function(t){const n=t.map((e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=(t=t.replace(/<blockquote.*?>(.*?)<\/blockquote>/gis,"[quote]")).replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[图片]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[链接]")).replace(/<pre><code>.*?<\/pre>/gi,"[代码]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.id,date:new Date(e.created).toISOString()};var t}));btf.saveToLocal.set("twikoo-newest-comments",JSON.stringify(n),5/1440),e(n)})).catch((function(e){document.querySelector("#card-newest-comments .aside-list").textContent="无法获取评论，请确认相关配置是否正确"}))};"object"==typeof twikoo?t():btf.getScript("https://fastly.jsdelivr.net/npm/twikoo@1.6.32/dist/twikoo.all.min.js").then(t)})()}};t(),btf.addGlobalFn("pjaxComplete",t,"twikoo_newestComment")}))</script><canvas id="universe-background"></canvas><div class="aplayer no-destroy" data-id="5103395209" data-fixed="true" data-autoplay="false" data-server="netease" data-order="random" data-listfolded="true" data-loop="all" data-volume="0.4" data-type="playlist"> </div><script async defer src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/universe.js"></script><script>function loadExternalResource(e,t){return new Promise(((s,i)=>{let n;"css"===t?(n=document.createElement("link"),n.rel="stylesheet",n.href=e):"js"===t&&(n=document.createElement("script"),n.src=e),n&&(n.onload=()=>s(e),n.onerror=()=>i(e),document.head.appendChild(n))}))}if(screen.width>=768){const e="/plugins/live2d/";Promise.all([loadExternalResource(e+"waifu.css","css"),loadExternalResource(e+"live2d.min.js","js"),loadExternalResource(e+"waifu-tips.js","js")]).then((()=>{initWidget({waifuPath:e+"waifu-tips.json",cdnPath:"https://fastly.jsdelivr.net/gh/fghrsh/live2d_api/",tools:["hitokoto","quit"]})}))}</script><link rel="stylesheet" href="/css/custom.3855d1a0.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/comment-barrage@v0.0.1.min.css"><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script data-pjax>void 0!==window.LA&&LA.init({id:"JNnEmA8RDMZCf0Vf",ck:"JNnEmA8RDMZCf0Vf"})</script><script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script><script data-pjax>void 0!==window.LingQue&&(new LingQue.Monitor).init({id:"KQWCzIs71YhLYfcB",sendSuspicious:!0,sendSpaPv:!0})</script><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://fastly.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://fastly.jsdelivr.net/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://fastly.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors=['link[rel="canonical"]','meta[property="og:description"]','meta[name="description"]','meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]',"head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!0,scrollRestoration:!1});const triggerPjaxFn=e=>{e&&Object.values(e).forEach((e=>{e()}))};document.addEventListener("pjax:send",(function(){btf.removeGlobalFnEvent("pjax"),btf.removeGlobalFnEvent("themeChange");const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),triggerPjaxFn(window.globalFn.pjaxSend)})),document.addEventListener("pjax:complete",(()=>{document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),a=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(a)),e.parentNode.replaceChild(t,e)})),triggerPjaxFn(window.globalFn.pjaxComplete)})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404")}))</script><script async data-pjax src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/vercount@v0.1.0.js"></script><div class="docsearch-wrap"><div id="docsearch" style="display:none"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/css/docsearch.css"><script src="https://fastly.jsdelivr.net/npm/@docsearch/js@3.6.0/dist/umd/index.min.js"></script><script>(()=>{docsearch(Object.assign({appId:"U4K4JGBNYW",apiKey:"968e6158989f9e37080dc540e037e695",indexName:"fyz666",container:"#docsearch",transformItems:e=>e.map((e=>{const c=new URL(e.url);return{...e,url:c.pathname+c.search+c.hash}}))},{maxResultsPerGroup:20}));const e=()=>{document.querySelector(".DocSearch-Button").click()},c=()=>{btf.addEventListenerPjax(document.querySelector("#search-button > .search"),"click",e)};c(),window.addEventListener("pjax:complete",c)})()</script></div></div><script data-pjax>function butterfly_swiper_injector_config(){if(document.getElementById("swiper-container")){document.getElementById("swiper-container").insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/0105b834-95aa-4865-9188-29b1e008a929.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2025-04-20</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/12471/&quot;);" href="javascript:void(0);" alt="">MCPM：让LLM调用你电脑上的一切工具</a><div class="blog-slider__text">MCPM：高效利用大语言模型的利器</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/c49ffab9-5549-4d5b-b22e-287c109dfdeb.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2024-11-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/12095/&quot;);" href="javascript:void(0);" alt="">Hackergame 2024 题解（零）</a><div class="blog-slider__text">Hackergame 2024，再次喜提二等奖～</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/48f1d9cd-cd8c-4abd-ba92-7390d9ec1b32.png);"><div class="blog-slider__content"><span class="blog-slider__code">2024-10-18</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/11830/&quot;);" href="javascript:void(0);" alt="">GeekGame 2024 题解 (零)</a><div class="blog-slider__text">今年的GeekGame参赛人数好多，勉强拿个前百，来年再接再厉！</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/c95fcde3-2ca6-4ded-8019-604d0868453b.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2024-05-17</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/11574/&quot;);" href="javascript:void(0);" alt="">使用MinIO自部署对象存储服务</a><div class="blog-slider__text">考虑再三，还是选择自部署对象存储服务</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/998fed9b-e31d-43c4-87aa-5efa0d19bc14.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2024-04-11</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/11025/&quot;);" href="javascript:void(0);" alt="">迁移WordPress到静态博客</a><div class="blog-slider__text">时隔四年，我终于把博客从WordPress迁移到了Hexo</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/69767e44-ab15-4b61-a5f5-a6567361e09b.png);"><div class="blog-slider__content"><span class="blog-slider__code">2024-03-20</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/9930/&quot;);" href="javascript:void(0);" alt="">自建docker-mailserver邮件服务器</a><div class="blog-slider__text">用docker部署了个邮件服务器～</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/84f9ac75-6609-487a-9190-8b45a38064df.png);"><div class="blog-slider__content"><span class="blog-slider__code">2024-02-02</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/9235/&quot;);" href="javascript:void(0);" alt="">重塑密码管理体系——Bitwarden服务端自部署</a><div class="blog-slider__text">自部署一个密码管理平台</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://api.star-history.com/svg?repos=windshadow233/This-Repo-Has-0-Stars&amp;type=Date);"><div class="blog-slider__content"><span class="blog-slider__code">2024-02-23</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/9506/&quot;);" href="javascript:void(0);" alt="">一个随Star数动态变化的GitHub仓库</a><div class="blog-slider__text">一个有意思的GitHub仓库</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/52de5404-cde7-4dec-867d-97457ccec409.png);"><div class="blog-slider__content"><span class="blog-slider__code">2024-01-20</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/9097/&quot;);" href="javascript:void(0);" alt="">“The Password Game”攻略</a><div class="blog-slider__text">一个有意思的小游戏</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/jpg/6f00f091-9b5b-42c9-aebd-6635e13518a3.jpg);"><div class="blog-slider__content"><span class="blog-slider__code">2023-11-03</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/8773/&quot;);" href="javascript:void(0);" alt="">Hackergame 2023题解（零）</a><div class="blog-slider__text">喜提校内rank 2，感谢大佬们的不卷之恩！</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/webp/d5b9bb46-0e19-4831-933f-d99bd2380e5d.webp);"><div class="blog-slider__content"><span class="blog-slider__code">2023-09-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/8394/&quot;);" href="javascript:void(0);" alt="">从零开始的麻将AI论文复现（零）</a><div class="blog-slider__text">写了个麻将AI，不过暂时只实现了监督学习</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/5b4b7b2d-1c96-468f-876e-d5d1b5e24cef.png);"><div class="blog-slider__content"><span class="blog-slider__code">2022-05-13</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/7728/&quot;);" href="javascript:void(0);" alt="">自建一个ZeroTier行星/卫星服务器</a><div class="blog-slider__text">P2P异地组网神器——ZeroTier的自部署方法</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/jpeg/f17a1481-2a0e-404d-b6bb-5fa9a6006fb5.jpeg);"><div class="blog-slider__content"><span class="blog-slider__code">2021-08-06</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/6263/&quot;);" href="javascript:void(0);" alt="">手搓神经网络系列之——训练模型（完结篇）</a><div class="blog-slider__text">用Numpy撸了个神经网络</div></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms; background: url(https://blogfiles.oss.fyz666.xyz/png/ea524747-7787-48e0-8d51-c8d7ee7f9226.png);"><div class="blog-slider__content"><span class="blog-slider__code">2021-08-11</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;/blog/6304/&quot;);" href="javascript:void(0);" alt="">如何在校外使用北邮人PT站</a><div class="blog-slider__text">完美解决离校后无法使用北邮人PT站的问题</div></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}}for(var elist="undefined".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/swiper.min.js"></script><script defer data-pjax src="https://fastly.jsdelivr.net/gh/windshadow233/BlogStorage@files/js/swiper_init.js"></script></body></html>